<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Fork identifier for chain compatibility checks | 以太坊改进提案 EIPs</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="以太坊改进提案（EIPs）描述了以太坊平台的标准，包括核心协议规范，客户端API和合约标准。">
    
    <link rel="preload" href="/assets/css/0.styles.89e32c3d.css" as="style"><link rel="preload" href="/assets/js/app.a13d8931.js" as="script"><link rel="preload" href="/assets/js/3.afc73834.js" as="script"><link rel="preload" href="/assets/js/195.9a12a7ef.js" as="script"><link rel="prefetch" href="/assets/js/10.b7e21e5d.js"><link rel="prefetch" href="/assets/js/100.d5d858e7.js"><link rel="prefetch" href="/assets/js/101.e1db9cf8.js"><link rel="prefetch" href="/assets/js/102.f33c0db7.js"><link rel="prefetch" href="/assets/js/103.9b2f992f.js"><link rel="prefetch" href="/assets/js/104.4682985f.js"><link rel="prefetch" href="/assets/js/105.f9e5318b.js"><link rel="prefetch" href="/assets/js/106.9c75a4a1.js"><link rel="prefetch" href="/assets/js/107.a77b3902.js"><link rel="prefetch" href="/assets/js/108.e6af934c.js"><link rel="prefetch" href="/assets/js/109.ea2fe245.js"><link rel="prefetch" href="/assets/js/11.19d07763.js"><link rel="prefetch" href="/assets/js/110.c7c5923b.js"><link rel="prefetch" href="/assets/js/111.53019564.js"><link rel="prefetch" href="/assets/js/112.2678b5bc.js"><link rel="prefetch" href="/assets/js/113.65344b60.js"><link rel="prefetch" href="/assets/js/114.34870900.js"><link rel="prefetch" href="/assets/js/115.e0ce944c.js"><link rel="prefetch" href="/assets/js/116.05caef5d.js"><link rel="prefetch" href="/assets/js/117.eb1f8851.js"><link rel="prefetch" href="/assets/js/118.1d54235b.js"><link rel="prefetch" href="/assets/js/119.57439d26.js"><link rel="prefetch" href="/assets/js/12.cc14cc21.js"><link rel="prefetch" href="/assets/js/120.fec4a349.js"><link rel="prefetch" href="/assets/js/121.e6ee3bd0.js"><link rel="prefetch" href="/assets/js/122.8b1067e2.js"><link rel="prefetch" href="/assets/js/123.e9852421.js"><link rel="prefetch" href="/assets/js/124.e2572e3e.js"><link rel="prefetch" href="/assets/js/125.d02927d3.js"><link rel="prefetch" href="/assets/js/126.5443f529.js"><link rel="prefetch" href="/assets/js/127.df02ad53.js"><link rel="prefetch" href="/assets/js/128.86d06d73.js"><link rel="prefetch" href="/assets/js/129.4ba20791.js"><link rel="prefetch" href="/assets/js/13.66816190.js"><link rel="prefetch" href="/assets/js/130.a3f03ff0.js"><link rel="prefetch" href="/assets/js/131.626e55b3.js"><link rel="prefetch" href="/assets/js/132.95f1e93d.js"><link rel="prefetch" href="/assets/js/133.6e47359a.js"><link rel="prefetch" href="/assets/js/134.47e4440e.js"><link rel="prefetch" href="/assets/js/135.adb1a4c4.js"><link rel="prefetch" href="/assets/js/136.45c43972.js"><link rel="prefetch" href="/assets/js/137.8ba370d0.js"><link rel="prefetch" href="/assets/js/138.74346e65.js"><link rel="prefetch" href="/assets/js/139.fad68529.js"><link rel="prefetch" href="/assets/js/14.1067acde.js"><link rel="prefetch" href="/assets/js/140.d7cf0c13.js"><link rel="prefetch" href="/assets/js/141.53ad4e2c.js"><link rel="prefetch" href="/assets/js/142.3054db6d.js"><link rel="prefetch" href="/assets/js/143.752707de.js"><link rel="prefetch" href="/assets/js/144.6bb5b315.js"><link rel="prefetch" href="/assets/js/145.5be11191.js"><link rel="prefetch" href="/assets/js/146.65c4a5f7.js"><link rel="prefetch" href="/assets/js/147.503abedf.js"><link rel="prefetch" href="/assets/js/148.fac10f82.js"><link rel="prefetch" href="/assets/js/149.39bdc952.js"><link rel="prefetch" href="/assets/js/15.9ca9208b.js"><link rel="prefetch" href="/assets/js/150.763447dd.js"><link rel="prefetch" href="/assets/js/151.74711268.js"><link rel="prefetch" href="/assets/js/152.04b548a4.js"><link rel="prefetch" href="/assets/js/153.f76cfea2.js"><link rel="prefetch" href="/assets/js/154.63dde107.js"><link rel="prefetch" href="/assets/js/155.0c715174.js"><link rel="prefetch" href="/assets/js/156.685fab04.js"><link rel="prefetch" href="/assets/js/157.6739174d.js"><link rel="prefetch" href="/assets/js/158.882bbbfc.js"><link rel="prefetch" href="/assets/js/159.aede9782.js"><link rel="prefetch" href="/assets/js/16.9eea9a64.js"><link rel="prefetch" href="/assets/js/160.d9be3959.js"><link rel="prefetch" href="/assets/js/161.76cc08ef.js"><link rel="prefetch" href="/assets/js/162.1bdec2e1.js"><link rel="prefetch" href="/assets/js/163.ac0295b3.js"><link rel="prefetch" href="/assets/js/164.cf094dd8.js"><link rel="prefetch" href="/assets/js/165.fa43d86b.js"><link rel="prefetch" href="/assets/js/166.b42e919a.js"><link rel="prefetch" href="/assets/js/167.cd4e2412.js"><link rel="prefetch" href="/assets/js/168.b923679f.js"><link rel="prefetch" href="/assets/js/169.0381e4c3.js"><link rel="prefetch" href="/assets/js/17.8d0803f5.js"><link rel="prefetch" href="/assets/js/170.07048ad0.js"><link rel="prefetch" href="/assets/js/171.efbf2d1b.js"><link rel="prefetch" href="/assets/js/172.c6f3f3a1.js"><link rel="prefetch" href="/assets/js/173.b0448642.js"><link rel="prefetch" href="/assets/js/174.9c3b47d1.js"><link rel="prefetch" href="/assets/js/175.6399aebe.js"><link rel="prefetch" href="/assets/js/176.72f40c53.js"><link rel="prefetch" href="/assets/js/177.e4a8654e.js"><link rel="prefetch" href="/assets/js/178.d88d2f1f.js"><link rel="prefetch" href="/assets/js/179.5f89ba63.js"><link rel="prefetch" href="/assets/js/18.3444113b.js"><link rel="prefetch" href="/assets/js/180.9add0321.js"><link rel="prefetch" href="/assets/js/181.a089c28c.js"><link rel="prefetch" href="/assets/js/182.5c030e78.js"><link rel="prefetch" href="/assets/js/183.a96244f5.js"><link rel="prefetch" href="/assets/js/184.8a73b7fa.js"><link rel="prefetch" href="/assets/js/185.39aa4852.js"><link rel="prefetch" href="/assets/js/186.63c92b48.js"><link rel="prefetch" href="/assets/js/187.0afea76b.js"><link rel="prefetch" href="/assets/js/188.4b72b322.js"><link rel="prefetch" href="/assets/js/189.dacc64a4.js"><link rel="prefetch" href="/assets/js/19.45b60500.js"><link rel="prefetch" href="/assets/js/190.6e72d819.js"><link rel="prefetch" href="/assets/js/191.f3361d30.js"><link rel="prefetch" href="/assets/js/192.d02dc2b3.js"><link rel="prefetch" href="/assets/js/193.9185ff86.js"><link rel="prefetch" href="/assets/js/194.109e4d2b.js"><link rel="prefetch" href="/assets/js/196.30492964.js"><link rel="prefetch" href="/assets/js/197.b8f1016e.js"><link rel="prefetch" href="/assets/js/198.cf2ff396.js"><link rel="prefetch" href="/assets/js/199.617d97ea.js"><link rel="prefetch" href="/assets/js/20.ee4a86f1.js"><link rel="prefetch" href="/assets/js/200.414ac8b8.js"><link rel="prefetch" href="/assets/js/201.6eb83ac5.js"><link rel="prefetch" href="/assets/js/202.f94a8455.js"><link rel="prefetch" href="/assets/js/203.fe4c3d1f.js"><link rel="prefetch" href="/assets/js/204.003cdcb5.js"><link rel="prefetch" href="/assets/js/205.dfb2370b.js"><link rel="prefetch" href="/assets/js/206.a3cdde0f.js"><link rel="prefetch" href="/assets/js/207.7eeb49e5.js"><link rel="prefetch" href="/assets/js/208.f77631f1.js"><link rel="prefetch" href="/assets/js/209.03b79d5b.js"><link rel="prefetch" href="/assets/js/21.81e9a796.js"><link rel="prefetch" href="/assets/js/210.4d77fab4.js"><link rel="prefetch" href="/assets/js/211.504c34d5.js"><link rel="prefetch" href="/assets/js/212.71bb8bf5.js"><link rel="prefetch" href="/assets/js/213.a3b6c27d.js"><link rel="prefetch" href="/assets/js/214.0da60311.js"><link rel="prefetch" href="/assets/js/215.cdeb87d0.js"><link rel="prefetch" href="/assets/js/216.75ce111f.js"><link rel="prefetch" href="/assets/js/217.2a924ebe.js"><link rel="prefetch" href="/assets/js/218.b3782b37.js"><link rel="prefetch" href="/assets/js/219.a7b3d0e2.js"><link rel="prefetch" href="/assets/js/22.037348a7.js"><link rel="prefetch" href="/assets/js/220.67f4dc4d.js"><link rel="prefetch" href="/assets/js/221.122e58c3.js"><link rel="prefetch" href="/assets/js/222.4a6ce5ee.js"><link rel="prefetch" href="/assets/js/223.38c97c72.js"><link rel="prefetch" href="/assets/js/224.08f05ad3.js"><link rel="prefetch" href="/assets/js/225.a1f1248d.js"><link rel="prefetch" href="/assets/js/226.49679af1.js"><link rel="prefetch" href="/assets/js/227.272b5118.js"><link rel="prefetch" href="/assets/js/228.97fe27a2.js"><link rel="prefetch" href="/assets/js/229.08893382.js"><link rel="prefetch" href="/assets/js/23.e7c462f9.js"><link rel="prefetch" href="/assets/js/230.fca4ec8d.js"><link rel="prefetch" href="/assets/js/231.dcf2e717.js"><link rel="prefetch" href="/assets/js/232.ad58634e.js"><link rel="prefetch" href="/assets/js/233.62b51320.js"><link rel="prefetch" href="/assets/js/234.366a5c15.js"><link rel="prefetch" href="/assets/js/235.37ee5e06.js"><link rel="prefetch" href="/assets/js/236.c8db6b56.js"><link rel="prefetch" href="/assets/js/237.2a5623bb.js"><link rel="prefetch" href="/assets/js/238.a1e8e150.js"><link rel="prefetch" href="/assets/js/239.9173cd25.js"><link rel="prefetch" href="/assets/js/24.b2111a14.js"><link rel="prefetch" href="/assets/js/240.74555993.js"><link rel="prefetch" href="/assets/js/241.78b20824.js"><link rel="prefetch" href="/assets/js/242.6acd697d.js"><link rel="prefetch" href="/assets/js/243.e43066f7.js"><link rel="prefetch" href="/assets/js/244.73e01f3b.js"><link rel="prefetch" href="/assets/js/245.3f27ce09.js"><link rel="prefetch" href="/assets/js/246.c0bf05db.js"><link rel="prefetch" href="/assets/js/247.0d837589.js"><link rel="prefetch" href="/assets/js/248.d09c386a.js"><link rel="prefetch" href="/assets/js/249.10459d63.js"><link rel="prefetch" href="/assets/js/25.0610f8ef.js"><link rel="prefetch" href="/assets/js/250.f48824df.js"><link rel="prefetch" href="/assets/js/251.121f3d80.js"><link rel="prefetch" href="/assets/js/252.5f893054.js"><link rel="prefetch" href="/assets/js/253.1417eb3b.js"><link rel="prefetch" href="/assets/js/254.5eac655f.js"><link rel="prefetch" href="/assets/js/255.c730cba3.js"><link rel="prefetch" href="/assets/js/256.1219af97.js"><link rel="prefetch" href="/assets/js/257.04701e9e.js"><link rel="prefetch" href="/assets/js/258.3a3b2150.js"><link rel="prefetch" href="/assets/js/259.e70aceaf.js"><link rel="prefetch" href="/assets/js/26.9114f6fc.js"><link rel="prefetch" href="/assets/js/260.7b8b2967.js"><link rel="prefetch" href="/assets/js/261.c0961706.js"><link rel="prefetch" href="/assets/js/262.d6f757d3.js"><link rel="prefetch" href="/assets/js/263.5659fcc5.js"><link rel="prefetch" href="/assets/js/264.8b56c627.js"><link rel="prefetch" href="/assets/js/265.16d5ce3a.js"><link rel="prefetch" href="/assets/js/266.17f217c2.js"><link rel="prefetch" href="/assets/js/267.e70076df.js"><link rel="prefetch" href="/assets/js/268.b06b7a1e.js"><link rel="prefetch" href="/assets/js/269.b5819c04.js"><link rel="prefetch" href="/assets/js/27.2f304f70.js"><link rel="prefetch" href="/assets/js/270.0beee4b9.js"><link rel="prefetch" href="/assets/js/271.90d0c5e4.js"><link rel="prefetch" href="/assets/js/272.1d617a52.js"><link rel="prefetch" href="/assets/js/273.5d7054ff.js"><link rel="prefetch" href="/assets/js/274.eedc246e.js"><link rel="prefetch" href="/assets/js/275.e89375ea.js"><link rel="prefetch" href="/assets/js/276.1ee4957e.js"><link rel="prefetch" href="/assets/js/277.3fb8abc6.js"><link rel="prefetch" href="/assets/js/278.bc288b6e.js"><link rel="prefetch" href="/assets/js/279.c3111a87.js"><link rel="prefetch" href="/assets/js/28.6a081e3d.js"><link rel="prefetch" href="/assets/js/280.d7edbe4d.js"><link rel="prefetch" href="/assets/js/281.98d9104a.js"><link rel="prefetch" href="/assets/js/282.d09079ea.js"><link rel="prefetch" href="/assets/js/283.996adb15.js"><link rel="prefetch" href="/assets/js/284.ff69d3db.js"><link rel="prefetch" href="/assets/js/285.75d86772.js"><link rel="prefetch" href="/assets/js/286.48f2c786.js"><link rel="prefetch" href="/assets/js/287.964dc8a8.js"><link rel="prefetch" href="/assets/js/288.f50b81c4.js"><link rel="prefetch" href="/assets/js/289.b15ef4ba.js"><link rel="prefetch" href="/assets/js/29.e6c29d28.js"><link rel="prefetch" href="/assets/js/290.065686f6.js"><link rel="prefetch" href="/assets/js/291.8e91cb89.js"><link rel="prefetch" href="/assets/js/292.23991b2a.js"><link rel="prefetch" href="/assets/js/293.d89282cb.js"><link rel="prefetch" href="/assets/js/294.8459cf6b.js"><link rel="prefetch" href="/assets/js/295.5159bb70.js"><link rel="prefetch" href="/assets/js/296.bad535dd.js"><link rel="prefetch" href="/assets/js/297.a89c8004.js"><link rel="prefetch" href="/assets/js/298.bfc2ed34.js"><link rel="prefetch" href="/assets/js/299.ed75d8ac.js"><link rel="prefetch" href="/assets/js/30.7ef93552.js"><link rel="prefetch" href="/assets/js/300.04fd45af.js"><link rel="prefetch" href="/assets/js/301.913d3df9.js"><link rel="prefetch" href="/assets/js/302.10b258dd.js"><link rel="prefetch" href="/assets/js/303.fbdf4e67.js"><link rel="prefetch" href="/assets/js/304.e0ff7d5b.js"><link rel="prefetch" href="/assets/js/305.300c5349.js"><link rel="prefetch" href="/assets/js/306.9f73bc93.js"><link rel="prefetch" href="/assets/js/307.b187f491.js"><link rel="prefetch" href="/assets/js/308.d03c07b3.js"><link rel="prefetch" href="/assets/js/309.937b56a3.js"><link rel="prefetch" href="/assets/js/31.7afea5f6.js"><link rel="prefetch" href="/assets/js/310.635a8c4d.js"><link rel="prefetch" href="/assets/js/311.573fcf4a.js"><link rel="prefetch" href="/assets/js/312.bc67fce0.js"><link rel="prefetch" href="/assets/js/313.b5013426.js"><link rel="prefetch" href="/assets/js/314.ae21fa05.js"><link rel="prefetch" href="/assets/js/315.37182c2b.js"><link rel="prefetch" href="/assets/js/316.06cf15a9.js"><link rel="prefetch" href="/assets/js/317.df759a5b.js"><link rel="prefetch" href="/assets/js/318.1a66ad2b.js"><link rel="prefetch" href="/assets/js/319.17d9681e.js"><link rel="prefetch" href="/assets/js/32.861f9380.js"><link rel="prefetch" href="/assets/js/320.10769343.js"><link rel="prefetch" href="/assets/js/321.cc4a3790.js"><link rel="prefetch" href="/assets/js/322.d2b9bced.js"><link rel="prefetch" href="/assets/js/323.dadd7af5.js"><link rel="prefetch" href="/assets/js/324.4281b9b7.js"><link rel="prefetch" href="/assets/js/325.313d6817.js"><link rel="prefetch" href="/assets/js/326.e63bdc82.js"><link rel="prefetch" href="/assets/js/327.f47507e0.js"><link rel="prefetch" href="/assets/js/328.f35cf934.js"><link rel="prefetch" href="/assets/js/329.a1084770.js"><link rel="prefetch" href="/assets/js/33.ab9e8c2b.js"><link rel="prefetch" href="/assets/js/330.ca4cd65f.js"><link rel="prefetch" href="/assets/js/331.e75a5907.js"><link rel="prefetch" href="/assets/js/332.fb511231.js"><link rel="prefetch" href="/assets/js/333.f93dbb9e.js"><link rel="prefetch" href="/assets/js/334.a71bbaa5.js"><link rel="prefetch" href="/assets/js/335.2fa937a5.js"><link rel="prefetch" href="/assets/js/336.a9679a8c.js"><link rel="prefetch" href="/assets/js/337.597945ba.js"><link rel="prefetch" href="/assets/js/338.05b854a8.js"><link rel="prefetch" href="/assets/js/339.fb34c537.js"><link rel="prefetch" href="/assets/js/34.91cf34bb.js"><link rel="prefetch" href="/assets/js/340.bb04bb94.js"><link rel="prefetch" href="/assets/js/341.d8eab431.js"><link rel="prefetch" href="/assets/js/342.adb6fccd.js"><link rel="prefetch" href="/assets/js/343.2e514ff7.js"><link rel="prefetch" href="/assets/js/344.ae288347.js"><link rel="prefetch" href="/assets/js/345.36cef5e0.js"><link rel="prefetch" href="/assets/js/346.18900139.js"><link rel="prefetch" href="/assets/js/347.55de0e5f.js"><link rel="prefetch" href="/assets/js/348.e8df7344.js"><link rel="prefetch" href="/assets/js/349.391634ff.js"><link rel="prefetch" href="/assets/js/35.a54aaacc.js"><link rel="prefetch" href="/assets/js/350.6ed9c27e.js"><link rel="prefetch" href="/assets/js/351.13d8f554.js"><link rel="prefetch" href="/assets/js/352.42a626e4.js"><link rel="prefetch" href="/assets/js/353.28e60cfb.js"><link rel="prefetch" href="/assets/js/354.1d876de3.js"><link rel="prefetch" href="/assets/js/355.be9dd30e.js"><link rel="prefetch" href="/assets/js/356.c76485ba.js"><link rel="prefetch" href="/assets/js/357.3beca4a2.js"><link rel="prefetch" href="/assets/js/358.34ce9b7c.js"><link rel="prefetch" href="/assets/js/359.62662c8a.js"><link rel="prefetch" href="/assets/js/36.1fb34483.js"><link rel="prefetch" href="/assets/js/360.1d4fd1c2.js"><link rel="prefetch" href="/assets/js/361.cedc472b.js"><link rel="prefetch" href="/assets/js/362.1a42a5a9.js"><link rel="prefetch" href="/assets/js/363.3212b786.js"><link rel="prefetch" href="/assets/js/364.795f5fbb.js"><link rel="prefetch" href="/assets/js/365.ba5aeafd.js"><link rel="prefetch" href="/assets/js/366.9e7c06f4.js"><link rel="prefetch" href="/assets/js/367.520bbbb6.js"><link rel="prefetch" href="/assets/js/368.1645c28e.js"><link rel="prefetch" href="/assets/js/369.3809a538.js"><link rel="prefetch" href="/assets/js/37.ee12bd46.js"><link rel="prefetch" href="/assets/js/370.217b10df.js"><link rel="prefetch" href="/assets/js/371.c8a9e0a9.js"><link rel="prefetch" href="/assets/js/372.247d9278.js"><link rel="prefetch" href="/assets/js/373.0eed1f0a.js"><link rel="prefetch" href="/assets/js/374.881713dc.js"><link rel="prefetch" href="/assets/js/375.b09c525d.js"><link rel="prefetch" href="/assets/js/376.43c32017.js"><link rel="prefetch" href="/assets/js/377.47cbbf1d.js"><link rel="prefetch" href="/assets/js/378.dd3eec1a.js"><link rel="prefetch" href="/assets/js/379.191b4f64.js"><link rel="prefetch" href="/assets/js/38.242d9c7f.js"><link rel="prefetch" href="/assets/js/380.8f916b60.js"><link rel="prefetch" href="/assets/js/381.fe1dfc6a.js"><link rel="prefetch" href="/assets/js/382.067d85f2.js"><link rel="prefetch" href="/assets/js/383.eeab62ac.js"><link rel="prefetch" href="/assets/js/384.ffab213d.js"><link rel="prefetch" href="/assets/js/385.94da6ae9.js"><link rel="prefetch" href="/assets/js/386.991dd01d.js"><link rel="prefetch" href="/assets/js/387.ffb790b4.js"><link rel="prefetch" href="/assets/js/388.ed3f39f5.js"><link rel="prefetch" href="/assets/js/389.a6174e1c.js"><link rel="prefetch" href="/assets/js/39.dbcc5d61.js"><link rel="prefetch" href="/assets/js/390.fe916439.js"><link rel="prefetch" href="/assets/js/391.69f751d7.js"><link rel="prefetch" href="/assets/js/392.e6c52ac2.js"><link rel="prefetch" href="/assets/js/393.7da57f52.js"><link rel="prefetch" href="/assets/js/394.1a7a717f.js"><link rel="prefetch" href="/assets/js/395.3399844a.js"><link rel="prefetch" href="/assets/js/396.7f2e8145.js"><link rel="prefetch" href="/assets/js/397.42b4026a.js"><link rel="prefetch" href="/assets/js/398.5c231ed1.js"><link rel="prefetch" href="/assets/js/399.4566824b.js"><link rel="prefetch" href="/assets/js/4.fea0df6a.js"><link rel="prefetch" href="/assets/js/40.493a59f4.js"><link rel="prefetch" href="/assets/js/400.6882e1d0.js"><link rel="prefetch" href="/assets/js/401.527ff51d.js"><link rel="prefetch" href="/assets/js/402.e9c37d2a.js"><link rel="prefetch" href="/assets/js/403.360b2d7d.js"><link rel="prefetch" href="/assets/js/404.4d3adaac.js"><link rel="prefetch" href="/assets/js/405.c6785e58.js"><link rel="prefetch" href="/assets/js/406.ea8781ae.js"><link rel="prefetch" href="/assets/js/407.b0463036.js"><link rel="prefetch" href="/assets/js/408.56b3f633.js"><link rel="prefetch" href="/assets/js/409.83b77a08.js"><link rel="prefetch" href="/assets/js/41.bd45f48a.js"><link rel="prefetch" href="/assets/js/410.808144cb.js"><link rel="prefetch" href="/assets/js/411.efd2ae36.js"><link rel="prefetch" href="/assets/js/412.42b1274b.js"><link rel="prefetch" href="/assets/js/42.3475d232.js"><link rel="prefetch" href="/assets/js/43.2407adcb.js"><link rel="prefetch" href="/assets/js/44.e2a316c5.js"><link rel="prefetch" href="/assets/js/45.1c5f24df.js"><link rel="prefetch" href="/assets/js/46.18a61726.js"><link rel="prefetch" href="/assets/js/47.707f9f7a.js"><link rel="prefetch" href="/assets/js/48.5dd41842.js"><link rel="prefetch" href="/assets/js/49.d3acd899.js"><link rel="prefetch" href="/assets/js/5.461bccd8.js"><link rel="prefetch" href="/assets/js/50.02c1a863.js"><link rel="prefetch" href="/assets/js/51.ccf0ba79.js"><link rel="prefetch" href="/assets/js/52.3aee611f.js"><link rel="prefetch" href="/assets/js/53.bf3daa85.js"><link rel="prefetch" href="/assets/js/54.d61cd0a6.js"><link rel="prefetch" href="/assets/js/55.5986d91d.js"><link rel="prefetch" href="/assets/js/56.da7d4622.js"><link rel="prefetch" href="/assets/js/57.a53216e9.js"><link rel="prefetch" href="/assets/js/58.eb424782.js"><link rel="prefetch" href="/assets/js/59.0db825e2.js"><link rel="prefetch" href="/assets/js/6.76cd68c6.js"><link rel="prefetch" href="/assets/js/60.885ad249.js"><link rel="prefetch" href="/assets/js/61.9a010ecb.js"><link rel="prefetch" href="/assets/js/62.907dc688.js"><link rel="prefetch" href="/assets/js/63.69f56658.js"><link rel="prefetch" href="/assets/js/64.ec17ab0c.js"><link rel="prefetch" href="/assets/js/65.555f05e2.js"><link rel="prefetch" href="/assets/js/66.82f26703.js"><link rel="prefetch" href="/assets/js/67.3d43cd18.js"><link rel="prefetch" href="/assets/js/68.b14b7646.js"><link rel="prefetch" href="/assets/js/69.f4f9155f.js"><link rel="prefetch" href="/assets/js/7.f2fbf882.js"><link rel="prefetch" href="/assets/js/70.146046b6.js"><link rel="prefetch" href="/assets/js/71.5cc26b01.js"><link rel="prefetch" href="/assets/js/72.bc119d92.js"><link rel="prefetch" href="/assets/js/73.9d63e7dc.js"><link rel="prefetch" href="/assets/js/74.f12f047e.js"><link rel="prefetch" href="/assets/js/75.131756e3.js"><link rel="prefetch" href="/assets/js/76.147c95b9.js"><link rel="prefetch" href="/assets/js/77.4f81bf5f.js"><link rel="prefetch" href="/assets/js/78.2620317a.js"><link rel="prefetch" href="/assets/js/79.7d79e1df.js"><link rel="prefetch" href="/assets/js/8.d346a35e.js"><link rel="prefetch" href="/assets/js/80.08435f23.js"><link rel="prefetch" href="/assets/js/81.bbea59aa.js"><link rel="prefetch" href="/assets/js/82.93bbfeeb.js"><link rel="prefetch" href="/assets/js/83.9e0f2d3f.js"><link rel="prefetch" href="/assets/js/84.2a78f0ef.js"><link rel="prefetch" href="/assets/js/85.464597f8.js"><link rel="prefetch" href="/assets/js/86.8cced385.js"><link rel="prefetch" href="/assets/js/87.6eab3983.js"><link rel="prefetch" href="/assets/js/88.919be664.js"><link rel="prefetch" href="/assets/js/89.a9c88099.js"><link rel="prefetch" href="/assets/js/9.2b013f04.js"><link rel="prefetch" href="/assets/js/90.e30432e7.js"><link rel="prefetch" href="/assets/js/91.6b17f9d5.js"><link rel="prefetch" href="/assets/js/92.044d73f7.js"><link rel="prefetch" href="/assets/js/93.446151cb.js"><link rel="prefetch" href="/assets/js/94.777e77bb.js"><link rel="prefetch" href="/assets/js/95.dbda6d80.js"><link rel="prefetch" href="/assets/js/96.e280ef31.js"><link rel="prefetch" href="/assets/js/97.2d68e74b.js"><link rel="prefetch" href="/assets/js/98.93faeca6.js"><link rel="prefetch" href="/assets/js/99.8285fa98.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.029a7c95.js">
    <link rel="stylesheet" href="/assets/css/0.styles.89e32c3d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">以太坊改进提案 EIPs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://ethlibrary.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  About us
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/ethlibrary/EIPs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://ethlibrary.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  About us
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/ethlibrary/EIPs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/all.html" class="sidebar-link">All EIPs</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Status</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/draft.html" class="sidebar-link">Draft</a></li><li><a href="/review.html" class="sidebar-link">Review</a></li><li><a href="/lastCall.html" class="sidebar-link">Last Call</a></li><li><a href="/accepted.html" class="sidebar-link">Accepted</a></li><li><a href="/final_and_living.html" class="sidebar-link">Final and Living</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Type</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/core.html" class="sidebar-link">Core (165)</a></li><li><a href="/networking.html" class="sidebar-link">Networking (11)</a></li><li><a href="/interface.html" class="sidebar-link">Interface (38)</a></li><li><a href="/erc.html" class="sidebar-link">ERC (153)</a></li><li><a href="/meta.html" class="sidebar-link">Meta (18)</a></li><li><a href="/informational.html" class="sidebar-link">Informational (6)</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="simple-summary"><a href="#simple-summary" class="header-anchor">#</a> Simple Summary</h2> <p>Currently nodes in the Ethereum network try to find each other by establishing random connections to remote machines &quot;looking&quot; like an Ethereum node (public networks, private networks, test networks, etc), hoping that they found a useful peer (same genesis, same forks). This wastes time and resources, especially for smaller networks.</p> <p>To avoid this overhead, Ethereum needs a mechanism that can precisely identify whether a node will be useful, as early as possible. Such a mechanism requires a way to summarize chain configurations, as well as a way to disseminate said summaries in the network.</p> <p>This proposal focuses only on the definition of said summary - a generally useful <em>fork identifier</em> - and it's validation rules, allowing it to be embedded into arbitrary network protocols (e.g. <a href="/eip-778.html">discovery ENRs</a> or <code>eth/6x</code> handshakes).</p> <h2 id="abstract"><a href="#abstract" class="header-anchor">#</a> Abstract</h2> <p>There are many public and private Ethereum networks, but the discovery protocol doesn't differentiate between them. The only way to check if a peer is good or bad (same chain or not), is to establish a TCP/IP connection, wrap it with RLPx cryptography, then execute an <code>eth</code> handshake. This is an extreme cost to bear if it turns out that the remote peer is on a different network and it's not even precise enough to differentiate Ethereum and Ethereum Classic. This cost is magnified for small networks, where a lot more trial and errors are needed to find good nodes.</p> <p>Even if the peer <strong>is</strong> on the same chain, during non-controversial consensus upgrades, not everybody updates their nodes in time (developer nodes, leftovers, etc). These stale nodes put a meaningless burden on the peer-to-peer network, since they just latch on to good nodes, but don't accept upgraded blocks. This causes valuable peer slots and bandwidth to be lost until the stale nodes finally update. This is a serious issue for test networks, where leftovers can linger for months.</p> <p>This EIP proposes a new identity scheme to both precisely and concisely summarize the chain's current status (genesis and all applied forks). The conciseness is particularly important to make the identity useful across datagram protocols too. The EIP solves a number of issues:</p> <ul><li>If two nodes are on different networks, they should never even consider connecting.</li> <li>If a hard fork passes, upgraded nodes should reject non-upgraded ones, but <strong>NOT</strong> before.</li> <li>If two chains share the same genesis, but not forks (ETH / ETC), they should reject each other.</li></ul> <p>This EIP does not attempt to solve the clean separation of 3-way-forks! If at the same future block number, the network splits into three (non-fork, fork-A and fork-B), separating the forkers from each another will need case-by-case special handling. Not handling this keeps the proposal pragmatic, simple and also avoids making it too easy to fork off mainnet.</p> <p>To keep the scope limited, this EIP only defines the identity scheme and validation rules. The same scheme and algorithm can be embedded into various networking protocols, allowing both the <code>eth/6x</code> handshake to be more precise (Ethereum vs. Ethereum Classic); as well as the discovery to be more useful (reject surely peers without ever connecting).</p> <h2 id="motivation"><a href="#motivation" class="header-anchor">#</a> Motivation</h2> <p>Peer-to-peer networking is messy and hard due to firewalls and network address translation (NAT). Generally only a small fraction of nodes have publicly routed addresses and P2P networks rely mainly on these for forwarding data for everyone else. The best way to maximize the utility of the public nodes is to ensure their resources aren't wasted on tasks that are worthless to the network.</p> <p>By aggressively cutting off incompatible nodes from each other we can extract a lot more value from the public nodes, making the entire P2P network much more robust and reliable. Supporting this network partitioning at a discovery layer can further enhance performance as we avoid the costly crypto and latency/bandwidth hit associated with establishing a stream connection in the first place.</p> <h2 id="specification"><a href="#specification" class="header-anchor">#</a> Specification</h2> <p>Each node maintains the following values:</p> <ul><li><strong><code>FORK_HASH</code></strong>: IEEE CRC32 checksum (<code>[4]byte</code>) of the genesis hash and fork blocks numbers that already passed.
<ul><li>The fork block numbers are fed into the CRC32 checksum in ascending order.</li> <li>If multiple forks are applied at the same block, the block number is checksummed only once.</li> <li>Block numbers are regarded as <code>uint64</code> integers, encoded in big endian format when checksumming.</li> <li>If a chain is configured to start with a non-Frontier ruleset already in its genesis, that is NOT considered a fork.</li></ul></li> <li><strong><code>FORK_NEXT</code></strong>: Block number (<code>uint64</code>) of the next upcoming fork, or <code>0</code> if no next fork is known.</li></ul> <p>E.g. <code>FORK_HASH</code> for mainnet would be:</p> <ul><li>forkhash₀ = <code>0xfc64ec04</code> (Genesis) = <code>CRC32(&lt;genesis-hash&gt;)</code></li> <li>forkhash₁ = <code>0x97c2c34c</code> (Homestead) = <code>CRC32(&lt;genesis-hash&gt; || uint64(1150000))</code></li> <li>forkhash₂ = <code>0x91d1f948</code> (DAO fork) = <code>CRC32(&lt;genesis-hash&gt; || uint64(1150000) || uint64(1920000))</code></li></ul> <p>The <em>fork identifier</em> is defined as <code>RLP([FORK_HASH, FORK_NEXT])</code>. This <code>forkid</code> is cross validated (<strong>NOT</strong> naively compared) to assess a remote chain's compatibility. Irrespective of fork state, both parties must come to the same conclusion to avoid indefinite reconnect attempts from one side.</p> <h4 id="validation-rules"><a href="#validation-rules" class="header-anchor">#</a> Validation rules</h4> <ul><li><ol><li>If local and remote <code>FORK_HASH</code> matches, compare local head to <code>FORK_NEXT</code>.</li></ol> <ul><li>The two nodes are in the same fork state currently. They might know of differing future forks, but that's not relevant until the fork triggers (might be postponed, nodes might be updated to match).
<ul><li>1a) A remotely announced but remotely not passed block is already passed locally, disconnect, since the chains are incompatible.</li> <li>1b) No remotely announced fork; or not yet passed locally, connect.</li></ul></li></ul></li> <li><ol start="2"><li>If the remote <code>FORK_HASH</code> is a subset of the local past forks and the remote <code>FORK_NEXT</code> matches with the locally following fork block number, connect.</li></ol> <ul><li>Remote node is currently syncing. It might eventually diverge from us, but at this current point in time we don't have enough information.</li></ul></li> <li><ol start="3"><li>If the remote <code>FORK_HASH</code> is a superset of the local past forks and can be completed with locally known future forks, connect.</li></ol> <ul><li>Local node is currently syncing. It might eventually diverge from the remote, but at this current point in time we don't have enough information.</li></ul></li> <li><ol start="4"><li>Reject in all other cases.</li></ol></li></ul> <h4 id="stale-software-examples"><a href="#stale-software-examples" class="header-anchor">#</a> Stale software examples</h4> <p>The examples below try to exhaust the fork combination possibilities that arise when nodes do not run matching software versions, but otherwise follow the same chain (mainnet nodes, testnet nodes, etc).</p> <table><thead><tr><th style="text-align:center;">Past forks</th> <th style="text-align:center;">Future forks</th> <th style="text-align:center;">Head</th> <th style="text-align:center;">Remote <code>FORK_HASH</code></th> <th style="text-align:center;">Remote <code>FORK_NEXT</code></th> <th style="text-align:center;">Connect</th> <th style="text-align:center;">Reason</th></tr></thead> <tbody><tr><td style="text-align:center;">A</td> <td style="text-align:center;"></td> <td style="text-align:center;"></td> <td style="text-align:center;">A</td> <td style="text-align:center;"></td> <td style="text-align:center;">Yes (1b)</td> <td style="text-align:center;">Same forks, same sync state.</td></tr> <tr><td style="text-align:center;">A</td> <td style="text-align:center;"></td> <td style="text-align:center;">&lt; B</td> <td style="text-align:center;">A</td> <td style="text-align:center;">B</td> <td style="text-align:center;">Yes (1b)</td> <td style="text-align:center;">Remote is advertising a future fork, but that is uncertain.</td></tr> <tr><td style="text-align:center;">A</td> <td style="text-align:center;"></td> <td style="text-align:center;">&gt;= B</td> <td style="text-align:center;">A</td> <td style="text-align:center;">B</td> <td style="text-align:center;">No (1a)</td> <td style="text-align:center;">Remote is advertising a future fork that passed locally.</td></tr> <tr><td style="text-align:center;">A</td> <td style="text-align:center;">B</td> <td style="text-align:center;"></td> <td style="text-align:center;">A</td> <td style="text-align:center;"></td> <td style="text-align:center;">Yes (1b)</td> <td style="text-align:center;">Local knows about a future fork, but that is uncertain.</td></tr> <tr><td style="text-align:center;">A</td> <td style="text-align:center;">B</td> <td style="text-align:center;"></td> <td style="text-align:center;">A</td> <td style="text-align:center;">B</td> <td style="text-align:center;">Yes (1b)</td> <td style="text-align:center;">Both know about a future fork, but that is uncertain.</td></tr> <tr><td style="text-align:center;">A</td> <td style="text-align:center;">B1</td> <td style="text-align:center;">&lt; B2</td> <td style="text-align:center;">A</td> <td style="text-align:center;">B2</td> <td style="text-align:center;">Yes (1b)</td> <td style="text-align:center;">Both know about differing future forks, but those are uncertain.</td></tr> <tr><td style="text-align:center;">A</td> <td style="text-align:center;">B1</td> <td style="text-align:center;">&gt;= B2</td> <td style="text-align:center;">A</td> <td style="text-align:center;">B2</td> <td style="text-align:center;">No (1a)</td> <td style="text-align:center;">Both know about differing future forks, but the remote one passed locally.</td></tr> <tr><td style="text-align:center;">[A,B]</td> <td style="text-align:center;"></td> <td style="text-align:center;"></td> <td style="text-align:center;">A</td> <td style="text-align:center;">B</td> <td style="text-align:center;">Yes (2)</td> <td style="text-align:center;">Remote out of sync.</td></tr> <tr><td style="text-align:center;">[A,B,C]</td> <td style="text-align:center;"></td> <td style="text-align:center;"></td> <td style="text-align:center;">A</td> <td style="text-align:center;">B</td> <td style="text-align:center;">Yes¹ (2)</td> <td style="text-align:center;">Remote out of sync. Remote will need a software update, but we don't know it yet.</td></tr> <tr><td style="text-align:center;">A</td> <td style="text-align:center;">B</td> <td style="text-align:center;"></td> <td style="text-align:center;">A ⊕ B</td> <td style="text-align:center;"></td> <td style="text-align:center;">Yes (3)</td> <td style="text-align:center;">Local out of sync.</td></tr> <tr><td style="text-align:center;">A</td> <td style="text-align:center;">B,C</td> <td style="text-align:center;"></td> <td style="text-align:center;">A ⊕ B</td> <td style="text-align:center;"></td> <td style="text-align:center;">Yes (3)</td> <td style="text-align:center;">Local out of sync. Local also knows about a future fork, but that is uncertain yet.</td></tr> <tr><td style="text-align:center;">A</td> <td style="text-align:center;"></td> <td style="text-align:center;"></td> <td style="text-align:center;">A ⊕ B</td> <td style="text-align:center;"></td> <td style="text-align:center;">No (4)</td> <td style="text-align:center;">Local needs software update.</td></tr> <tr><td style="text-align:center;">A</td> <td style="text-align:center;">B</td> <td style="text-align:center;"></td> <td style="text-align:center;">A ⊕ B ⊕ C</td> <td style="text-align:center;"></td> <td style="text-align:center;">No² (4)</td> <td style="text-align:center;">Local needs software update.</td></tr> <tr><td style="text-align:center;">[A,B]</td> <td style="text-align:center;"></td> <td style="text-align:center;"></td> <td style="text-align:center;">A</td> <td style="text-align:center;"></td> <td style="text-align:center;">No (4)</td> <td style="text-align:center;">Remote needs software update.</td></tr></tbody></table> <p><em>Note, there's one asymmetry in the table, marked with ¹ and ². Since we don't have access to a remote node's future fork list (just the next one), we can't detect that it's software is stale until it syncs up. This is acceptable as 1) the remote node will disconnect from us anyway, and 2) this is a temporary fluke during sync, not permanent with a leftover node.</em></p> <h2 id="rationale"><a href="#rationale" class="header-anchor">#</a> Rationale</h2> <h5 id="why-flatten-fork-hash-into-4-bytes-why-not-share-the-entire-genesis-and-fork-list"><a href="#why-flatten-fork-hash-into-4-bytes-why-not-share-the-entire-genesis-and-fork-list" class="header-anchor">#</a> Why flatten <code>FORK_HASH</code> into 4 bytes? Why not share the entire genesis and fork list?</h5> <p>Whilst the <code>eth</code> devp2p protocol permits arbitrarily much data to be transmitted, the discovery protocol's total space allowance for all ENR entries is 300 bytes.</p> <p>Reducing the <code>FORK_HASH</code> into a 4 bytes checksum ensures that we leave ample room in the ENR for future extensions; and 4 bytes is more than enough for arbitrarily many Ethereum networks from a (practical) collision perspective.</p> <h5 id="why-use-ieee-crc32-as-the-checksum-instead-of-keccak256"><a href="#why-use-ieee-crc32-as-the-checksum-instead-of-keccak256" class="header-anchor">#</a> Why use IEEE CRC32 as the checksum instead of Keccak256?</h5> <p>We need a mechanism that can flatten arbitrary data into 4 bytes, without ignoring any of the input. Any other checksum or hashing algorithm would work, but since nodes can lie at any time, there's no value in cryptographic hash functions.</p> <p>Instead of just taking the first 4 bytes of a Keccak256 hash (seems odd) or XOR-ing all the 4-byte groups (messy), CRC32 is a better alternative, as this is exactly what it was designed for. IEEE CRC32 is also used by ethernet, gzip, zip, png, etc, so every programming language support should not be a problem.</p> <h5 id="we-re-not-using-fork-next-for-much-can-t-we-get-rid-of-it-somehow"><a href="#we-re-not-using-fork-next-for-much-can-t-we-get-rid-of-it-somehow" class="header-anchor">#</a> We're not using <code>FORK_NEXT</code> for much, can't we get rid of it somehow?</h5> <p>We need to be able to differentiate whether a remote node is out of sync or whether its software is stale. Sharing only the past forks cannot tell us if the node is legitimately behind or stuck.</p> <h5 id="why-advertise-only-one-next-fork-instead-of-hashing-all-known-future-ones-like-the-fork-hash"><a href="#why-advertise-only-one-next-fork-instead-of-hashing-all-known-future-ones-like-the-fork-hash" class="header-anchor">#</a> Why advertise only one next fork, instead of &quot;hashing&quot; all known future ones like the <code>FORK_HASH</code>?</h5> <p>Opposed to past forks that have already passed (for us locally) and can be considered immutable, we don't know anything about future ones. Maybe we're out of sync or maybe the fork didn't pass yet. If it didn't pass yet, it might be postponed, so enforcing it would split the network apart. It could also happen that we're not yet aware of all future forks (haven't updated our software in a while).</p> <h2 id="backwards-compatibility"><a href="#backwards-compatibility" class="header-anchor">#</a> Backwards Compatibility</h2> <p>This EIP only defines an identity scheme, it does not define functional changes.</p> <h2 id="test-cases"><a href="#test-cases" class="header-anchor">#</a> Test Cases</h2> <p>Here's a full suite of tests for all possible fork IDs that Mainnet, Ropsten, Rinkeby and Görli can advertise given the Petersburg fork cap (time of writing).</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> testcase <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	head <span class="token builtin">uint64</span>
	want ID
<span class="token punctuation">}</span>
tests <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">struct</span> <span class="token punctuation">{</span>
	config  <span class="token operator">*</span>params<span class="token punctuation">.</span>ChainConfig
	genesis common<span class="token punctuation">.</span>Hash
	cases   <span class="token punctuation">[</span><span class="token punctuation">]</span>testcase
<span class="token punctuation">}</span><span class="token punctuation">{</span>
	<span class="token comment">// Mainnet test cases</span>
	<span class="token punctuation">{</span>
		params<span class="token punctuation">.</span>MainnetChainConfig<span class="token punctuation">,</span>
		params<span class="token punctuation">.</span>MainnetGenesisHash<span class="token punctuation">,</span>
		<span class="token punctuation">[</span><span class="token punctuation">]</span>testcase<span class="token punctuation">{</span>
			<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xfc64ec04</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">1150000</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>       <span class="token comment">// Unsynced</span>
			<span class="token punctuation">{</span><span class="token number">1149999</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xfc64ec04</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">1150000</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Last Frontier block</span>
			<span class="token punctuation">{</span><span class="token number">1150000</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x97c2c34c</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">1920000</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// First Homestead block</span>
			<span class="token punctuation">{</span><span class="token number">1919999</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x97c2c34c</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">1920000</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Last Homestead block</span>
			<span class="token punctuation">{</span><span class="token number">1920000</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x91d1f948</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">2463000</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// First DAO block</span>
			<span class="token punctuation">{</span><span class="token number">2462999</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x91d1f948</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">2463000</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Last DAO block</span>
			<span class="token punctuation">{</span><span class="token number">2463000</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x7a64da13</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">2675000</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// First Tangerine block</span>
			<span class="token punctuation">{</span><span class="token number">2674999</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x7a64da13</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">2675000</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Last Tangerine block</span>
			<span class="token punctuation">{</span><span class="token number">2675000</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x3edd5b10</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">4370000</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// First Spurious block</span>
			<span class="token punctuation">{</span><span class="token number">4369999</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x3edd5b10</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">4370000</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Last Spurious block</span>
			<span class="token punctuation">{</span><span class="token number">4370000</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xa00bc324</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">7280000</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// First Byzantium block</span>
			<span class="token punctuation">{</span><span class="token number">7279999</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xa00bc324</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">7280000</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Last Byzantium block</span>
			<span class="token punctuation">{</span><span class="token number">7280000</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x668db0af</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>       <span class="token comment">// First and last Constantinople, first Petersburg block</span>
			<span class="token punctuation">{</span><span class="token number">7987396</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x668db0af</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>       <span class="token comment">// Today Petersburg block</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// Ropsten test cases</span>
	<span class="token punctuation">{</span>
		params<span class="token punctuation">.</span>TestnetChainConfig<span class="token punctuation">,</span>
		params<span class="token punctuation">.</span>TestnetGenesisHash<span class="token punctuation">,</span>
		<span class="token punctuation">[</span><span class="token punctuation">]</span>testcase<span class="token punctuation">{</span>
			<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x30c7ddbc</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>            <span class="token comment">// Unsynced, last Frontier, Homestead and first Tangerine block</span>
			<span class="token punctuation">{</span><span class="token number">9</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x30c7ddbc</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>            <span class="token comment">// Last Tangerine block</span>
			<span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x63760190</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">1700000</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token comment">// First Spurious block</span>
			<span class="token punctuation">{</span><span class="token number">1699999</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x63760190</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">1700000</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Last Spurious block</span>
			<span class="token punctuation">{</span><span class="token number">1700000</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x3ea159c7</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">4230000</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// First Byzantium block</span>
			<span class="token punctuation">{</span><span class="token number">4229999</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x3ea159c7</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">4230000</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Last Byzantium block</span>
			<span class="token punctuation">{</span><span class="token number">4230000</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x97b544f3</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">4939394</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// First Constantinople block</span>
			<span class="token punctuation">{</span><span class="token number">4939393</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x97b544f3</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">4939394</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Last Constantinople block</span>
			<span class="token punctuation">{</span><span class="token number">4939394</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xd6e2149b</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">6485846</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// First Petersburg block</span>
			<span class="token punctuation">{</span><span class="token number">6485845</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xd6e2149b</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">6485846</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Last Petersburg block</span>
			<span class="token punctuation">{</span><span class="token number">6485846</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x4bc66396</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>       <span class="token comment">// First Istanbul block</span>
			<span class="token punctuation">{</span><span class="token number">7500000</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x4bc66396</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>       <span class="token comment">// Future Istanbul block</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// Rinkeby test cases</span>
	<span class="token punctuation">{</span>
		params<span class="token punctuation">.</span>RinkebyChainConfig<span class="token punctuation">,</span>
		params<span class="token punctuation">.</span>RinkebyGenesisHash<span class="token punctuation">,</span>
		<span class="token punctuation">[</span><span class="token punctuation">]</span>testcase<span class="token punctuation">{</span>
			<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x3b8e0691</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>             <span class="token comment">// Unsynced, last Frontier block</span>
			<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x60949295</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>             <span class="token comment">// First and last Homestead block</span>
			<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x8bde40dd</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>             <span class="token comment">// First and last Tangerine block</span>
			<span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xcb3a64bb</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">1035301</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>       <span class="token comment">// First Spurious block</span>
			<span class="token punctuation">{</span><span class="token number">1035300</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xcb3a64bb</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">1035301</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Last Spurious block</span>
			<span class="token punctuation">{</span><span class="token number">1035301</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x8d748b57</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">3660663</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// First Byzantium block</span>
			<span class="token punctuation">{</span><span class="token number">3660662</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x8d748b57</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">3660663</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Last Byzantium block</span>
			<span class="token punctuation">{</span><span class="token number">3660663</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xe49cab14</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">4321234</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// First Constantinople block</span>
			<span class="token punctuation">{</span><span class="token number">4321233</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xe49cab14</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">4321234</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Last Constantinople block</span>
			<span class="token punctuation">{</span><span class="token number">4321234</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xafec6b27</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">5435345</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// First Petersburg block</span>
			<span class="token punctuation">{</span><span class="token number">5435344</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xafec6b27</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">5435345</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Last Petersburg block</span>
			<span class="token punctuation">{</span><span class="token number">5435345</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xcbdb8838</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>       <span class="token comment">// First Istanbul block</span>
			<span class="token punctuation">{</span><span class="token number">6000000</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xcbdb8838</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>       <span class="token comment">// Future Istanbul block</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">// Goerli test cases</span>
	<span class="token punctuation">{</span>
		params<span class="token punctuation">.</span>GoerliChainConfig<span class="token punctuation">,</span>
		params<span class="token punctuation">.</span>GoerliGenesisHash<span class="token punctuation">,</span>
		<span class="token punctuation">[</span><span class="token punctuation">]</span>testcase<span class="token punctuation">{</span>
			<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xa3f5ab08</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">1561651</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>       <span class="token comment">// Unsynced, last Frontier, Homestead, Tangerine, Spurious, Byzantium, Constantinople and first Petersburg block</span>
			<span class="token punctuation">{</span><span class="token number">1561650</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xa3f5ab08</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">1561651</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// Last Petersburg block</span>
			<span class="token punctuation">{</span><span class="token number">1561651</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xc25efa5c</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>       <span class="token comment">// First Istanbul block</span>
			<span class="token punctuation">{</span><span class="token number">2000000</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xc25efa5c</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>       <span class="token comment">// Future Istanbul block</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br></div></div><p>Here's a suite of tests of the different states a Mainnet node might be in and the different remote fork identifiers it might be required to validate and decide to accept or reject:</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>tests <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">struct</span> <span class="token punctuation">{</span>
	head <span class="token builtin">uint64</span>
	id   ID
	err  <span class="token builtin">error</span>
<span class="token punctuation">}</span><span class="token punctuation">{</span>
	<span class="token comment">// Local is mainnet Petersburg, remote announces the same. No future fork is announced.</span>
	<span class="token punctuation">{</span><span class="token number">7987396</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x668db0af</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

	<span class="token comment">// Local is mainnet Petersburg, remote announces the same. Remote also announces a next fork</span>
	<span class="token comment">// at block 0xffffffff, but that is uncertain.</span>
	<span class="token punctuation">{</span><span class="token number">7987396</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x668db0af</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> math<span class="token punctuation">.</span>MaxUint64<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

	<span class="token comment">// Local is mainnet currently in Byzantium only (so it's aware of Petersburg), remote announces</span>
	<span class="token comment">// also Byzantium, but it's not yet aware of Petersburg (e.g. non updated node before the fork).</span>
	<span class="token comment">// In this case we don't know if Petersburg passed yet or not.</span>
	<span class="token punctuation">{</span><span class="token number">7279999</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xa00bc324</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

	<span class="token comment">// Local is mainnet currently in Byzantium only (so it's aware of Petersburg), remote announces</span>
	<span class="token comment">// also Byzantium, and it's also aware of Petersburg (e.g. updated node before the fork). We</span>
	<span class="token comment">// don't know if Petersburg passed yet (will pass) or not.</span>
	<span class="token punctuation">{</span><span class="token number">7279999</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xa00bc324</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">7280000</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

	<span class="token comment">// Local is mainnet currently in Byzantium only (so it's aware of Petersburg), remote announces</span>
	<span class="token comment">// also Byzantium, and it's also aware of some random fork (e.g. misconfigured Petersburg). As</span>
	<span class="token comment">// neither forks passed at neither nodes, they may mismatch, but we still connect for now.</span>
	<span class="token punctuation">{</span><span class="token number">7279999</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xa00bc324</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> math<span class="token punctuation">.</span>MaxUint64<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

	<span class="token comment">// Local is mainnet Petersburg, remote announces Byzantium + knowledge about Petersburg. Remote</span>
	<span class="token comment">// is simply out of sync, accept.</span>
	<span class="token punctuation">{</span><span class="token number">7987396</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xa00bc324</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">7280000</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

	<span class="token comment">// Local is mainnet Petersburg, remote announces Spurious + knowledge about Byzantium. Remote</span>
	<span class="token comment">// is definitely out of sync. It may or may not need the Petersburg update, we don't know yet.</span>
	<span class="token punctuation">{</span><span class="token number">7987396</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x3edd5b10</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">4370000</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

	<span class="token comment">// Local is mainnet Byzantium, remote announces Petersburg. Local is out of sync, accept.</span>
	<span class="token punctuation">{</span><span class="token number">7279999</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x668db0af</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

	<span class="token comment">// Local is mainnet Spurious, remote announces Byzantium, but is not aware of Petersburg. Local</span>
	<span class="token comment">// out of sync. Local also knows about a future fork, but that is uncertain yet.</span>
	<span class="token punctuation">{</span><span class="token number">4369999</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xa00bc324</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

	<span class="token comment">// Local is mainnet Petersburg. remote announces Byzantium but is not aware of further forks.</span>
	<span class="token comment">// Remote needs software update.</span>
	<span class="token punctuation">{</span><span class="token number">7987396</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xa00bc324</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> ErrRemoteStale<span class="token punctuation">}</span><span class="token punctuation">,</span>

	<span class="token comment">// Local is mainnet Petersburg, and isn't aware of more forks. Remote announces Petersburg +</span>
	<span class="token comment">// 0xffffffff. Local needs software update, reject.</span>
	<span class="token punctuation">{</span><span class="token number">7987396</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x5cddc0e1</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> ErrLocalIncompatibleOrStale<span class="token punctuation">}</span><span class="token punctuation">,</span>

	<span class="token comment">// Local is mainnet Byzantium, and is aware of Petersburg. Remote announces Petersburg +</span>
	<span class="token comment">// 0xffffffff. Local needs software update, reject.</span>
	<span class="token punctuation">{</span><span class="token number">7279999</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x5cddc0e1</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> ErrLocalIncompatibleOrStale<span class="token punctuation">}</span><span class="token punctuation">,</span>

	<span class="token comment">// Local is mainnet Petersburg, remote is Rinkeby Petersburg.</span>
	<span class="token punctuation">{</span><span class="token number">7987396</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xafec6b27</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> ErrLocalIncompatibleOrStale<span class="token punctuation">}</span><span class="token punctuation">,</span>

	<span class="token comment">// Local is mainnet Petersburg, far in the future. Remote announces Gopherium (non existing fork)</span>
	<span class="token comment">// at some future block 88888888, for itself, but past block for local. Local is incompatible.</span>
	<span class="token comment">//</span>
	<span class="token comment">// This case detects non-upgraded nodes with majority hash power (typical Ropsten mess).</span>
	<span class="token punctuation">{</span><span class="token number">88888888</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0x668db0af</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">88888888</span><span class="token punctuation">}</span><span class="token punctuation">,</span> ErrLocalIncompatibleOrStale<span class="token punctuation">}</span><span class="token punctuation">,</span>

	<span class="token comment">// Local is mainnet Byzantium. Remote is also in Byzantium, but announces Gopherium (non existing</span>
	<span class="token comment">// fork) at block 7279999, before Petersburg. Local is incompatible.</span>
	<span class="token punctuation">{</span><span class="token number">7279999</span><span class="token punctuation">,</span> ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xa00bc324</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">7279999</span><span class="token punctuation">}</span><span class="token punctuation">,</span> ErrLocalIncompatibleOrStale<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br></div></div><p>Here's a couple of tests to verify the proper RLP encoding (since <code>FORK_HASH</code> is a 4 byte binary but <code>FORK_NEXT</code> is an 8 byte quantity):</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>tests <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">struct</span> <span class="token punctuation">{</span>
  id   ID
  want <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span>
<span class="token punctuation">}</span><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    common<span class="token punctuation">.</span><span class="token function">Hex2Bytes</span><span class="token punctuation">(</span><span class="token string">&quot;c6840000000080&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> <span class="token number">0xdeadbeef</span><span class="token punctuation">,</span> Next<span class="token punctuation">:</span> <span class="token number">0xBADDCAFE</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    common<span class="token punctuation">.</span><span class="token function">Hex2Bytes</span><span class="token punctuation">(</span><span class="token string">&quot;ca84deadbeef84baddcafe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    ID<span class="token punctuation">{</span>Hash<span class="token punctuation">:</span> math<span class="token punctuation">.</span>MaxUint32<span class="token punctuation">,</span> Next<span class="token punctuation">:</span> math<span class="token punctuation">.</span>MaxUint64<span class="token punctuation">}</span><span class="token punctuation">,</span>
    common<span class="token punctuation">.</span><span class="token function">Hex2Bytes</span><span class="token punctuation">(</span><span class="token string">&quot;ce84ffffffff88ffffffffffffffff&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="implementation"><a href="#implementation" class="header-anchor">#</a> Implementation</h2> <p>Geth: https://github.com/ethereum/go-ethereum/tree/master/core/forkid</p> <h2 id="copyright"><a href="#copyright" class="header-anchor">#</a> Copyright</h2> <p>Copyright and related rights waived via <a href="https://creativecommons.org/publicdomain/zero/1.0/" target="_blank" rel="noopener noreferrer">CC0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ethlibrary/EIPs/edit/master/EIPS/eip-2124.md" target="_blank" rel="noopener noreferrer">帮助完善文档</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/26/2021, 5:29:34 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a13d8931.js" defer></script><script src="/assets/js/3.afc73834.js" defer></script><script src="/assets/js/195.9a12a7ef.js" defer></script>
  </body>
</html>
