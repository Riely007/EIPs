<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>AUTH and AUTHCALL opcodes | 以太坊改进提案 EIPs</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="以太坊改进提案（EIPs）描述了以太坊平台的标准，包括核心协议规范，客户端API和合约标准。">
    
    <link rel="preload" href="/assets/css/0.styles.89e32c3d.css" as="style"><link rel="preload" href="/assets/js/app.a13d8931.js" as="script"><link rel="preload" href="/assets/js/3.afc73834.js" as="script"><link rel="preload" href="/assets/js/15.9ca9208b.js" as="script"><link rel="prefetch" href="/assets/js/10.b7e21e5d.js"><link rel="prefetch" href="/assets/js/100.d5d858e7.js"><link rel="prefetch" href="/assets/js/101.e1db9cf8.js"><link rel="prefetch" href="/assets/js/102.f33c0db7.js"><link rel="prefetch" href="/assets/js/103.9b2f992f.js"><link rel="prefetch" href="/assets/js/104.4682985f.js"><link rel="prefetch" href="/assets/js/105.f9e5318b.js"><link rel="prefetch" href="/assets/js/106.9c75a4a1.js"><link rel="prefetch" href="/assets/js/107.a77b3902.js"><link rel="prefetch" href="/assets/js/108.e6af934c.js"><link rel="prefetch" href="/assets/js/109.ea2fe245.js"><link rel="prefetch" href="/assets/js/11.19d07763.js"><link rel="prefetch" href="/assets/js/110.c7c5923b.js"><link rel="prefetch" href="/assets/js/111.53019564.js"><link rel="prefetch" href="/assets/js/112.2678b5bc.js"><link rel="prefetch" href="/assets/js/113.65344b60.js"><link rel="prefetch" href="/assets/js/114.34870900.js"><link rel="prefetch" href="/assets/js/115.e0ce944c.js"><link rel="prefetch" href="/assets/js/116.05caef5d.js"><link rel="prefetch" href="/assets/js/117.eb1f8851.js"><link rel="prefetch" href="/assets/js/118.1d54235b.js"><link rel="prefetch" href="/assets/js/119.57439d26.js"><link rel="prefetch" href="/assets/js/12.cc14cc21.js"><link rel="prefetch" href="/assets/js/120.fec4a349.js"><link rel="prefetch" href="/assets/js/121.e6ee3bd0.js"><link rel="prefetch" href="/assets/js/122.8b1067e2.js"><link rel="prefetch" href="/assets/js/123.e9852421.js"><link rel="prefetch" href="/assets/js/124.e2572e3e.js"><link rel="prefetch" href="/assets/js/125.d02927d3.js"><link rel="prefetch" href="/assets/js/126.5443f529.js"><link rel="prefetch" href="/assets/js/127.df02ad53.js"><link rel="prefetch" href="/assets/js/128.86d06d73.js"><link rel="prefetch" href="/assets/js/129.4ba20791.js"><link rel="prefetch" href="/assets/js/13.66816190.js"><link rel="prefetch" href="/assets/js/130.a3f03ff0.js"><link rel="prefetch" href="/assets/js/131.626e55b3.js"><link rel="prefetch" href="/assets/js/132.95f1e93d.js"><link rel="prefetch" href="/assets/js/133.6e47359a.js"><link rel="prefetch" href="/assets/js/134.47e4440e.js"><link rel="prefetch" href="/assets/js/135.adb1a4c4.js"><link rel="prefetch" href="/assets/js/136.45c43972.js"><link rel="prefetch" href="/assets/js/137.8ba370d0.js"><link rel="prefetch" href="/assets/js/138.74346e65.js"><link rel="prefetch" href="/assets/js/139.fad68529.js"><link rel="prefetch" href="/assets/js/14.1067acde.js"><link rel="prefetch" href="/assets/js/140.d7cf0c13.js"><link rel="prefetch" href="/assets/js/141.53ad4e2c.js"><link rel="prefetch" href="/assets/js/142.3054db6d.js"><link rel="prefetch" href="/assets/js/143.752707de.js"><link rel="prefetch" href="/assets/js/144.6bb5b315.js"><link rel="prefetch" href="/assets/js/145.5be11191.js"><link rel="prefetch" href="/assets/js/146.65c4a5f7.js"><link rel="prefetch" href="/assets/js/147.503abedf.js"><link rel="prefetch" href="/assets/js/148.fac10f82.js"><link rel="prefetch" href="/assets/js/149.39bdc952.js"><link rel="prefetch" href="/assets/js/150.763447dd.js"><link rel="prefetch" href="/assets/js/151.74711268.js"><link rel="prefetch" href="/assets/js/152.04b548a4.js"><link rel="prefetch" href="/assets/js/153.f76cfea2.js"><link rel="prefetch" href="/assets/js/154.63dde107.js"><link rel="prefetch" href="/assets/js/155.0c715174.js"><link rel="prefetch" href="/assets/js/156.685fab04.js"><link rel="prefetch" href="/assets/js/157.6739174d.js"><link rel="prefetch" href="/assets/js/158.882bbbfc.js"><link rel="prefetch" href="/assets/js/159.aede9782.js"><link rel="prefetch" href="/assets/js/16.9eea9a64.js"><link rel="prefetch" href="/assets/js/160.d9be3959.js"><link rel="prefetch" href="/assets/js/161.76cc08ef.js"><link rel="prefetch" href="/assets/js/162.1bdec2e1.js"><link rel="prefetch" href="/assets/js/163.ac0295b3.js"><link rel="prefetch" href="/assets/js/164.cf094dd8.js"><link rel="prefetch" href="/assets/js/165.fa43d86b.js"><link rel="prefetch" href="/assets/js/166.b42e919a.js"><link rel="prefetch" href="/assets/js/167.cd4e2412.js"><link rel="prefetch" href="/assets/js/168.b923679f.js"><link rel="prefetch" href="/assets/js/169.0381e4c3.js"><link rel="prefetch" href="/assets/js/17.8d0803f5.js"><link rel="prefetch" href="/assets/js/170.07048ad0.js"><link rel="prefetch" href="/assets/js/171.efbf2d1b.js"><link rel="prefetch" href="/assets/js/172.c6f3f3a1.js"><link rel="prefetch" href="/assets/js/173.b0448642.js"><link rel="prefetch" href="/assets/js/174.9c3b47d1.js"><link rel="prefetch" href="/assets/js/175.6399aebe.js"><link rel="prefetch" href="/assets/js/176.72f40c53.js"><link rel="prefetch" href="/assets/js/177.e4a8654e.js"><link rel="prefetch" href="/assets/js/178.d88d2f1f.js"><link rel="prefetch" href="/assets/js/179.5f89ba63.js"><link rel="prefetch" href="/assets/js/18.3444113b.js"><link rel="prefetch" href="/assets/js/180.9add0321.js"><link rel="prefetch" href="/assets/js/181.a089c28c.js"><link rel="prefetch" href="/assets/js/182.5c030e78.js"><link rel="prefetch" href="/assets/js/183.a96244f5.js"><link rel="prefetch" href="/assets/js/184.8a73b7fa.js"><link rel="prefetch" href="/assets/js/185.39aa4852.js"><link rel="prefetch" href="/assets/js/186.63c92b48.js"><link rel="prefetch" href="/assets/js/187.0afea76b.js"><link rel="prefetch" href="/assets/js/188.4b72b322.js"><link rel="prefetch" href="/assets/js/189.dacc64a4.js"><link rel="prefetch" href="/assets/js/19.45b60500.js"><link rel="prefetch" href="/assets/js/190.6e72d819.js"><link rel="prefetch" href="/assets/js/191.f3361d30.js"><link rel="prefetch" href="/assets/js/192.d02dc2b3.js"><link rel="prefetch" href="/assets/js/193.9185ff86.js"><link rel="prefetch" href="/assets/js/194.109e4d2b.js"><link rel="prefetch" href="/assets/js/195.9a12a7ef.js"><link rel="prefetch" href="/assets/js/196.30492964.js"><link rel="prefetch" href="/assets/js/197.b8f1016e.js"><link rel="prefetch" href="/assets/js/198.cf2ff396.js"><link rel="prefetch" href="/assets/js/199.617d97ea.js"><link rel="prefetch" href="/assets/js/20.ee4a86f1.js"><link rel="prefetch" href="/assets/js/200.414ac8b8.js"><link rel="prefetch" href="/assets/js/201.6eb83ac5.js"><link rel="prefetch" href="/assets/js/202.f94a8455.js"><link rel="prefetch" href="/assets/js/203.fe4c3d1f.js"><link rel="prefetch" href="/assets/js/204.003cdcb5.js"><link rel="prefetch" href="/assets/js/205.dfb2370b.js"><link rel="prefetch" href="/assets/js/206.a3cdde0f.js"><link rel="prefetch" href="/assets/js/207.7eeb49e5.js"><link rel="prefetch" href="/assets/js/208.f77631f1.js"><link rel="prefetch" href="/assets/js/209.03b79d5b.js"><link rel="prefetch" href="/assets/js/21.81e9a796.js"><link rel="prefetch" href="/assets/js/210.4d77fab4.js"><link rel="prefetch" href="/assets/js/211.504c34d5.js"><link rel="prefetch" href="/assets/js/212.71bb8bf5.js"><link rel="prefetch" href="/assets/js/213.a3b6c27d.js"><link rel="prefetch" href="/assets/js/214.0da60311.js"><link rel="prefetch" href="/assets/js/215.cdeb87d0.js"><link rel="prefetch" href="/assets/js/216.75ce111f.js"><link rel="prefetch" href="/assets/js/217.2a924ebe.js"><link rel="prefetch" href="/assets/js/218.b3782b37.js"><link rel="prefetch" href="/assets/js/219.a7b3d0e2.js"><link rel="prefetch" href="/assets/js/22.037348a7.js"><link rel="prefetch" href="/assets/js/220.67f4dc4d.js"><link rel="prefetch" href="/assets/js/221.122e58c3.js"><link rel="prefetch" href="/assets/js/222.4a6ce5ee.js"><link rel="prefetch" href="/assets/js/223.38c97c72.js"><link rel="prefetch" href="/assets/js/224.08f05ad3.js"><link rel="prefetch" href="/assets/js/225.a1f1248d.js"><link rel="prefetch" href="/assets/js/226.49679af1.js"><link rel="prefetch" href="/assets/js/227.272b5118.js"><link rel="prefetch" href="/assets/js/228.97fe27a2.js"><link rel="prefetch" href="/assets/js/229.08893382.js"><link rel="prefetch" href="/assets/js/23.e7c462f9.js"><link rel="prefetch" href="/assets/js/230.fca4ec8d.js"><link rel="prefetch" href="/assets/js/231.dcf2e717.js"><link rel="prefetch" href="/assets/js/232.ad58634e.js"><link rel="prefetch" href="/assets/js/233.62b51320.js"><link rel="prefetch" href="/assets/js/234.366a5c15.js"><link rel="prefetch" href="/assets/js/235.37ee5e06.js"><link rel="prefetch" href="/assets/js/236.c8db6b56.js"><link rel="prefetch" href="/assets/js/237.2a5623bb.js"><link rel="prefetch" href="/assets/js/238.a1e8e150.js"><link rel="prefetch" href="/assets/js/239.9173cd25.js"><link rel="prefetch" href="/assets/js/24.b2111a14.js"><link rel="prefetch" href="/assets/js/240.74555993.js"><link rel="prefetch" href="/assets/js/241.78b20824.js"><link rel="prefetch" href="/assets/js/242.6acd697d.js"><link rel="prefetch" href="/assets/js/243.e43066f7.js"><link rel="prefetch" href="/assets/js/244.73e01f3b.js"><link rel="prefetch" href="/assets/js/245.3f27ce09.js"><link rel="prefetch" href="/assets/js/246.c0bf05db.js"><link rel="prefetch" href="/assets/js/247.0d837589.js"><link rel="prefetch" href="/assets/js/248.d09c386a.js"><link rel="prefetch" href="/assets/js/249.10459d63.js"><link rel="prefetch" href="/assets/js/25.0610f8ef.js"><link rel="prefetch" href="/assets/js/250.f48824df.js"><link rel="prefetch" href="/assets/js/251.121f3d80.js"><link rel="prefetch" href="/assets/js/252.5f893054.js"><link rel="prefetch" href="/assets/js/253.1417eb3b.js"><link rel="prefetch" href="/assets/js/254.5eac655f.js"><link rel="prefetch" href="/assets/js/255.c730cba3.js"><link rel="prefetch" href="/assets/js/256.1219af97.js"><link rel="prefetch" href="/assets/js/257.04701e9e.js"><link rel="prefetch" href="/assets/js/258.3a3b2150.js"><link rel="prefetch" href="/assets/js/259.e70aceaf.js"><link rel="prefetch" href="/assets/js/26.9114f6fc.js"><link rel="prefetch" href="/assets/js/260.7b8b2967.js"><link rel="prefetch" href="/assets/js/261.c0961706.js"><link rel="prefetch" href="/assets/js/262.d6f757d3.js"><link rel="prefetch" href="/assets/js/263.5659fcc5.js"><link rel="prefetch" href="/assets/js/264.8b56c627.js"><link rel="prefetch" href="/assets/js/265.16d5ce3a.js"><link rel="prefetch" href="/assets/js/266.17f217c2.js"><link rel="prefetch" href="/assets/js/267.e70076df.js"><link rel="prefetch" href="/assets/js/268.b06b7a1e.js"><link rel="prefetch" href="/assets/js/269.b5819c04.js"><link rel="prefetch" href="/assets/js/27.2f304f70.js"><link rel="prefetch" href="/assets/js/270.0beee4b9.js"><link rel="prefetch" href="/assets/js/271.90d0c5e4.js"><link rel="prefetch" href="/assets/js/272.1d617a52.js"><link rel="prefetch" href="/assets/js/273.5d7054ff.js"><link rel="prefetch" href="/assets/js/274.eedc246e.js"><link rel="prefetch" href="/assets/js/275.e89375ea.js"><link rel="prefetch" href="/assets/js/276.1ee4957e.js"><link rel="prefetch" href="/assets/js/277.3fb8abc6.js"><link rel="prefetch" href="/assets/js/278.bc288b6e.js"><link rel="prefetch" href="/assets/js/279.c3111a87.js"><link rel="prefetch" href="/assets/js/28.6a081e3d.js"><link rel="prefetch" href="/assets/js/280.d7edbe4d.js"><link rel="prefetch" href="/assets/js/281.98d9104a.js"><link rel="prefetch" href="/assets/js/282.d09079ea.js"><link rel="prefetch" href="/assets/js/283.996adb15.js"><link rel="prefetch" href="/assets/js/284.ff69d3db.js"><link rel="prefetch" href="/assets/js/285.75d86772.js"><link rel="prefetch" href="/assets/js/286.48f2c786.js"><link rel="prefetch" href="/assets/js/287.964dc8a8.js"><link rel="prefetch" href="/assets/js/288.f50b81c4.js"><link rel="prefetch" href="/assets/js/289.b15ef4ba.js"><link rel="prefetch" href="/assets/js/29.e6c29d28.js"><link rel="prefetch" href="/assets/js/290.065686f6.js"><link rel="prefetch" href="/assets/js/291.8e91cb89.js"><link rel="prefetch" href="/assets/js/292.23991b2a.js"><link rel="prefetch" href="/assets/js/293.d89282cb.js"><link rel="prefetch" href="/assets/js/294.8459cf6b.js"><link rel="prefetch" href="/assets/js/295.5159bb70.js"><link rel="prefetch" href="/assets/js/296.bad535dd.js"><link rel="prefetch" href="/assets/js/297.a89c8004.js"><link rel="prefetch" href="/assets/js/298.bfc2ed34.js"><link rel="prefetch" href="/assets/js/299.ed75d8ac.js"><link rel="prefetch" href="/assets/js/30.7ef93552.js"><link rel="prefetch" href="/assets/js/300.04fd45af.js"><link rel="prefetch" href="/assets/js/301.913d3df9.js"><link rel="prefetch" href="/assets/js/302.10b258dd.js"><link rel="prefetch" href="/assets/js/303.fbdf4e67.js"><link rel="prefetch" href="/assets/js/304.e0ff7d5b.js"><link rel="prefetch" href="/assets/js/305.300c5349.js"><link rel="prefetch" href="/assets/js/306.9f73bc93.js"><link rel="prefetch" href="/assets/js/307.b187f491.js"><link rel="prefetch" href="/assets/js/308.d03c07b3.js"><link rel="prefetch" href="/assets/js/309.937b56a3.js"><link rel="prefetch" href="/assets/js/31.7afea5f6.js"><link rel="prefetch" href="/assets/js/310.635a8c4d.js"><link rel="prefetch" href="/assets/js/311.573fcf4a.js"><link rel="prefetch" href="/assets/js/312.bc67fce0.js"><link rel="prefetch" href="/assets/js/313.b5013426.js"><link rel="prefetch" href="/assets/js/314.ae21fa05.js"><link rel="prefetch" href="/assets/js/315.37182c2b.js"><link rel="prefetch" href="/assets/js/316.06cf15a9.js"><link rel="prefetch" href="/assets/js/317.df759a5b.js"><link rel="prefetch" href="/assets/js/318.1a66ad2b.js"><link rel="prefetch" href="/assets/js/319.17d9681e.js"><link rel="prefetch" href="/assets/js/32.861f9380.js"><link rel="prefetch" href="/assets/js/320.10769343.js"><link rel="prefetch" href="/assets/js/321.cc4a3790.js"><link rel="prefetch" href="/assets/js/322.d2b9bced.js"><link rel="prefetch" href="/assets/js/323.dadd7af5.js"><link rel="prefetch" href="/assets/js/324.4281b9b7.js"><link rel="prefetch" href="/assets/js/325.313d6817.js"><link rel="prefetch" href="/assets/js/326.e63bdc82.js"><link rel="prefetch" href="/assets/js/327.f47507e0.js"><link rel="prefetch" href="/assets/js/328.f35cf934.js"><link rel="prefetch" href="/assets/js/329.a1084770.js"><link rel="prefetch" href="/assets/js/33.ab9e8c2b.js"><link rel="prefetch" href="/assets/js/330.ca4cd65f.js"><link rel="prefetch" href="/assets/js/331.e75a5907.js"><link rel="prefetch" href="/assets/js/332.fb511231.js"><link rel="prefetch" href="/assets/js/333.f93dbb9e.js"><link rel="prefetch" href="/assets/js/334.a71bbaa5.js"><link rel="prefetch" href="/assets/js/335.2fa937a5.js"><link rel="prefetch" href="/assets/js/336.a9679a8c.js"><link rel="prefetch" href="/assets/js/337.597945ba.js"><link rel="prefetch" href="/assets/js/338.05b854a8.js"><link rel="prefetch" href="/assets/js/339.fb34c537.js"><link rel="prefetch" href="/assets/js/34.91cf34bb.js"><link rel="prefetch" href="/assets/js/340.bb04bb94.js"><link rel="prefetch" href="/assets/js/341.d8eab431.js"><link rel="prefetch" href="/assets/js/342.adb6fccd.js"><link rel="prefetch" href="/assets/js/343.2e514ff7.js"><link rel="prefetch" href="/assets/js/344.ae288347.js"><link rel="prefetch" href="/assets/js/345.36cef5e0.js"><link rel="prefetch" href="/assets/js/346.18900139.js"><link rel="prefetch" href="/assets/js/347.55de0e5f.js"><link rel="prefetch" href="/assets/js/348.e8df7344.js"><link rel="prefetch" href="/assets/js/349.391634ff.js"><link rel="prefetch" href="/assets/js/35.a54aaacc.js"><link rel="prefetch" href="/assets/js/350.6ed9c27e.js"><link rel="prefetch" href="/assets/js/351.13d8f554.js"><link rel="prefetch" href="/assets/js/352.42a626e4.js"><link rel="prefetch" href="/assets/js/353.28e60cfb.js"><link rel="prefetch" href="/assets/js/354.1d876de3.js"><link rel="prefetch" href="/assets/js/355.be9dd30e.js"><link rel="prefetch" href="/assets/js/356.c76485ba.js"><link rel="prefetch" href="/assets/js/357.3beca4a2.js"><link rel="prefetch" href="/assets/js/358.34ce9b7c.js"><link rel="prefetch" href="/assets/js/359.62662c8a.js"><link rel="prefetch" href="/assets/js/36.1fb34483.js"><link rel="prefetch" href="/assets/js/360.1d4fd1c2.js"><link rel="prefetch" href="/assets/js/361.cedc472b.js"><link rel="prefetch" href="/assets/js/362.1a42a5a9.js"><link rel="prefetch" href="/assets/js/363.3212b786.js"><link rel="prefetch" href="/assets/js/364.795f5fbb.js"><link rel="prefetch" href="/assets/js/365.ba5aeafd.js"><link rel="prefetch" href="/assets/js/366.9e7c06f4.js"><link rel="prefetch" href="/assets/js/367.520bbbb6.js"><link rel="prefetch" href="/assets/js/368.1645c28e.js"><link rel="prefetch" href="/assets/js/369.3809a538.js"><link rel="prefetch" href="/assets/js/37.ee12bd46.js"><link rel="prefetch" href="/assets/js/370.217b10df.js"><link rel="prefetch" href="/assets/js/371.c8a9e0a9.js"><link rel="prefetch" href="/assets/js/372.247d9278.js"><link rel="prefetch" href="/assets/js/373.0eed1f0a.js"><link rel="prefetch" href="/assets/js/374.881713dc.js"><link rel="prefetch" href="/assets/js/375.b09c525d.js"><link rel="prefetch" href="/assets/js/376.43c32017.js"><link rel="prefetch" href="/assets/js/377.47cbbf1d.js"><link rel="prefetch" href="/assets/js/378.dd3eec1a.js"><link rel="prefetch" href="/assets/js/379.191b4f64.js"><link rel="prefetch" href="/assets/js/38.242d9c7f.js"><link rel="prefetch" href="/assets/js/380.8f916b60.js"><link rel="prefetch" href="/assets/js/381.fe1dfc6a.js"><link rel="prefetch" href="/assets/js/382.067d85f2.js"><link rel="prefetch" href="/assets/js/383.eeab62ac.js"><link rel="prefetch" href="/assets/js/384.ffab213d.js"><link rel="prefetch" href="/assets/js/385.94da6ae9.js"><link rel="prefetch" href="/assets/js/386.991dd01d.js"><link rel="prefetch" href="/assets/js/387.ffb790b4.js"><link rel="prefetch" href="/assets/js/388.ed3f39f5.js"><link rel="prefetch" href="/assets/js/389.a6174e1c.js"><link rel="prefetch" href="/assets/js/39.dbcc5d61.js"><link rel="prefetch" href="/assets/js/390.fe916439.js"><link rel="prefetch" href="/assets/js/391.69f751d7.js"><link rel="prefetch" href="/assets/js/392.e6c52ac2.js"><link rel="prefetch" href="/assets/js/393.7da57f52.js"><link rel="prefetch" href="/assets/js/394.1a7a717f.js"><link rel="prefetch" href="/assets/js/395.3399844a.js"><link rel="prefetch" href="/assets/js/396.7f2e8145.js"><link rel="prefetch" href="/assets/js/397.42b4026a.js"><link rel="prefetch" href="/assets/js/398.5c231ed1.js"><link rel="prefetch" href="/assets/js/399.4566824b.js"><link rel="prefetch" href="/assets/js/4.fea0df6a.js"><link rel="prefetch" href="/assets/js/40.493a59f4.js"><link rel="prefetch" href="/assets/js/400.6882e1d0.js"><link rel="prefetch" href="/assets/js/401.527ff51d.js"><link rel="prefetch" href="/assets/js/402.e9c37d2a.js"><link rel="prefetch" href="/assets/js/403.360b2d7d.js"><link rel="prefetch" href="/assets/js/404.4d3adaac.js"><link rel="prefetch" href="/assets/js/405.c6785e58.js"><link rel="prefetch" href="/assets/js/406.ea8781ae.js"><link rel="prefetch" href="/assets/js/407.b0463036.js"><link rel="prefetch" href="/assets/js/408.56b3f633.js"><link rel="prefetch" href="/assets/js/409.83b77a08.js"><link rel="prefetch" href="/assets/js/41.bd45f48a.js"><link rel="prefetch" href="/assets/js/410.808144cb.js"><link rel="prefetch" href="/assets/js/411.efd2ae36.js"><link rel="prefetch" href="/assets/js/412.42b1274b.js"><link rel="prefetch" href="/assets/js/42.3475d232.js"><link rel="prefetch" href="/assets/js/43.2407adcb.js"><link rel="prefetch" href="/assets/js/44.e2a316c5.js"><link rel="prefetch" href="/assets/js/45.1c5f24df.js"><link rel="prefetch" href="/assets/js/46.18a61726.js"><link rel="prefetch" href="/assets/js/47.707f9f7a.js"><link rel="prefetch" href="/assets/js/48.5dd41842.js"><link rel="prefetch" href="/assets/js/49.d3acd899.js"><link rel="prefetch" href="/assets/js/5.461bccd8.js"><link rel="prefetch" href="/assets/js/50.02c1a863.js"><link rel="prefetch" href="/assets/js/51.ccf0ba79.js"><link rel="prefetch" href="/assets/js/52.3aee611f.js"><link rel="prefetch" href="/assets/js/53.bf3daa85.js"><link rel="prefetch" href="/assets/js/54.d61cd0a6.js"><link rel="prefetch" href="/assets/js/55.5986d91d.js"><link rel="prefetch" href="/assets/js/56.da7d4622.js"><link rel="prefetch" href="/assets/js/57.a53216e9.js"><link rel="prefetch" href="/assets/js/58.eb424782.js"><link rel="prefetch" href="/assets/js/59.0db825e2.js"><link rel="prefetch" href="/assets/js/6.76cd68c6.js"><link rel="prefetch" href="/assets/js/60.885ad249.js"><link rel="prefetch" href="/assets/js/61.9a010ecb.js"><link rel="prefetch" href="/assets/js/62.907dc688.js"><link rel="prefetch" href="/assets/js/63.69f56658.js"><link rel="prefetch" href="/assets/js/64.ec17ab0c.js"><link rel="prefetch" href="/assets/js/65.555f05e2.js"><link rel="prefetch" href="/assets/js/66.82f26703.js"><link rel="prefetch" href="/assets/js/67.3d43cd18.js"><link rel="prefetch" href="/assets/js/68.b14b7646.js"><link rel="prefetch" href="/assets/js/69.f4f9155f.js"><link rel="prefetch" href="/assets/js/7.f2fbf882.js"><link rel="prefetch" href="/assets/js/70.146046b6.js"><link rel="prefetch" href="/assets/js/71.5cc26b01.js"><link rel="prefetch" href="/assets/js/72.bc119d92.js"><link rel="prefetch" href="/assets/js/73.9d63e7dc.js"><link rel="prefetch" href="/assets/js/74.f12f047e.js"><link rel="prefetch" href="/assets/js/75.131756e3.js"><link rel="prefetch" href="/assets/js/76.147c95b9.js"><link rel="prefetch" href="/assets/js/77.4f81bf5f.js"><link rel="prefetch" href="/assets/js/78.2620317a.js"><link rel="prefetch" href="/assets/js/79.7d79e1df.js"><link rel="prefetch" href="/assets/js/8.d346a35e.js"><link rel="prefetch" href="/assets/js/80.08435f23.js"><link rel="prefetch" href="/assets/js/81.bbea59aa.js"><link rel="prefetch" href="/assets/js/82.93bbfeeb.js"><link rel="prefetch" href="/assets/js/83.9e0f2d3f.js"><link rel="prefetch" href="/assets/js/84.2a78f0ef.js"><link rel="prefetch" href="/assets/js/85.464597f8.js"><link rel="prefetch" href="/assets/js/86.8cced385.js"><link rel="prefetch" href="/assets/js/87.6eab3983.js"><link rel="prefetch" href="/assets/js/88.919be664.js"><link rel="prefetch" href="/assets/js/89.a9c88099.js"><link rel="prefetch" href="/assets/js/9.2b013f04.js"><link rel="prefetch" href="/assets/js/90.e30432e7.js"><link rel="prefetch" href="/assets/js/91.6b17f9d5.js"><link rel="prefetch" href="/assets/js/92.044d73f7.js"><link rel="prefetch" href="/assets/js/93.446151cb.js"><link rel="prefetch" href="/assets/js/94.777e77bb.js"><link rel="prefetch" href="/assets/js/95.dbda6d80.js"><link rel="prefetch" href="/assets/js/96.e280ef31.js"><link rel="prefetch" href="/assets/js/97.2d68e74b.js"><link rel="prefetch" href="/assets/js/98.93faeca6.js"><link rel="prefetch" href="/assets/js/99.8285fa98.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.029a7c95.js">
    <link rel="stylesheet" href="/assets/css/0.styles.89e32c3d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">以太坊改进提案 EIPs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://ethlibrary.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  About us
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/ethlibrary/EIPs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://ethlibrary.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  About us
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/ethlibrary/EIPs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/all.html" class="sidebar-link">All EIPs</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Status</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/draft.html" class="sidebar-link">Draft</a></li><li><a href="/review.html" class="sidebar-link">Review</a></li><li><a href="/lastCall.html" class="sidebar-link">Last Call</a></li><li><a href="/accepted.html" class="sidebar-link">Accepted</a></li><li><a href="/final_and_living.html" class="sidebar-link">Final and Living</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Type</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/core.html" class="sidebar-link">Core (165)</a></li><li><a href="/networking.html" class="sidebar-link">Networking (11)</a></li><li><a href="/interface.html" class="sidebar-link">Interface (38)</a></li><li><a href="/erc.html" class="sidebar-link">ERC (153)</a></li><li><a href="/meta.html" class="sidebar-link">Meta (18)</a></li><li><a href="/informational.html" class="sidebar-link">Informational (6)</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="simple-summary"><a href="#simple-summary" class="header-anchor">#</a> Simple Summary</h2> <p>Allow externally owned accounts (EOAs) to delegate control of their account to a contract.</p> <h2 id="abstract"><a href="#abstract" class="header-anchor">#</a> Abstract</h2> <p>This EIP introduces two EVM instructions <code>AUTH</code> and <code>AUTHCALL</code>. The first sets a context variable <code>authorized</code> based on an ECDSA signature. The second sends a call as the <code>authorized</code>. This essentially delegates control of the EOA to smart contract.</p> <h2 id="motivation"><a href="#motivation" class="header-anchor">#</a> Motivation</h2> <p>Adding more functionlity to EOAs has been a long-standing feature request. The requests have spanned from implementing batching capabilities, allowing for gas sponsoring, expirations, scripting, and beyond. These changes often mean increased complexity and rigidity of the protocol. In some cases, it also means increased attack surfaces.</p> <p>This EIP takes a different approach. Instead of enshrining these capabilities in the protocol as transaction validity requirements, it allows users to <em>delegate</em> control of their EOA to a contract. This gives developers a flexible framework for developing novel transaction schemes for EOAs. A good analogy for the benefit this EIP provides is that it's similar to allowing any EOA to become a smart contract wallet <em>without</em> deploying a contract.</p> <p>Although this EIP provides great benefit to individual users, the leading motivation for this EIP is &quot;sponsored transactions&quot;. This is where the fee for a transaction is provided by a different account than the one that originates the call.</p> <p>With the extraordinary growth of tokens on Ethereum, it has become common for EOAs to hold valuable assets without holding any ether at all. Today, these assets must be converted to ether before they can be used to pay gas fees. However, without ether to pay for the conversion, it's impossible to convert them. Sponsored transactions break the circular dependency.</p> <h2 id="specification"><a href="#specification" class="header-anchor">#</a> Specification</h2> <h3 id="conventions"><a href="#conventions" class="header-anchor">#</a> Conventions</h3> <ul><li><strong><code>top - N</code></strong> - the <code>N</code>th most recently pushed value on the EVM stack, where <code>top - 0</code> is the most recent.</li> <li><strong><code>||</code></strong> - byte concatenation operator.</li> <li><strong>invalid execution</strong> - execution that is invalid and must exit the current execution frame immediately, consuming all remaining gas (in the same way as a stack underflow or invalid jump).</li></ul> <h3 id="constants"><a href="#constants" class="header-anchor">#</a> Constants</h3> <table><thead><tr><th>Constant</th> <th>Value</th></tr></thead> <tbody><tr><td><code>MAGIC</code></td> <td><code>0x03</code></td></tr></tbody></table> <p><code>MAGIC</code> is used for EIP-3074 signatures to prevent signature collisions with other signing formats.</p> <h3 id="context-variables"><a href="#context-variables" class="header-anchor">#</a> Context Variables</h3> <table><thead><tr><th>Variable</th> <th>Type</th> <th style="text-align:left;">Initial Value</th></tr></thead> <tbody><tr><td><code>authorized</code></td> <td><code>address</code></td> <td style="text-align:left;">unset</td></tr></tbody></table> <p>The context variable <code>authorized</code> shall indicate the active account for <code>AUTHCALL</code> instructions in the current frame of execution. If set, <code>authorized</code> shall only contain an account which has given the contract authorization to act on its behalf. An unset value shall indicate that no such account is set and that there is not yet an active account for <code>AUTHCALL</code> instructions in the current frame of execution.</p> <p>The variable has the same scope as the program counter -- <code>authorized</code> persists throughout a single frame of execution of the contract, but is not passed through any calls (including <code>DELEGATECALL</code>). If the same contract is being executed in separate execution frames (ex. a <code>CALL</code> to self), both frames shall have independent values for <code>authorized</code>. Initially in each frame of execution, <code>authorized</code> is always unset, even if a previous execution frame for the same contract has a value.</p> <h3 id="auth-0xf6"><a href="#auth-0xf6" class="header-anchor">#</a> <code>AUTH</code> (<code>0xf6</code>)</h3> <p>A new opcode <code>AUTH</code> shall be created at <code>0xf6</code>. It shall take four stack element inputs and returns one stack element.</p> <h4 id="input"><a href="#input" class="header-anchor">#</a> Input</h4> <table><thead><tr><th>Stack</th> <th>Value</th></tr></thead> <tbody><tr><td><code>top - 0</code></td> <td><code>commit</code></td></tr> <tr><td><code>top - 1</code></td> <td><code>yParity</code></td></tr> <tr><td><code>top - 2</code></td> <td><code>r</code></td></tr> <tr><td><code>top - 3</code></td> <td><code>s</code></td></tr></tbody></table> <h4 id="output"><a href="#output" class="header-anchor">#</a> Output</h4> <table><thead><tr><th>Stack</th> <th>Value</th></tr></thead> <tbody><tr><td><code>top - 0</code></td> <td><code>authorized</code></td></tr></tbody></table> <h4 id="behavior"><a href="#behavior" class="header-anchor">#</a> Behavior</h4> <p>The arguments (<code>yParity</code>, <code>r</code>, <code>s</code>) are interpreted as an ECDSA signature on the secp256k1 curve over the message <code>keccak256(MAGIC || chainId || paddedInvokerAddress || commit)</code>, where:</p> <ul><li><code>chainId</code> is the current chain's <a href="/eip-155.html">EIP-155</a> unique identifier padded to 32 bytes.</li> <li><code>paddedInvokerAddress</code> is the address of the contract executing <code>AUTH</code> (or the active state address in the context of <code>CALLCODE</code> or <code>DELEGATECALL</code>), left-padded with zeroes to a total of 32 bytes (ex. <code>0x000000000000000000000000AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</code>).</li> <li><code>commit</code>, one of the arguments passed into <code>AUTH</code>, is a 32-byte value that can be used to commit to specific additional validity conditions in the invoker's pre-processing logic (e.g. a nonce for replay protection).</li></ul> <p>Signature validity and signer recovery is handled analogous to transaction signatures, including the stricter <code>s</code> range for preventing ECDSA malleability. Note that <code>yParity</code> is expected to be <code>0</code> or <code>1</code>.</p> <p>If the signature is valid, the context variable <code>authorized</code> is set to the signer address. In particular, this is also true if <code>signerAddress == tx.origin</code>, which used to be handled separately in earlier versions of this EIP (see Security Considerations). If the signature is instead invalid, <code>authorized</code> is reset to an unset value.</p> <p><code>AUTH</code> returns the new <code>authorized</code> if set, or <code>0</code> otherwise.</p> <h4 id="gas-cost"><a href="#gas-cost" class="header-anchor">#</a> Gas Cost</h4> <p>The gas cost for <code>AUTH</code> is <code>3100</code>. This is equal to the cost for the <code>ecrecover</code> precompile, plus a bit extra to cover a keccak256 hash and some additional logic.</p> <h3 id="authcall-0xf7"><a href="#authcall-0xf7" class="header-anchor">#</a> <code>AUTHCALL</code> (<code>0xf7</code>)</h3> <p>A new opcode <code>AUTHCALL</code> shall be created at <code>0xf7</code>. It shall take eight stack elements and return one stack element. It matches the behavior of the existing <code>CALL</code> (<code>0xF1</code>) instruction, except where noted below.</p> <h4 id="input-2"><a href="#input-2" class="header-anchor">#</a> Input</h4> <table><thead><tr><th>Stack</th> <th>Value</th></tr></thead> <tbody><tr><td><code>top - 0</code></td> <td><code>gas</code></td></tr> <tr><td><code>top - 1</code></td> <td><code>addr</code></td></tr> <tr><td><code>top - 2</code></td> <td><code>value</code></td></tr> <tr><td><code>top - 3</code></td> <td><code>valueExt</code></td></tr> <tr><td><code>top - 4</code></td> <td><code>argsOffset</code></td></tr> <tr><td><code>top - 5</code></td> <td><code>argsLength</code></td></tr> <tr><td><code>top - 6</code></td> <td><code>retOffset</code></td></tr> <tr><td><code>top - 7</code></td> <td><code>retLength</code></td></tr></tbody></table> <h4 id="output-2"><a href="#output-2" class="header-anchor">#</a> Output</h4> <table><thead><tr><th>Stack</th> <th>Value</th></tr></thead> <tbody><tr><td><code>top - 0</code></td> <td><code>success</code></td></tr></tbody></table> <h4 id="behavior-2"><a href="#behavior-2" class="header-anchor">#</a> Behavior</h4> <p><code>AUTHCALL</code> is interpreted the same as <code>CALL</code>, except for (note: this list is also the order of precedence for the logical checks):</p> <ul><li>If <code>authorized</code> is unset, execution is invalid (as defined above). Otherwise, the caller address for the call is set to <code>authorized</code>.</li> <li>The gas cost, including how much gas is available for the subcall, is specified in the Gas Cost section.</li> <li>If the <code>gas</code> operand is equal to <code>0</code>, the instruction will send all available gas as per <a href="./eip-150">EIP-150</a>.</li> <li>If the gas available for the subcall would be less than <code>gas</code>, execution is invalid.</li> <li>There is no gas stipend, even for non-zero <code>value</code>.</li> <li><code>value</code> is deducted from the balance of the executing contract. It is not paid by <code>authorized</code>. If <code>value</code> is higher than the balance of the executing contract, execution is invalid.</li> <li>If <code>valueExt</code> is not zero, the instruction immediately returns 0. In this case the gas that would have been passed into the call is refunded, but not the gas consumed by the <code>AUTHCALL</code> opcode itself. In the future, this restriction may be relaxed to externally transfer value out of the <code>authorized</code> account.</li></ul> <p><code>AUTHCALL</code> must increase the call depth by one. <code>AUTHCALL</code> must not increase the call depth by two as it would if it first called into the authorized account and then into the target.</p> <p>The return data area accessed with <code>RETURNDATASIZE</code> (<code>0x3d</code>) and <code>RETURNDATACOPY</code> (<code>0x3e</code>) must be set in the same way as the <code>CALL</code> instruction.</p> <p>Importantly, <code>AUTHCALL</code> does not reset <code>authorized</code>, but leaves it unchanged.</p> <h4 id="gas-cost-2"><a href="#gas-cost-2" class="header-anchor">#</a> Gas Cost</h4> <p>The gas cost for <code>AUTHCALL</code> shall be the <strong>sum</strong> of:</p> <ul><li>static gas cost (<code>warm_storage_read</code>)</li> <li>memory expansion gas cost (<code>memory_expansion_fee</code>)</li> <li>dynamic gas cost (<code>dynamic_gas</code>)</li> <li>gas available for execution in the subcall (<code>subcall_gas</code>)</li></ul> <p>The memory expansion gas cost (<code>memory_expansion_fee</code>) shall be calculated in the same way as <code>CALL</code>.</p> <p>The dynamic gas portion (<code>dynamic_gas</code>), and the gas available for execution in the subcall (<code>subcall_gas</code>) shall be calculated as:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>dynamic_gas = 0

if addr not in accessed_addresses:
    dynamic_gas += 2500         # cold_account_access - warm_storage_read

if value &gt; 0:
    dynamic_gas += 6700         # NB: Not 9000, like in `CALL`
    if is_empty(addr):
        dynamic_gas += 25000

remaining_gas = available_gas - dynamic_gas
all_but_one_64th = remaining_gas - (remaining_gas // 64)

if gas == 0:
    subcall_gas = all_but_one_64th
elif all_but_one_64th &lt; gas:
    raise                       # Execution is invalid.
else:
    subcall_gas = gas
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>As with <code>CALL</code>, the full gas cost is charged immediately, independently of actually executing the call.</p> <h2 id="rationale"><a href="#rationale" class="header-anchor">#</a> Rationale</h2> <h3 id="reserving-one-sixty-fourth-of-available-gas"><a href="#reserving-one-sixty-fourth-of-available-gas" class="header-anchor">#</a> Reserving One Sixty-Fourth of Available Gas</h3> <p><code>AUTHCALL</code> will not pass more than 63/64th of the available gas for the reasons enumerated in <a href="/eip-150.html">EIP-150</a>.</p> <h3 id="throwing-for-unset-authorized-during-authcall"><a href="#throwing-for-unset-authorized-during-authcall" class="header-anchor">#</a> Throwing for Unset <code>authorized</code> During <code>AUTHCALL</code></h3> <p>A well-behaved contract should never reach an <code>AUTHCALL</code> without having successfully set <code>authorized</code> beforehand. The safest behavior, therefore, is to exit the current frame of execution immediately. This is especially important in the context of transaction sponsoring / relaying, which is expected to be one of the main use cases for this EIP. In a sponsored transaction, the inability to distinguish between a sponsee-attributable fault (like a failing sub-call) and a sponsor-attributable fault (like a failing <code>AUTH</code>) is especially dangerous and should be prevented because it charges unfair fees to the sponsee.</p> <h3 id="another-sponsored-transaction-eip"><a href="#another-sponsored-transaction-eip" class="header-anchor">#</a> Another Sponsored Transaction EIP</h3> <p>There are two general approaches to separating the &quot;fee payer&quot; from the &quot;action originator&quot;.</p> <p>The first is introducing a new transaction. This requires significant changes to clients to support and is generally less upgradeable than other solutions (e.g. this EIP). This approach is also not immediately compatible with account abstraction (AA). These proposals require a <em>signed</em> transaction from the sponsor's account, which is not possible from an AA contract, because it has no private key to sign with. The main advantage of new transaction types is that the validity requirements are enforced by the protocol, therefore invalid transactions do not pollute block space.</p> <p>The other main approach is to introduce a new mechanism in the EVM to masquerade as other accounts. This EIP introduces <code>AUTH</code> and <code>AUTHCALL</code> to make calls as EOAs. There are many different permutations of this mechanism. An alternative mechanism would be add an opcode that can make arbitrary calls based on a similar address creation scheme as <code>CREATE2</code>. Although this mechanism would not benefit users today, it would immediately allow for those accounts to send and receive ether -- making it feel like a more first-class primitive.</p> <p>Besides better compatibility with AA, introducing a new mechanism into the EVM is a much less intrusive change than a new transaction type. This approach requires no changes in existing wallets, and little change in other tooling.</p> <p><code>AUTHCALL</code>'s single deviation from <code>CALL</code> is to set <code>CALLER</code>. It implements the minimal functionality to enable sender abstraction for sponsored transactions. This single mindedness makes <code>AUTHCALL</code> significantly more composable with existing Ethereum features.</p> <p>More logic can be implemented around the <code>AUTHCALL</code> instruction, giving more control to invokers and sponsors without sacrificing security or user experience for sponsees.</p> <h3 id="what-to-sign"><a href="#what-to-sign" class="header-anchor">#</a> What to Sign?</h3> <p>As originally written, this proposal specified a precompile with storage to track nonces. Since a precompile with storage is unprecedented, a revision moved replay protection into the invoker contract, necessitating a certain level of user trust in the invoker. Expanding on this idea of trusted invokers, the other signed fields were eventually eliminated, one by one, until only <code>invoker</code> and <code>commit</code> remained.</p> <p>The <code>invoker</code> binds a particular signed message to a single invoker. If invoker was not part of the message, any invoker could reuse the signature to completely compromise the EOA. This allows users to trust that their message will be validated as they expect, particularly the values committed to in <code>commit</code>.</p> <h3 id="understanding-commit"><a href="#understanding-commit" class="header-anchor">#</a> Understanding <code>commit</code></h3> <p>Earlier iterations of this EIP included mechanisms for replay protection, and also signed over value, gas, and other arguments to <code>AUTHCALL</code>. After further investigation, we revised this EIP to its current state: explicitly delegate these responsibilities to the invoker contract.</p> <p>A user will specifically interact with an invoker they trust. Because they trust this contract to execute faithfully, they will &quot;commit&quot; to certain properties of a call they would like to make by computing a hash of the call values. They can be certain that the invoker will only allow they call to proceed if it is able to verify the values committed to (e.g. a nonce to protect against replay attacks). This certainty arises from the <code>commit</code> value that is signed over by the user. This is the hash of values which the invoker will validate. A safe invoker should accept the values from the user and compute the commit hash itself. This ensures that invoker operated on the same input that user authorized.</p> <p><img src="/assets/img/auth-msg.60b8c374.png" alt="auth message format"></p> <p>Using <code>commit</code> as a hash of values allows for invokers to implement arbitrary constraints. For example, they could allow accounts to have <code>N</code> parallel nonces. Or, they could allow a user to commit to multiple calls with a single signature. This would allow mult-tx flows, such as ERC-20 <code>approve</code>-<code>transfer</code> actions, to be condensed into a single transaction with a single signature verification. A commitment to multiple calls would look something like the diagram below.</p> <p><img src="/assets/img/auth-msg-multi-call.34cd4f5c.png" alt="multi-call auth message"></p> <h3 id="invoker-contracts"><a href="#invoker-contracts" class="header-anchor">#</a> Invoker Contracts</h3> <p>The invoker contract is a trustless intermediary between the sponsor and sponsee. A sponsee signs over <code>invoker</code> to require they transaction to be processed only by a contract they trust. This allows them to interact with sponsors without needing to trust them.</p> <p>Choosing an invoker is similar to choosing a smart contract wallet implementation. It's important to choose one that has been thoroughly reviewed, tested, and accepted by the community as secure. We expect a few invoker designs to be utilized by most major transaction relay providers, with a few outliers that offer more novel mechanisms.</p> <p>An important note is that invoker contracts <strong>MUST NOT</strong> be upgradeable. If an invoker can be redeployed to the same address with different code, it would be possible to redeploy the invoker with code that does not properly verify <code>commit</code> and any account that signed a message over that invoker would be compromised. Although this sounds scary, it is no different than using a smart contract wallet via <code>DELEGATECALL</code>. If the wallet is redeployed with different logic, all wallet using its code could be compromised.</p> <h3 id="on-call-depth"><a href="#on-call-depth" class="header-anchor">#</a> On Call Depth</h3> <p>The EVM limits the maximum number of nested calls, and naively allowing a sponsor to manipulate the call depth before reaching the invoker would introduce a griefing attack against the sponsee. That said, with the 63/64th gas rule, and the cost of <code>AUTHCALL</code>, the stack is effectively limited to a much smaller depth than the hard maximum by the <code>gas</code> parameter.</p> <p>It is, therefore, sufficient for the invoker to guarantee a minimum amount of gas, because there is no way to reach the hard maximum call depth with any reasonable (i.e. less than billions) amount of gas.</p> <h3 id="source-of-value"><a href="#source-of-value" class="header-anchor">#</a> Source of <code>value</code></h3> <p>Any non-zero <code>value</code> passed into an <code>AUTHCALL</code> is deducted from the invoker's balance. A natural alternative source for <code>value</code> would be the <code>authorized</code> account. However, deducting value from an EOA mid-execution is problematic, as it breaks important invariants for handling pending transactions. Specifically:</p> <ul><li>Transaction pools expect transactions for a given EOA to only turn invalid when other transactions from the same EOA are included into a block, increasing its nonce and (possibly) decreasing its balance. Deducting <code>value</code> from the <code>authorized</code> account would make transaction invalidation an unpredictable side effect of any smart contract execution.</li> <li>Similarly, miners rely on the ability to statically pick a set of valid transactions from their transaction pool to include into a new block. Deducting <code>value</code> from the <code>authorized</code> account would break this ability, increasing the overhead and thus the time for block creation.</li></ul> <p>At the same time, the ability to directly take ether out of the <code>authorized</code> account is an important piece of functionality and thus a desired future addition via an additional opcode similar to <code>AUTHCALL</code>. For this reason, it is included as <code>valueExt</code>, an operand of <code>AUTHCALL</code>, which may be activated in a future fork. The prerequisite for that would be to find satisfying mitigations to the transaction invalidation concerns outlined above. One potential avenue for that could be the addition of account access lists similar to EIP-2930, used to signal accounts whose balance can be reduced as a side effect of the transaction (without on their own constituting authorization to do so).</p> <h3 id="allowing-tx-origin-as-signer"><a href="#allowing-tx-origin-as-signer" class="header-anchor">#</a> Allowing <code>tx.origin</code> as Signer</h3> <p>Allowing <code>authorized</code> to equal <code>tx.origin</code> enables simple transaction batching, where the sender of the outer transaction would be the signing account. The ERC-20 approve-then-transfer pattern, which currently requires two separate transactions, could be completed in a single transaction with this proposal.</p> <p><code>AUTH</code> allows for signatures to be signed by <code>tx.origin</code>. For any such signatures, subsequent <code>AUTHCALL</code>s have <code>msg.sender == tx.origin</code> in their first layer of execution. Without EIP-3074, this situation can only ever arise in the topmost execution layer of a transaction. This EIP breaks that invariant and so affects smart contracts containing <code>require(msg.sender == tx.origin)</code> checks. This check can be used for at least three purposes:</p> <ol><li>Ensuring that <code>msg.sender</code> is an EOA (given that <code>tx.origin</code> always has to be an EOA). This invariant does not depend on the execution layer depth and, therefore, is not affected.</li> <li>Protecting against atomic sandwich attacks like flash loans, that rely on the ability to modify state before and after the execution of the target contract as part of the same atomic transaction. This protection would be broken by this EIP. However, relying on <code>tx.origin</code> in this way is considered bad practice, and can already be circumvented by miners conditionally including transactions in a block.</li> <li>Preventing re-entrancy.</li></ol> <p>Examples of (1) and (2) can be found in contracts deployed on Ethereum mainnet, with (1) being more common (and unaffected by this proposal.) On the other hand, use case (3) is more severely affected by this proposal, but the authors of this EIP did not find any examples of this form of re-entrancy protection, though the search was non-exhaustive.</p> <p>This distribution of occurrences—many (1), some (2), and no (3)—is exactly what the authors of this EIP expect, because:</p> <ul><li>Determining if <code>msg.sender</code> is an EOA without <code>tx.origin</code> is difficult (if not impossible.)</li> <li>The only execution context which is safe from atomic sandwich attacks is the topmost context, and <code>tx.origin == msg.sender</code> is the only way to detect that context.</li> <li>In contrast, there are many direct and flexible ways of preventing re-entrancy (ex. using a storage variable.) Since <code>msg.sender == tx.origin</code> is only true in the topmost context, it would make an obscure tool for preventing re-entrancy, rather than other more common approaches.</li></ul> <p>There are other approaches to mitigate this restriction which do not break the invariant:</p> <ul><li>Set <code>tx.origin</code> to a constant <code>ENTRY_POINT</code> address for <code>AUTHCALL</code>s.</li> <li>Set <code>tx.origin</code> to the invoker address for <code>AUTHCALL</code>s.</li> <li>Set <code>tx.origin</code> to a special address derived from any of the sender, invoker, and/or signer addresses.</li> <li>Disallow <code>authorized == tx.origin</code>. This would make the simple batching use cases impossible, but could be relaxed in the future.</li></ul> <h3 id="authcall-cheaper-than-call-when-sending-value"><a href="#authcall-cheaper-than-call-when-sending-value" class="header-anchor">#</a> <code>AUTHCALL</code> cheaper than <code>CALL</code> when sending value</h3> <p>Sending non-zero value with <code>CALL</code> increases its cost by 9,000. Of that, 6,700 covers the increased overhead of the balance transfer and 2,300 is used as a stipend into the subcall to seed its gas counter. <code>AUTHCALL</code> does not provide a stipend and thus only charges the base 6,700.</p> <h2 id="backwards-compatibility"><a href="#backwards-compatibility" class="header-anchor">#</a> Backwards Compatibility</h2> <p>No known issues.</p> <h2 id="security-considerations"><a href="#security-considerations" class="header-anchor">#</a> Security Considerations</h2> <h3 id="secure-invokers"><a href="#secure-invokers" class="header-anchor">#</a> Secure Invokers</h3> <p>The following is a non-exhaustive list of checks/pitfalls/conditions that invokers <em>should</em> be wary of:</p> <ul><li>Replay protection (ex. a nonce) should be implemented by the invoker, and included in <code>commit</code>. Without it, a malicious actor can reuse a signature, repeating its effects.</li> <li><code>value</code> should be included in <code>commit</code>. Without it, a malicious sponsor could cause unexpected effects in the callee.</li> <li><code>gas</code> should be included in <code>commit</code>. Without it, a malicious sponsor could cause the callee to run out of gas and fail, griefing the sponsee.</li> <li><code>addr</code> and <code>calldata</code> should be included in <code>commit</code>. Without them, a malicious actor may call arbitrary functions in arbitrary contracts.</li></ul> <p>A poorly implemented invoker can <em>allow a malicious actor to take near complete control over a signer's EOA</em>.</p> <h3 id="allowing-tx-origin-as-signer-2"><a href="#allowing-tx-origin-as-signer-2" class="header-anchor">#</a> Allowing <code>tx.origin</code> as Signer</h3> <p>Allowing <code>authorized</code> to equal <code>tx.origin</code> has the possibility to:</p> <ul><li>Break atomic sandwich protections which rely on <code>tx.origin</code>;</li> <li>Break re-entrancy guards of the style <code>require(tx.origin == msg.sender)</code>.</li></ul> <p>The authors of this EIP believe the risks of allowing <code>authorized</code> to equal <code>tx.origin</code> are acceptable for the reasons outlined in the Rationale section.</p> <h2 id="copyright"><a href="#copyright" class="header-anchor">#</a> Copyright</h2> <p>Copyright and related rights waived via <a href="https://creativecommons.org/publicdomain/zero/1.0/" target="_blank" rel="noopener noreferrer">CC0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ethlibrary/EIPs/edit/master/EIPS/eip-3074.md" target="_blank" rel="noopener noreferrer">帮助完善文档</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/26/2021, 5:29:34 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a13d8931.js" defer></script><script src="/assets/js/3.afc73834.js" defer></script><script src="/assets/js/15.9ca9208b.js" defer></script>
  </body>
</html>
