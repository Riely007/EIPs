<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Universal Upgradeable Proxy Standard (UUPS) | 以太坊改进提案 EIPs</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="以太坊改进提案（EIPs）描述了以太坊平台的标准，包括核心协议规范，客户端API和合约标准。">
    
    <link rel="preload" href="/assets/css/0.styles.5d34d66f.css" as="style"><link rel="preload" href="/assets/js/app.8bdc7c41.js" as="script"><link rel="preload" href="/assets/js/3.afc73834.js" as="script"><link rel="preload" href="/assets/js/22.2d627e68.js" as="script"><link rel="prefetch" href="/assets/js/10.1f5e4f3e.js"><link rel="prefetch" href="/assets/js/100.5e83168e.js"><link rel="prefetch" href="/assets/js/101.abc1c66c.js"><link rel="prefetch" href="/assets/js/102.f1608d9e.js"><link rel="prefetch" href="/assets/js/103.50677a84.js"><link rel="prefetch" href="/assets/js/104.5ef37394.js"><link rel="prefetch" href="/assets/js/105.8b115527.js"><link rel="prefetch" href="/assets/js/106.78821836.js"><link rel="prefetch" href="/assets/js/107.f2cad26b.js"><link rel="prefetch" href="/assets/js/108.806c491a.js"><link rel="prefetch" href="/assets/js/109.2536f3b5.js"><link rel="prefetch" href="/assets/js/11.19d07763.js"><link rel="prefetch" href="/assets/js/110.aa8e5dff.js"><link rel="prefetch" href="/assets/js/111.486fd49e.js"><link rel="prefetch" href="/assets/js/112.0e5dc443.js"><link rel="prefetch" href="/assets/js/113.14d95a60.js"><link rel="prefetch" href="/assets/js/114.1282f1e1.js"><link rel="prefetch" href="/assets/js/115.8f4357cd.js"><link rel="prefetch" href="/assets/js/116.faa46692.js"><link rel="prefetch" href="/assets/js/117.ce807443.js"><link rel="prefetch" href="/assets/js/118.c075df33.js"><link rel="prefetch" href="/assets/js/119.c8959574.js"><link rel="prefetch" href="/assets/js/12.cc14cc21.js"><link rel="prefetch" href="/assets/js/120.a997950d.js"><link rel="prefetch" href="/assets/js/121.d55fab26.js"><link rel="prefetch" href="/assets/js/122.0d55f0f1.js"><link rel="prefetch" href="/assets/js/123.f0ef1c2b.js"><link rel="prefetch" href="/assets/js/124.84d00fe3.js"><link rel="prefetch" href="/assets/js/125.64e003e7.js"><link rel="prefetch" href="/assets/js/126.a31044d7.js"><link rel="prefetch" href="/assets/js/127.1ff3a4af.js"><link rel="prefetch" href="/assets/js/128.38dfcf65.js"><link rel="prefetch" href="/assets/js/129.39594e41.js"><link rel="prefetch" href="/assets/js/13.79199e7b.js"><link rel="prefetch" href="/assets/js/130.e85ffe06.js"><link rel="prefetch" href="/assets/js/131.fd90a8ff.js"><link rel="prefetch" href="/assets/js/132.62043b85.js"><link rel="prefetch" href="/assets/js/133.292c85d5.js"><link rel="prefetch" href="/assets/js/134.720824f2.js"><link rel="prefetch" href="/assets/js/135.330b0de9.js"><link rel="prefetch" href="/assets/js/136.d5434ef4.js"><link rel="prefetch" href="/assets/js/137.aefa600d.js"><link rel="prefetch" href="/assets/js/138.00d829f8.js"><link rel="prefetch" href="/assets/js/139.9e674d6d.js"><link rel="prefetch" href="/assets/js/14.3ec7ba2c.js"><link rel="prefetch" href="/assets/js/140.f2975dcb.js"><link rel="prefetch" href="/assets/js/141.51c0ec0a.js"><link rel="prefetch" href="/assets/js/142.aa405a6d.js"><link rel="prefetch" href="/assets/js/143.bf538ce9.js"><link rel="prefetch" href="/assets/js/144.e245817f.js"><link rel="prefetch" href="/assets/js/145.ac7bbacf.js"><link rel="prefetch" href="/assets/js/146.f604aa88.js"><link rel="prefetch" href="/assets/js/147.c48e9871.js"><link rel="prefetch" href="/assets/js/148.cacec7d1.js"><link rel="prefetch" href="/assets/js/149.724bdead.js"><link rel="prefetch" href="/assets/js/15.b10ae651.js"><link rel="prefetch" href="/assets/js/150.79848276.js"><link rel="prefetch" href="/assets/js/151.e5ba8697.js"><link rel="prefetch" href="/assets/js/152.b6ca9176.js"><link rel="prefetch" href="/assets/js/153.6162383e.js"><link rel="prefetch" href="/assets/js/154.d80adb79.js"><link rel="prefetch" href="/assets/js/155.067c9183.js"><link rel="prefetch" href="/assets/js/156.564c5338.js"><link rel="prefetch" href="/assets/js/157.f6e4fb9f.js"><link rel="prefetch" href="/assets/js/158.2780e531.js"><link rel="prefetch" href="/assets/js/159.95a9bbc1.js"><link rel="prefetch" href="/assets/js/16.dbfba018.js"><link rel="prefetch" href="/assets/js/160.f4445c3b.js"><link rel="prefetch" href="/assets/js/161.7ec4dccc.js"><link rel="prefetch" href="/assets/js/162.7ba8ee46.js"><link rel="prefetch" href="/assets/js/163.f0aa8208.js"><link rel="prefetch" href="/assets/js/164.4fe8c403.js"><link rel="prefetch" href="/assets/js/165.2d8ce405.js"><link rel="prefetch" href="/assets/js/166.6aa05391.js"><link rel="prefetch" href="/assets/js/167.82768149.js"><link rel="prefetch" href="/assets/js/168.b81a0c2a.js"><link rel="prefetch" href="/assets/js/169.435758b2.js"><link rel="prefetch" href="/assets/js/17.06ca53ac.js"><link rel="prefetch" href="/assets/js/170.4cd67a85.js"><link rel="prefetch" href="/assets/js/171.40baf340.js"><link rel="prefetch" href="/assets/js/172.186bf1f2.js"><link rel="prefetch" href="/assets/js/173.8b09cfe7.js"><link rel="prefetch" href="/assets/js/174.cd6f6ae5.js"><link rel="prefetch" href="/assets/js/175.9021e040.js"><link rel="prefetch" href="/assets/js/176.41fc6fc9.js"><link rel="prefetch" href="/assets/js/177.d49686da.js"><link rel="prefetch" href="/assets/js/178.9fc70e1d.js"><link rel="prefetch" href="/assets/js/179.9773da56.js"><link rel="prefetch" href="/assets/js/18.4e631205.js"><link rel="prefetch" href="/assets/js/180.edebbc8c.js"><link rel="prefetch" href="/assets/js/181.9c7e1e79.js"><link rel="prefetch" href="/assets/js/182.34c52e30.js"><link rel="prefetch" href="/assets/js/183.9702d486.js"><link rel="prefetch" href="/assets/js/184.34ceb786.js"><link rel="prefetch" href="/assets/js/185.e536c5d5.js"><link rel="prefetch" href="/assets/js/186.4140ef7b.js"><link rel="prefetch" href="/assets/js/187.4b9a7a52.js"><link rel="prefetch" href="/assets/js/188.94d50a82.js"><link rel="prefetch" href="/assets/js/189.e94b7567.js"><link rel="prefetch" href="/assets/js/19.a7b0e44d.js"><link rel="prefetch" href="/assets/js/190.a44802e9.js"><link rel="prefetch" href="/assets/js/191.2710b7f4.js"><link rel="prefetch" href="/assets/js/192.8fa54ace.js"><link rel="prefetch" href="/assets/js/193.45b30c52.js"><link rel="prefetch" href="/assets/js/194.34eb3369.js"><link rel="prefetch" href="/assets/js/195.e800d01e.js"><link rel="prefetch" href="/assets/js/196.993e37d7.js"><link rel="prefetch" href="/assets/js/197.0766e81c.js"><link rel="prefetch" href="/assets/js/198.de30e1a5.js"><link rel="prefetch" href="/assets/js/199.98b8b4e2.js"><link rel="prefetch" href="/assets/js/20.a23c95ca.js"><link rel="prefetch" href="/assets/js/200.dd8af084.js"><link rel="prefetch" href="/assets/js/201.b0651559.js"><link rel="prefetch" href="/assets/js/202.9fda4a48.js"><link rel="prefetch" href="/assets/js/203.d6a30442.js"><link rel="prefetch" href="/assets/js/204.35587f6c.js"><link rel="prefetch" href="/assets/js/205.321dcf85.js"><link rel="prefetch" href="/assets/js/206.9b73d45c.js"><link rel="prefetch" href="/assets/js/207.1db9d0bc.js"><link rel="prefetch" href="/assets/js/208.2323fc5c.js"><link rel="prefetch" href="/assets/js/209.073cc71d.js"><link rel="prefetch" href="/assets/js/21.13433d52.js"><link rel="prefetch" href="/assets/js/210.72f984ce.js"><link rel="prefetch" href="/assets/js/211.d9917eee.js"><link rel="prefetch" href="/assets/js/212.9ea4d869.js"><link rel="prefetch" href="/assets/js/213.c02335e9.js"><link rel="prefetch" href="/assets/js/214.4dd46b88.js"><link rel="prefetch" href="/assets/js/215.8db9fba0.js"><link rel="prefetch" href="/assets/js/216.0a0fd08f.js"><link rel="prefetch" href="/assets/js/217.a33898a0.js"><link rel="prefetch" href="/assets/js/218.5957a55c.js"><link rel="prefetch" href="/assets/js/219.2dce84f7.js"><link rel="prefetch" href="/assets/js/220.447c1ff1.js"><link rel="prefetch" href="/assets/js/221.5afacb44.js"><link rel="prefetch" href="/assets/js/222.36ee8bea.js"><link rel="prefetch" href="/assets/js/223.e4ee05e9.js"><link rel="prefetch" href="/assets/js/224.3a64ea59.js"><link rel="prefetch" href="/assets/js/225.f6a3250c.js"><link rel="prefetch" href="/assets/js/226.71e9b973.js"><link rel="prefetch" href="/assets/js/227.8484d6cc.js"><link rel="prefetch" href="/assets/js/228.f6928d72.js"><link rel="prefetch" href="/assets/js/229.fea960db.js"><link rel="prefetch" href="/assets/js/23.781adadc.js"><link rel="prefetch" href="/assets/js/230.d86e0be9.js"><link rel="prefetch" href="/assets/js/231.3bbf02cc.js"><link rel="prefetch" href="/assets/js/232.79acd9d3.js"><link rel="prefetch" href="/assets/js/233.cb8d0b73.js"><link rel="prefetch" href="/assets/js/234.e46ce374.js"><link rel="prefetch" href="/assets/js/235.dbac9148.js"><link rel="prefetch" href="/assets/js/236.a24aa05a.js"><link rel="prefetch" href="/assets/js/237.9713dbec.js"><link rel="prefetch" href="/assets/js/238.ae583618.js"><link rel="prefetch" href="/assets/js/239.3ed46955.js"><link rel="prefetch" href="/assets/js/24.fb9b1130.js"><link rel="prefetch" href="/assets/js/240.865b07ed.js"><link rel="prefetch" href="/assets/js/241.774c50b3.js"><link rel="prefetch" href="/assets/js/242.3dea429a.js"><link rel="prefetch" href="/assets/js/243.d066ef46.js"><link rel="prefetch" href="/assets/js/244.4314f19c.js"><link rel="prefetch" href="/assets/js/245.7411c815.js"><link rel="prefetch" href="/assets/js/246.c38575d2.js"><link rel="prefetch" href="/assets/js/247.878247f5.js"><link rel="prefetch" href="/assets/js/248.f78693bb.js"><link rel="prefetch" href="/assets/js/249.17761090.js"><link rel="prefetch" href="/assets/js/25.ab8a1140.js"><link rel="prefetch" href="/assets/js/250.5d4f34ec.js"><link rel="prefetch" href="/assets/js/251.da3f7b60.js"><link rel="prefetch" href="/assets/js/252.6946d29c.js"><link rel="prefetch" href="/assets/js/253.b13399dd.js"><link rel="prefetch" href="/assets/js/254.f5a78fe5.js"><link rel="prefetch" href="/assets/js/255.67794845.js"><link rel="prefetch" href="/assets/js/256.34867632.js"><link rel="prefetch" href="/assets/js/257.58ef8ea4.js"><link rel="prefetch" href="/assets/js/258.04035098.js"><link rel="prefetch" href="/assets/js/259.b76fa21f.js"><link rel="prefetch" href="/assets/js/26.7edc5849.js"><link rel="prefetch" href="/assets/js/260.c31c293e.js"><link rel="prefetch" href="/assets/js/261.c450d645.js"><link rel="prefetch" href="/assets/js/262.5dfb132e.js"><link rel="prefetch" href="/assets/js/263.d105b504.js"><link rel="prefetch" href="/assets/js/264.9c51b91a.js"><link rel="prefetch" href="/assets/js/265.cd869d87.js"><link rel="prefetch" href="/assets/js/266.2c81f2aa.js"><link rel="prefetch" href="/assets/js/267.0eb433a5.js"><link rel="prefetch" href="/assets/js/268.61403538.js"><link rel="prefetch" href="/assets/js/269.d8a5aa4a.js"><link rel="prefetch" href="/assets/js/27.a2d7eacd.js"><link rel="prefetch" href="/assets/js/270.9aa28099.js"><link rel="prefetch" href="/assets/js/271.428c6c80.js"><link rel="prefetch" href="/assets/js/272.3de4f874.js"><link rel="prefetch" href="/assets/js/273.614942c0.js"><link rel="prefetch" href="/assets/js/274.afead1c8.js"><link rel="prefetch" href="/assets/js/275.82fc06e8.js"><link rel="prefetch" href="/assets/js/276.2ce1b15e.js"><link rel="prefetch" href="/assets/js/277.59413c64.js"><link rel="prefetch" href="/assets/js/278.40f50c75.js"><link rel="prefetch" href="/assets/js/279.29aa4ac8.js"><link rel="prefetch" href="/assets/js/28.6a081e3d.js"><link rel="prefetch" href="/assets/js/280.e787a519.js"><link rel="prefetch" href="/assets/js/281.15087a2b.js"><link rel="prefetch" href="/assets/js/282.2573cc17.js"><link rel="prefetch" href="/assets/js/283.054c9336.js"><link rel="prefetch" href="/assets/js/284.6a794878.js"><link rel="prefetch" href="/assets/js/285.12d934a1.js"><link rel="prefetch" href="/assets/js/286.29f567eb.js"><link rel="prefetch" href="/assets/js/287.d4f0bca8.js"><link rel="prefetch" href="/assets/js/288.7c1dd248.js"><link rel="prefetch" href="/assets/js/289.9f985dbb.js"><link rel="prefetch" href="/assets/js/29.e6c29d28.js"><link rel="prefetch" href="/assets/js/290.3e3e8928.js"><link rel="prefetch" href="/assets/js/291.24ed9d7f.js"><link rel="prefetch" href="/assets/js/292.94fd80de.js"><link rel="prefetch" href="/assets/js/293.255bc297.js"><link rel="prefetch" href="/assets/js/294.84135584.js"><link rel="prefetch" href="/assets/js/295.89da57bd.js"><link rel="prefetch" href="/assets/js/296.90becf38.js"><link rel="prefetch" href="/assets/js/297.b4b88dbf.js"><link rel="prefetch" href="/assets/js/298.793c0f1f.js"><link rel="prefetch" href="/assets/js/299.2d9f2244.js"><link rel="prefetch" href="/assets/js/30.34f55274.js"><link rel="prefetch" href="/assets/js/300.b538064a.js"><link rel="prefetch" href="/assets/js/301.32a4bff4.js"><link rel="prefetch" href="/assets/js/302.6bffdcbe.js"><link rel="prefetch" href="/assets/js/303.47e446cd.js"><link rel="prefetch" href="/assets/js/304.ca260199.js"><link rel="prefetch" href="/assets/js/305.fca57eb3.js"><link rel="prefetch" href="/assets/js/306.b4f65a5b.js"><link rel="prefetch" href="/assets/js/307.3187f964.js"><link rel="prefetch" href="/assets/js/308.575c687a.js"><link rel="prefetch" href="/assets/js/309.b7699154.js"><link rel="prefetch" href="/assets/js/31.89805053.js"><link rel="prefetch" href="/assets/js/310.517f90c0.js"><link rel="prefetch" href="/assets/js/311.4e566ffc.js"><link rel="prefetch" href="/assets/js/312.1a2d1d4f.js"><link rel="prefetch" href="/assets/js/313.8ad92b70.js"><link rel="prefetch" href="/assets/js/314.091fa0d3.js"><link rel="prefetch" href="/assets/js/315.29ba5d51.js"><link rel="prefetch" href="/assets/js/316.23d38c8d.js"><link rel="prefetch" href="/assets/js/317.7ddf9625.js"><link rel="prefetch" href="/assets/js/318.6cf8cf4b.js"><link rel="prefetch" href="/assets/js/319.5c13edd5.js"><link rel="prefetch" href="/assets/js/32.973eb733.js"><link rel="prefetch" href="/assets/js/320.87009c76.js"><link rel="prefetch" href="/assets/js/321.379d2948.js"><link rel="prefetch" href="/assets/js/322.73fdbdd3.js"><link rel="prefetch" href="/assets/js/323.6caa2080.js"><link rel="prefetch" href="/assets/js/324.ab4dfd33.js"><link rel="prefetch" href="/assets/js/325.278e25db.js"><link rel="prefetch" href="/assets/js/326.462cf2df.js"><link rel="prefetch" href="/assets/js/327.f28c1c8f.js"><link rel="prefetch" href="/assets/js/328.8f58d3e2.js"><link rel="prefetch" href="/assets/js/329.6aa6d948.js"><link rel="prefetch" href="/assets/js/33.e353d4a7.js"><link rel="prefetch" href="/assets/js/330.93eb9f9a.js"><link rel="prefetch" href="/assets/js/331.80b87cc1.js"><link rel="prefetch" href="/assets/js/332.68f247fb.js"><link rel="prefetch" href="/assets/js/333.dd69e3b6.js"><link rel="prefetch" href="/assets/js/334.59b3382a.js"><link rel="prefetch" href="/assets/js/335.039070e2.js"><link rel="prefetch" href="/assets/js/336.82ef12a1.js"><link rel="prefetch" href="/assets/js/337.833b036d.js"><link rel="prefetch" href="/assets/js/338.290ea1fd.js"><link rel="prefetch" href="/assets/js/339.cfbeb3b3.js"><link rel="prefetch" href="/assets/js/34.d4ac227e.js"><link rel="prefetch" href="/assets/js/340.b2ca3fd2.js"><link rel="prefetch" href="/assets/js/341.e661e4d8.js"><link rel="prefetch" href="/assets/js/342.d521d8cb.js"><link rel="prefetch" href="/assets/js/343.699c8cd9.js"><link rel="prefetch" href="/assets/js/344.4717994c.js"><link rel="prefetch" href="/assets/js/345.895e09ef.js"><link rel="prefetch" href="/assets/js/346.421e0004.js"><link rel="prefetch" href="/assets/js/347.067ddec2.js"><link rel="prefetch" href="/assets/js/348.8ff7500d.js"><link rel="prefetch" href="/assets/js/349.1cb157da.js"><link rel="prefetch" href="/assets/js/35.79be4c2d.js"><link rel="prefetch" href="/assets/js/350.f3122d6b.js"><link rel="prefetch" href="/assets/js/351.73ab553d.js"><link rel="prefetch" href="/assets/js/352.c1d9b8a9.js"><link rel="prefetch" href="/assets/js/353.b835a1ed.js"><link rel="prefetch" href="/assets/js/354.2c63e1e0.js"><link rel="prefetch" href="/assets/js/355.77e39d15.js"><link rel="prefetch" href="/assets/js/356.b3b11ec8.js"><link rel="prefetch" href="/assets/js/357.d951bf49.js"><link rel="prefetch" href="/assets/js/358.03512851.js"><link rel="prefetch" href="/assets/js/359.8eaa97e8.js"><link rel="prefetch" href="/assets/js/36.7a071608.js"><link rel="prefetch" href="/assets/js/360.ff38e37d.js"><link rel="prefetch" href="/assets/js/361.2666265d.js"><link rel="prefetch" href="/assets/js/362.07e86e74.js"><link rel="prefetch" href="/assets/js/363.34e27b0e.js"><link rel="prefetch" href="/assets/js/364.a04debf3.js"><link rel="prefetch" href="/assets/js/365.f3ec12a0.js"><link rel="prefetch" href="/assets/js/366.5795988a.js"><link rel="prefetch" href="/assets/js/367.c7a03b31.js"><link rel="prefetch" href="/assets/js/368.fa987e7a.js"><link rel="prefetch" href="/assets/js/369.3d7d842e.js"><link rel="prefetch" href="/assets/js/37.d6151b8b.js"><link rel="prefetch" href="/assets/js/370.70957e5d.js"><link rel="prefetch" href="/assets/js/371.16dc2e81.js"><link rel="prefetch" href="/assets/js/372.82bef7ee.js"><link rel="prefetch" href="/assets/js/373.24a33d42.js"><link rel="prefetch" href="/assets/js/374.71360427.js"><link rel="prefetch" href="/assets/js/375.7d66db26.js"><link rel="prefetch" href="/assets/js/376.ca08b015.js"><link rel="prefetch" href="/assets/js/377.9aae8605.js"><link rel="prefetch" href="/assets/js/378.82b57f2e.js"><link rel="prefetch" href="/assets/js/379.95b9e308.js"><link rel="prefetch" href="/assets/js/38.02d1febb.js"><link rel="prefetch" href="/assets/js/380.6ccc50ac.js"><link rel="prefetch" href="/assets/js/381.7ab91f90.js"><link rel="prefetch" href="/assets/js/382.4633f2ba.js"><link rel="prefetch" href="/assets/js/383.621c20db.js"><link rel="prefetch" href="/assets/js/384.d9ed68d0.js"><link rel="prefetch" href="/assets/js/385.552a868c.js"><link rel="prefetch" href="/assets/js/386.48562ecd.js"><link rel="prefetch" href="/assets/js/387.25d5c791.js"><link rel="prefetch" href="/assets/js/388.8dd5308f.js"><link rel="prefetch" href="/assets/js/389.b793f086.js"><link rel="prefetch" href="/assets/js/39.52b78afa.js"><link rel="prefetch" href="/assets/js/390.c1b37ee1.js"><link rel="prefetch" href="/assets/js/391.cc6f6f1b.js"><link rel="prefetch" href="/assets/js/392.415a5066.js"><link rel="prefetch" href="/assets/js/393.a50a7825.js"><link rel="prefetch" href="/assets/js/394.397244ff.js"><link rel="prefetch" href="/assets/js/395.18236afd.js"><link rel="prefetch" href="/assets/js/396.33051f11.js"><link rel="prefetch" href="/assets/js/397.6829ff8e.js"><link rel="prefetch" href="/assets/js/398.3f6541b5.js"><link rel="prefetch" href="/assets/js/399.3a6bb206.js"><link rel="prefetch" href="/assets/js/4.3bb46a9f.js"><link rel="prefetch" href="/assets/js/40.c160b9fd.js"><link rel="prefetch" href="/assets/js/400.926d58c3.js"><link rel="prefetch" href="/assets/js/401.fa3a64c7.js"><link rel="prefetch" href="/assets/js/402.586739cf.js"><link rel="prefetch" href="/assets/js/403.e8bea648.js"><link rel="prefetch" href="/assets/js/404.8d4cb751.js"><link rel="prefetch" href="/assets/js/405.8b6daef4.js"><link rel="prefetch" href="/assets/js/406.35af9289.js"><link rel="prefetch" href="/assets/js/407.b265c7b5.js"><link rel="prefetch" href="/assets/js/408.839daefc.js"><link rel="prefetch" href="/assets/js/409.eb2ab1ca.js"><link rel="prefetch" href="/assets/js/41.0aba3e27.js"><link rel="prefetch" href="/assets/js/410.7914c481.js"><link rel="prefetch" href="/assets/js/411.80e7a82f.js"><link rel="prefetch" href="/assets/js/412.ec4398a7.js"><link rel="prefetch" href="/assets/js/413.e53397d8.js"><link rel="prefetch" href="/assets/js/414.1c3e959c.js"><link rel="prefetch" href="/assets/js/415.a18709ff.js"><link rel="prefetch" href="/assets/js/416.83310c95.js"><link rel="prefetch" href="/assets/js/417.4b19e45b.js"><link rel="prefetch" href="/assets/js/42.c79987f1.js"><link rel="prefetch" href="/assets/js/43.b0c90923.js"><link rel="prefetch" href="/assets/js/44.d1bd963b.js"><link rel="prefetch" href="/assets/js/45.a2d474d6.js"><link rel="prefetch" href="/assets/js/46.eac472d0.js"><link rel="prefetch" href="/assets/js/47.542459f0.js"><link rel="prefetch" href="/assets/js/48.341b8db8.js"><link rel="prefetch" href="/assets/js/49.a786e041.js"><link rel="prefetch" href="/assets/js/5.9dcd01fb.js"><link rel="prefetch" href="/assets/js/50.3e9d91ce.js"><link rel="prefetch" href="/assets/js/51.0729208c.js"><link rel="prefetch" href="/assets/js/52.76bd2586.js"><link rel="prefetch" href="/assets/js/53.5ff982be.js"><link rel="prefetch" href="/assets/js/54.23f15748.js"><link rel="prefetch" href="/assets/js/55.3bf2a5c1.js"><link rel="prefetch" href="/assets/js/56.1744142f.js"><link rel="prefetch" href="/assets/js/57.90d019e1.js"><link rel="prefetch" href="/assets/js/58.7b6dc848.js"><link rel="prefetch" href="/assets/js/59.bcd80f71.js"><link rel="prefetch" href="/assets/js/6.499be6d9.js"><link rel="prefetch" href="/assets/js/60.64e983eb.js"><link rel="prefetch" href="/assets/js/61.d22192ff.js"><link rel="prefetch" href="/assets/js/62.c84c7aaa.js"><link rel="prefetch" href="/assets/js/63.dd026eb1.js"><link rel="prefetch" href="/assets/js/64.2f75d60b.js"><link rel="prefetch" href="/assets/js/65.dc493049.js"><link rel="prefetch" href="/assets/js/66.edd545c7.js"><link rel="prefetch" href="/assets/js/67.798cfbfc.js"><link rel="prefetch" href="/assets/js/68.b0ebc9d8.js"><link rel="prefetch" href="/assets/js/69.c929ddc2.js"><link rel="prefetch" href="/assets/js/7.6447749c.js"><link rel="prefetch" href="/assets/js/70.3c2e3a65.js"><link rel="prefetch" href="/assets/js/71.db3a0474.js"><link rel="prefetch" href="/assets/js/72.410f23fa.js"><link rel="prefetch" href="/assets/js/73.cd7f0a9d.js"><link rel="prefetch" href="/assets/js/74.78655130.js"><link rel="prefetch" href="/assets/js/75.ee32be45.js"><link rel="prefetch" href="/assets/js/76.72062db1.js"><link rel="prefetch" href="/assets/js/77.3bcb196b.js"><link rel="prefetch" href="/assets/js/78.d022a438.js"><link rel="prefetch" href="/assets/js/79.c8bc3e01.js"><link rel="prefetch" href="/assets/js/8.71ec8233.js"><link rel="prefetch" href="/assets/js/80.7eb160e3.js"><link rel="prefetch" href="/assets/js/81.d83716f9.js"><link rel="prefetch" href="/assets/js/82.a16620eb.js"><link rel="prefetch" href="/assets/js/83.109e69d7.js"><link rel="prefetch" href="/assets/js/84.5d0e8d72.js"><link rel="prefetch" href="/assets/js/85.7ad0606e.js"><link rel="prefetch" href="/assets/js/86.f8bed698.js"><link rel="prefetch" href="/assets/js/87.00204387.js"><link rel="prefetch" href="/assets/js/88.23ecf470.js"><link rel="prefetch" href="/assets/js/89.dbe77c40.js"><link rel="prefetch" href="/assets/js/9.9c4893b5.js"><link rel="prefetch" href="/assets/js/90.a106e2e7.js"><link rel="prefetch" href="/assets/js/91.dcded4ed.js"><link rel="prefetch" href="/assets/js/92.484f8b1f.js"><link rel="prefetch" href="/assets/js/93.e3dd85b5.js"><link rel="prefetch" href="/assets/js/94.cd337446.js"><link rel="prefetch" href="/assets/js/95.12425d97.js"><link rel="prefetch" href="/assets/js/96.8f74c17c.js"><link rel="prefetch" href="/assets/js/97.77e41f84.js"><link rel="prefetch" href="/assets/js/98.bf44b86d.js"><link rel="prefetch" href="/assets/js/99.f75896be.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.029a7c95.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5d34d66f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">以太坊改进提案 EIPs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://ethlibrary.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  About us
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/ethlibrary/EIPs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://ethlibrary.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  About us
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/ethlibrary/EIPs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/summary/all.html" class="sidebar-link">All EIPs List</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>EIPs by Status</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/living.html" class="sidebar-link">Living (1)</a></li><li><a href="/summary/final.html" class="sidebar-link">Final (88)</a></li><li><a href="/summary/draft.html" class="sidebar-link">Draft (157)</a></li><li><a href="/summary/stagnant.html" class="sidebar-link">Stagnant (101)</a></li><li><a href="/summary/withdrawn.html" class="sidebar-link">Withdrawn (22)</a></li><li><a href="/summary/last-call.html" class="sidebar-link">Last Call (8)</a></li><li><a href="/summary/review.html" class="sidebar-link">Review (14)</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>EIPs by Types</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/meta.html" class="sidebar-link">Meta (18)</a></li><li><a href="/summary/standards-track.html" class="sidebar-link">Standards Track (367)</a></li><li><a href="/summary/informational.html" class="sidebar-link">Informational (6)</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>EIPs by Category</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/core.html" class="sidebar-link">Core (165)</a></li><li><a href="/summary/erc.html" class="sidebar-link">ERC (153)</a></li><li><a href="/summary/interface.html" class="sidebar-link">Interface (38)</a></li><li><a href="/summary/networking.html" class="sidebar-link">Networking (11)</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="table-of-contents"><a href="#table-of-contents" class="header-anchor">#</a> Table of contents</h2> <ul><li><a href="#table-of-contents">Table of contents</a></li> <li><a href="#simple-summary">Simple Summary</a></li> <li><a href="#abstract">Abstract</a></li> <li><a href="#motivation">Motivation</a></li> <li><a href="#terminology">Terminology</a></li> <li><a href="#specification">Specification</a> <ul><li><a href="#proxy-contract">Proxy Contract</a> <ul><li><a href="#functions">Functions</a> <ul><li><a href="#fallback"><code>fallback</code></a></li></ul></li> <li><a href="#constructor"><code>constructor</code></a></li></ul></li> <li><a href="#proxiable-contract">Proxiable Contract</a> <ul><li><a href="#functions-1">Functions</a> <ul><li><a href="#proxiable"><code>proxiable</code></a></li> <li><a href="#updatecodeaddress"><code>updateCodeAddress</code></a></li></ul></li></ul></li></ul></li> <li><a href="#pitfalls-when-using-a-proxy">Pitfalls when using a proxy</a> <ul><li><a href="#separating-variables-from-logic">Separating Variables from Logic</a></li> <li><a href="#restricting-dangerous-functions">Restricting dangerous functions</a></li></ul></li> <li><a href="#examples">Examples</a> <ul><li><a href="#owned">Owned</a></li> <li><a href="#erc-20-token">ERC-20 Token</a> <ul><li><a href="#proxy-contract-1">Proxy Contract</a></li> <li><a href="#token-logic-contract">Token Logic Contract</a></li></ul></li></ul></li> <li><a href="#references">References</a></li> <li><a href="#copyright">Copyright</a></li></ul> <h2 id="simple-summary"><a href="#simple-summary" class="header-anchor">#</a> Simple Summary</h2> <p>Standard upgradeable proxy contract.</p> <h2 id="abstract"><a href="#abstract" class="header-anchor">#</a> Abstract</h2> <p>The following describes a standard for proxy contracts which is universally compatible with all contracts, and does not create incompatibility between the proxy and business-logic contracts. This is achieved by utilizing a unique storage position in the proxy contract to store the Logic Contract's address. A compatibility check ensures successful upgrades. Upgrading can be performed unlimited times, or as determined by custom logic. In addition, a method for selecting from multiple constructors is provided, which does not inhibit the ability to verify bytecode.</p> <h2 id="motivation"><a href="#motivation" class="header-anchor">#</a> Motivation</h2> <ul><li><p>Improve upon existing proxy implementations to improve developer experience for deploying and maintaining Proxy and Logic Contracts.</p></li> <li><p>Standardize and improve the methods for verifying the bytecode used by the Proxy Contract.</p></li></ul> <h2 id="terminology"><a href="#terminology" class="header-anchor">#</a> Terminology</h2> <ul><li><code>delegatecall()</code> - Function in contract <strong>A</strong> which allows an external contract <strong>B</strong> (delegating) to modify <strong>A</strong>'s storage (see diagram below, <a href="https://solidity.readthedocs.io/en/v0.5.3/introduction-to-smart-contracts.html#delegatecall-callcode-and-libraries" target="_blank" rel="noopener noreferrer">Solidity docs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</li> <li><strong>Proxy Contract</strong> - The contract <strong>A</strong> which stores data, but uses the logic of external contract <strong>B</strong> by way of <code>delegatecall()</code>.</li> <li><strong>Logic Contract</strong> - The contract <strong>B</strong> which contains the logic used by Proxy Contract <strong>A</strong></li> <li><strong>Proxiable Contract</strong> - Inherited in Logic Contract <strong>B</strong> to provide the upgrade functionality</li></ul> <p align="center"><img src="/assets/img/proxy-diagram.ff5fbd9a.png" alt="diagram" width="600"></p> <h2 id="specification"><a href="#specification" class="header-anchor">#</a> Specification</h2> <p>The Proxy Contract proposed here should be deployed <em>as is</em>, and used as a drop-in replacement for any existing methods of lifecycle management of contracts. In addition to the Proxy Contract, we propose the Proxiable Contract interface/base which establishes a pattern for the upgrade which does not interfere with existing business rules. The logic for allowing upgrades can be implemented as needed.</p> <h3 id="proxy-contract"><a href="#proxy-contract" class="header-anchor">#</a> Proxy Contract</h3> <h4 id="functions"><a href="#functions" class="header-anchor">#</a> Functions</h4> <h5 id="fallback"><a href="#fallback" class="header-anchor">#</a> <code>fallback</code></h5> <p>The proposed fallback function follows the common pattern seen in other Proxy Contract implementations such as <a href="https://github.com/maraoz/solidity-proxy/blob/master/contracts/Dispatcher.sol" target="_blank" rel="noopener noreferrer">Zeppelin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or <a href="https://blog.gnosis.pm/solidity-delegateproxy-contracts-e09957d0f201" target="_blank" rel="noopener noreferrer">Gnosis<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>However, rather than forcing use of a variable, the address of the Logic Contract is stored at the defined storage position <code>keccak256(&quot;PROXIABLE&quot;)</code>. This eliminates the possibility of collision between variables in the Proxy and Logic Contracts, thus providing &quot;universal&quot; compatibility with any Logic Contract.</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> external payable <span class="token punctuation">{</span>
    assembly <span class="token punctuation">{</span> <span class="token comment">// solium-disable-line</span>
        <span class="token keyword">let</span> contractLogic <span class="token operator">:</span><span class="token operator">=</span> <span class="token function">sload</span><span class="token punctuation">(</span><span class="token number">0xc5f16f0fcc639fa48a6947836d9850f504798523bf8c9a3a87d5876cf622bcf7</span><span class="token punctuation">)</span>
        <span class="token function">calldatacopy</span><span class="token punctuation">(</span><span class="token number">0x0</span><span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">,</span> calldatasize<span class="token punctuation">)</span>
        <span class="token keyword">let</span> success <span class="token operator">:</span><span class="token operator">=</span> <span class="token function">delegatecall</span><span class="token punctuation">(</span><span class="token function">sub</span><span class="token punctuation">(</span>gas<span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> contractLogic<span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">,</span> calldatasize<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> retSz <span class="token operator">:</span><span class="token operator">=</span> returndatasize
        <span class="token function">returndatacopy</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> retSz<span class="token punctuation">)</span>
        <span class="token keyword">switch</span> success
        <span class="token keyword">case</span> <span class="token number">0</span> <span class="token punctuation">{</span>
            <span class="token function">revert</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> retSz<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">default</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> retSz<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="constructor"><a href="#constructor" class="header-anchor">#</a> <code>constructor</code></h4> <p>The proposed constructor accepts any number of arguments of any type, and thus is compatible with any Logic Contract constructor function.</p> <p>In addition, the arbitrary nature of the Proxy Contract's constructor provides the ability to select from one or more constructor functions available in the Logic Contract source code (e.g., <code>constructor1</code>, <code>constructor2</code>, ... etc. ). Note that if multiple constructors are included in the Logic Contract, a check should be included to prohibit calling a constructor again post-initialization.</p> <p>It's worth noting that the added functionality of supporting multiple constructors does not inhibit verification of the Proxy Contract's bytecode, since the initialization tx call data (input) can be decoded by first using the Proxy Contract ABI, and then using the Logic Contract ABI.</p> <p>The contract below shows the proposed implementation of the Proxy Contract.</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>contract Proxy <span class="token punctuation">{</span>
    <span class="token comment">// Code position in storage is keccak256(&quot;PROXIABLE&quot;) = &quot;0xc5f16f0fcc639fa48a6947836d9850f504798523bf8c9a3a87d5876cf622bcf7&quot;</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>bytes memory constructData<span class="token punctuation">,</span> address contractLogic<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
        <span class="token comment">// save the code address</span>
        assembly <span class="token punctuation">{</span> <span class="token comment">// solium-disable-line</span>
            <span class="token function">sstore</span><span class="token punctuation">(</span><span class="token number">0xc5f16f0fcc639fa48a6947836d9850f504798523bf8c9a3a87d5876cf622bcf7</span><span class="token punctuation">,</span> contractLogic<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">(</span>bool success<span class="token punctuation">,</span> bytes memory _ <span class="token punctuation">)</span> <span class="token operator">=</span> contractLogic<span class="token punctuation">.</span><span class="token function">delegatecall</span><span class="token punctuation">(</span>constructData<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// solium-disable-line</span>
        <span class="token function">require</span><span class="token punctuation">(</span>success<span class="token punctuation">,</span> <span class="token string">&quot;Construction failed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> external payable <span class="token punctuation">{</span>
        assembly <span class="token punctuation">{</span> <span class="token comment">// solium-disable-line</span>
            <span class="token keyword">let</span> contractLogic <span class="token operator">:</span><span class="token operator">=</span> <span class="token function">sload</span><span class="token punctuation">(</span><span class="token number">0xc5f16f0fcc639fa48a6947836d9850f504798523bf8c9a3a87d5876cf622bcf7</span><span class="token punctuation">)</span>
            <span class="token function">calldatacopy</span><span class="token punctuation">(</span><span class="token number">0x0</span><span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">,</span> calldatasize<span class="token punctuation">)</span>
            <span class="token keyword">let</span> success <span class="token operator">:</span><span class="token operator">=</span> <span class="token function">delegatecall</span><span class="token punctuation">(</span><span class="token function">sub</span><span class="token punctuation">(</span>gas<span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> contractLogic<span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">,</span> calldatasize<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">let</span> retSz <span class="token operator">:</span><span class="token operator">=</span> returndatasize
            <span class="token function">returndatacopy</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> retSz<span class="token punctuation">)</span>
            <span class="token keyword">switch</span> success
            <span class="token keyword">case</span> <span class="token number">0</span> <span class="token punctuation">{</span>
                <span class="token function">revert</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> retSz<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">default</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> retSz<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="proxiable-contract"><a href="#proxiable-contract" class="header-anchor">#</a> Proxiable Contract</h3> <p>The Proxiable Contract is included in the Logic Contract, and provides the functions needed to perform an upgrade. The compatibility check <code>proxiable</code> prevents irreparable updates during an upgrade.</p> <blockquote><p>⚠️ Warning: <code>updateCodeAddress</code> and <code>proxiable</code> must be present in the Logic Contract. Failure to include these may prevent upgrades, and could allow the Proxy Contract to become entirely unusable. See below <a href="#restricting-dangerous-functions">Restricting dangerous functions</a></p></blockquote> <h4 id="functions-2"><a href="#functions-2" class="header-anchor">#</a> Functions</h4> <h5 id="proxiable"><a href="#proxiable" class="header-anchor">#</a> <code>proxiable</code></h5> <p>Compatibility check to ensure the new Logic Contract implements the Universal Upgradeable Proxy Standard. Note that in order to support future implementations, the <code>bytes32</code> comparison could be changed e.g., <code>keccak256(&quot;PROXIABLE-ERC1822-v1&quot;)</code>.</p> <h5 id="updatecodeaddress"><a href="#updatecodeaddress" class="header-anchor">#</a> <code>updateCodeAddress</code></h5> <p>Stores the Logic Contract's address at storage <code>keccak256(&quot;PROXIABLE&quot;)</code> in the Proxy Contract.</p> <p>The contract below shows the proposed implementation of the Proxiable Contract.</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>contract Proxiable <span class="token punctuation">{</span>
    <span class="token comment">// Code position in storage is keccak256(&quot;PROXIABLE&quot;) = &quot;0xc5f16f0fcc639fa48a6947836d9850f504798523bf8c9a3a87d5876cf622bcf7&quot;</span>

    <span class="token keyword">function</span> <span class="token function">updateCodeAddress</span><span class="token punctuation">(</span><span class="token parameter">address newAddress</span><span class="token punctuation">)</span> internal <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>
            <span class="token function">bytes32</span><span class="token punctuation">(</span><span class="token number">0xc5f16f0fcc639fa48a6947836d9850f504798523bf8c9a3a87d5876cf622bcf7</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">Proxiable</span><span class="token punctuation">(</span>newAddress<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">proxiableUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">&quot;Not compatible&quot;</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        assembly <span class="token punctuation">{</span> <span class="token comment">// solium-disable-line</span>
            <span class="token function">sstore</span><span class="token punctuation">(</span><span class="token number">0xc5f16f0fcc639fa48a6947836d9850f504798523bf8c9a3a87d5876cf622bcf7</span><span class="token punctuation">,</span> newAddress<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">proxiableUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> pure <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bytes32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0xc5f16f0fcc639fa48a6947836d9850f504798523bf8c9a3a87d5876cf622bcf7</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="pitfalls-when-using-a-proxy"><a href="#pitfalls-when-using-a-proxy" class="header-anchor">#</a> Pitfalls when using a proxy</h2> <p>The following common best practices should be employed for all Logic Contracts when using a proxy contract.</p> <h3 id="separating-variables-from-logic"><a href="#separating-variables-from-logic" class="header-anchor">#</a> Separating Variables from Logic</h3> <p>Careful consideration should be made when designing a new Logic Contract to prevent incompatibility with the existing storage of the Proxy Contract after an upgrade. Specifically, the order in which variables are instantiated in the new contract should not be modified, and any new variables should be added after all existing variables from the previous Logic Contract</p> <p>To facilitate this practice, we recommend utilizing a single &quot;base&quot; contract which holds all variables, and which is inherited in subsequent logic contract(s). This practice greatly reduces the chances of accidentally reordering variables or overwriting them in storage.</p> <h3 id="restricting-dangerous-functions"><a href="#restricting-dangerous-functions" class="header-anchor">#</a> Restricting dangerous functions</h3> <p>The compatibility check in the Proxiable Contract is a safety mechanism to prevent upgrading to a Logic Contract which does not implement the Universal Upgradeable Proxy Standard. However, as occurred in the parity wallet hack, it is still possible to perform irreparable damage to the Logic Contract itself.</p> <p>In order to prevent damage to the Logic Contract, we recommend restricting permissions for any potentially damaging functions to <code>onlyOwner</code>, and giving away ownership of the Logic Contract immediately upon deployment to a null address (e.g., address(1)). Potentially damaging functions include native functions such as <code>SELFDESTRUCT</code>, as well functions whose code may originate externally such as <code>CALLCODE</code>, and <code>delegatecall()</code>. In the <a href="#erc-20-token">ERC-20 Token</a> example below, a <code>LibraryLock</code> contract is used to prevent destruction of the logic contract.</p> <h2 id="examples"><a href="#examples" class="header-anchor">#</a> Examples</h2> <h3 id="owned"><a href="#owned" class="header-anchor">#</a> Owned</h3> <p>In this example, we show the standard ownership example, and restrict the <code>updateCodeAddress</code> to only the owner.</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>contract Owned is Proxiable <span class="token punctuation">{</span>
    <span class="token comment">// ensures no one can manipulate this contract once it is deployed</span>
    address <span class="token keyword">public</span> owner <span class="token operator">=</span> <span class="token function">address</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">constructor1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span><span class="token punctuation">{</span>
        <span class="token comment">// ensures this can be called only once per *proxy* contract deployed</span>
        <span class="token function">require</span><span class="token punctuation">(</span>owner <span class="token operator">==</span> <span class="token function">address</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        owner <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">updateCode</span><span class="token punctuation">(</span><span class="token parameter">address newCode</span><span class="token punctuation">)</span> onlyOwner <span class="token keyword">public</span> <span class="token punctuation">{</span>
        <span class="token function">updateCodeAddress</span><span class="token punctuation">(</span>newCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    modifier <span class="token function">onlyOwner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender <span class="token operator">==</span> owner<span class="token punctuation">,</span> <span class="token string">&quot;Only owner is allowed to perform this action&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        _<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="erc-20-token"><a href="#erc-20-token" class="header-anchor">#</a> ERC-20 Token</h3> <h4 id="proxy-contract-2"><a href="#proxy-contract-2" class="header-anchor">#</a> Proxy Contract</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>pragma solidity <span class="token operator">^</span><span class="token number">0.5</span><span class="token number">.1</span><span class="token punctuation">;</span>

contract Proxy <span class="token punctuation">{</span>
    <span class="token comment">// Code position in storage is keccak256(&quot;PROXIABLE&quot;) = &quot;0xc5f16f0fcc639fa48a6947836d9850f504798523bf8c9a3a87d5876cf622bcf7&quot;</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>bytes memory constructData<span class="token punctuation">,</span> address contractLogic<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
        <span class="token comment">// save the code address</span>
        assembly <span class="token punctuation">{</span> <span class="token comment">// solium-disable-line</span>
            <span class="token function">sstore</span><span class="token punctuation">(</span><span class="token number">0xc5f16f0fcc639fa48a6947836d9850f504798523bf8c9a3a87d5876cf622bcf7</span><span class="token punctuation">,</span> contractLogic<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">(</span>bool success<span class="token punctuation">,</span> bytes memory _ <span class="token punctuation">)</span> <span class="token operator">=</span> contractLogic<span class="token punctuation">.</span><span class="token function">delegatecall</span><span class="token punctuation">(</span>constructData<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// solium-disable-line</span>
        <span class="token function">require</span><span class="token punctuation">(</span>success<span class="token punctuation">,</span> <span class="token string">&quot;Construction failed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> external payable <span class="token punctuation">{</span>
        assembly <span class="token punctuation">{</span> <span class="token comment">// solium-disable-line</span>
            <span class="token keyword">let</span> contractLogic <span class="token operator">:</span><span class="token operator">=</span> <span class="token function">sload</span><span class="token punctuation">(</span><span class="token number">0xc5f16f0fcc639fa48a6947836d9850f504798523bf8c9a3a87d5876cf622bcf7</span><span class="token punctuation">)</span>
            <span class="token function">calldatacopy</span><span class="token punctuation">(</span><span class="token number">0x0</span><span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">,</span> calldatasize<span class="token punctuation">)</span>
            <span class="token keyword">let</span> success <span class="token operator">:</span><span class="token operator">=</span> <span class="token function">delegatecall</span><span class="token punctuation">(</span><span class="token function">sub</span><span class="token punctuation">(</span>gas<span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> contractLogic<span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">,</span> calldatasize<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">let</span> retSz <span class="token operator">:</span><span class="token operator">=</span> returndatasize
            <span class="token function">returndatacopy</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> retSz<span class="token punctuation">)</span>
            <span class="token keyword">switch</span> success
            <span class="token keyword">case</span> <span class="token number">0</span> <span class="token punctuation">{</span>
                <span class="token function">revert</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> retSz<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">default</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> retSz<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h4 id="token-logic-contract"><a href="#token-logic-contract" class="header-anchor">#</a> Token Logic Contract</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>
contract Proxiable <span class="token punctuation">{</span>
    <span class="token comment">// Code position in storage is keccak256(&quot;PROXIABLE&quot;) = &quot;0xc5f16f0fcc639fa48a6947836d9850f504798523bf8c9a3a87d5876cf622bcf7&quot;</span>

    <span class="token keyword">function</span> <span class="token function">updateCodeAddress</span><span class="token punctuation">(</span><span class="token parameter">address newAddress</span><span class="token punctuation">)</span> internal <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>
            <span class="token function">bytes32</span><span class="token punctuation">(</span><span class="token number">0xc5f16f0fcc639fa48a6947836d9850f504798523bf8c9a3a87d5876cf622bcf7</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">Proxiable</span><span class="token punctuation">(</span>newAddress<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">proxiableUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">&quot;Not compatible&quot;</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        assembly <span class="token punctuation">{</span> <span class="token comment">// solium-disable-line</span>
            <span class="token function">sstore</span><span class="token punctuation">(</span><span class="token number">0xc5f16f0fcc639fa48a6947836d9850f504798523bf8c9a3a87d5876cf622bcf7</span><span class="token punctuation">,</span> newAddress<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">proxiableUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> pure <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bytes32</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0xc5f16f0fcc639fa48a6947836d9850f504798523bf8c9a3a87d5876cf622bcf7</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


contract Owned <span class="token punctuation">{</span>

    address owner<span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">setOwner</span><span class="token punctuation">(</span><span class="token parameter">address _owner</span><span class="token punctuation">)</span> internal <span class="token punctuation">{</span>
        owner <span class="token operator">=</span> _owner<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    modifier <span class="token function">onlyOwner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender <span class="token operator">==</span> owner<span class="token punctuation">,</span> <span class="token string">&quot;Only owner is allowed to perform this action&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        _<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

contract LibraryLockDataLayout <span class="token punctuation">{</span>
  bool <span class="token keyword">public</span> initialized <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

contract LibraryLock is LibraryLockDataLayout <span class="token punctuation">{</span>
    <span class="token comment">// Ensures no one can manipulate the Logic Contract once it is deployed.</span>
    <span class="token comment">// PARITY WALLET HACK PREVENTION</span>

    modifier <span class="token function">delegatedOnly</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>initialized <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">&quot;The library is locked. No direct 'call' is allowed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        _<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> internal <span class="token punctuation">{</span>
        initialized <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

contact ERC20DataLayout is LibraryLockDataLayout <span class="token punctuation">{</span>
  uint256 <span class="token keyword">public</span> totalSupply<span class="token punctuation">;</span>
  <span class="token function">mapping</span><span class="token punctuation">(</span><span class="token parameter">address</span><span class="token operator">=&gt;</span>uint256<span class="token punctuation">)</span> <span class="token keyword">public</span> tokens<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

contract <span class="token constant">ERC20</span> <span class="token punctuation">{</span>
    <span class="token comment">//  ...</span>
    <span class="token keyword">function</span> <span class="token function">transfer</span><span class="token punctuation">(</span><span class="token parameter">address to<span class="token punctuation">,</span> uint256 amount</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
        <span class="token function">require</span><span class="token punctuation">(</span>tokens<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> amount<span class="token punctuation">,</span> <span class="token string">&quot;Not enough funds for transfer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tokens<span class="token punctuation">[</span>to<span class="token punctuation">]</span> <span class="token operator">+=</span> amount<span class="token punctuation">;</span>
        tokens<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span> <span class="token operator">-=</span> amount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

contract MyToken is ERC20DataLayout<span class="token punctuation">,</span> <span class="token constant">ERC20</span><span class="token punctuation">,</span> Owned<span class="token punctuation">,</span> Proxiable<span class="token punctuation">,</span> LibraryLock <span class="token punctuation">{</span>

    <span class="token keyword">function</span> <span class="token function">constructor1</span><span class="token punctuation">(</span><span class="token parameter">uint256 _initialSupply</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
        totalSupply <span class="token operator">=</span> _initialSupply<span class="token punctuation">;</span>
        tokens<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span> <span class="token operator">=</span> _initialSupply<span class="token punctuation">;</span>
        <span class="token function">initialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setOwner</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">updateCode</span><span class="token punctuation">(</span><span class="token parameter">address newCode</span><span class="token punctuation">)</span> <span class="token keyword">public</span> onlyOwner delegatedOnly  <span class="token punctuation">{</span>
        <span class="token function">updateCodeAddress</span><span class="token punctuation">(</span>newCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">transfer</span><span class="token punctuation">(</span><span class="token parameter">address to<span class="token punctuation">,</span> uint256 amount</span><span class="token punctuation">)</span> <span class="token keyword">public</span> delegatedOnly <span class="token punctuation">{</span>
        <span class="token constant">ERC20</span><span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> amount<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br></div></div><h2 id="references"><a href="#references" class="header-anchor">#</a> References</h2> <ul><li><a href="https://medium.com/terminaldotco/escape-hatch-proxy-efb681de108d" target="_blank" rel="noopener noreferrer">&quot;Escape-hatch&quot; proxy Medium Post<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="copyright"><a href="#copyright" class="header-anchor">#</a> Copyright</h2> <p>Copyright and related rights waived via <a href="https://creativecommons.org/publicdomain/zero/1.0/" target="_blank" rel="noopener noreferrer">CC0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ethlibrary/EIPs/edit/master/EIPS/eip-1822.md" target="_blank" rel="noopener noreferrer">帮助完善文档</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/26/2021, 5:30:00 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8bdc7c41.js" defer></script><script src="/assets/js/3.afc73834.js" defer></script><script src="/assets/js/22.2d627e68.js" defer></script>
  </body>
</html>
