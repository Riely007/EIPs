<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Upgradable Smart Contract | 以太坊改进提案 EIPs</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="以太坊改进提案（EIPs）描述了以太坊平台的标准，包括核心协议规范，客户端API和合约标准。">
    
    <link rel="preload" href="/assets/css/0.styles.89e32c3d.css" as="style"><link rel="preload" href="/assets/js/app.a13d8931.js" as="script"><link rel="preload" href="/assets/js/3.afc73834.js" as="script"><link rel="preload" href="/assets/js/108.e6af934c.js" as="script"><link rel="prefetch" href="/assets/js/10.b7e21e5d.js"><link rel="prefetch" href="/assets/js/100.d5d858e7.js"><link rel="prefetch" href="/assets/js/101.e1db9cf8.js"><link rel="prefetch" href="/assets/js/102.f33c0db7.js"><link rel="prefetch" href="/assets/js/103.9b2f992f.js"><link rel="prefetch" href="/assets/js/104.4682985f.js"><link rel="prefetch" href="/assets/js/105.f9e5318b.js"><link rel="prefetch" href="/assets/js/106.9c75a4a1.js"><link rel="prefetch" href="/assets/js/107.a77b3902.js"><link rel="prefetch" href="/assets/js/109.ea2fe245.js"><link rel="prefetch" href="/assets/js/11.19d07763.js"><link rel="prefetch" href="/assets/js/110.c7c5923b.js"><link rel="prefetch" href="/assets/js/111.53019564.js"><link rel="prefetch" href="/assets/js/112.2678b5bc.js"><link rel="prefetch" href="/assets/js/113.65344b60.js"><link rel="prefetch" href="/assets/js/114.34870900.js"><link rel="prefetch" href="/assets/js/115.e0ce944c.js"><link rel="prefetch" href="/assets/js/116.05caef5d.js"><link rel="prefetch" href="/assets/js/117.eb1f8851.js"><link rel="prefetch" href="/assets/js/118.1d54235b.js"><link rel="prefetch" href="/assets/js/119.57439d26.js"><link rel="prefetch" href="/assets/js/12.cc14cc21.js"><link rel="prefetch" href="/assets/js/120.fec4a349.js"><link rel="prefetch" href="/assets/js/121.e6ee3bd0.js"><link rel="prefetch" href="/assets/js/122.8b1067e2.js"><link rel="prefetch" href="/assets/js/123.e9852421.js"><link rel="prefetch" href="/assets/js/124.e2572e3e.js"><link rel="prefetch" href="/assets/js/125.d02927d3.js"><link rel="prefetch" href="/assets/js/126.5443f529.js"><link rel="prefetch" href="/assets/js/127.df02ad53.js"><link rel="prefetch" href="/assets/js/128.86d06d73.js"><link rel="prefetch" href="/assets/js/129.4ba20791.js"><link rel="prefetch" href="/assets/js/13.66816190.js"><link rel="prefetch" href="/assets/js/130.a3f03ff0.js"><link rel="prefetch" href="/assets/js/131.626e55b3.js"><link rel="prefetch" href="/assets/js/132.95f1e93d.js"><link rel="prefetch" href="/assets/js/133.6e47359a.js"><link rel="prefetch" href="/assets/js/134.47e4440e.js"><link rel="prefetch" href="/assets/js/135.adb1a4c4.js"><link rel="prefetch" href="/assets/js/136.45c43972.js"><link rel="prefetch" href="/assets/js/137.8ba370d0.js"><link rel="prefetch" href="/assets/js/138.74346e65.js"><link rel="prefetch" href="/assets/js/139.fad68529.js"><link rel="prefetch" href="/assets/js/14.1067acde.js"><link rel="prefetch" href="/assets/js/140.d7cf0c13.js"><link rel="prefetch" href="/assets/js/141.53ad4e2c.js"><link rel="prefetch" href="/assets/js/142.3054db6d.js"><link rel="prefetch" href="/assets/js/143.752707de.js"><link rel="prefetch" href="/assets/js/144.6bb5b315.js"><link rel="prefetch" href="/assets/js/145.5be11191.js"><link rel="prefetch" href="/assets/js/146.65c4a5f7.js"><link rel="prefetch" href="/assets/js/147.503abedf.js"><link rel="prefetch" href="/assets/js/148.fac10f82.js"><link rel="prefetch" href="/assets/js/149.39bdc952.js"><link rel="prefetch" href="/assets/js/15.9ca9208b.js"><link rel="prefetch" href="/assets/js/150.763447dd.js"><link rel="prefetch" href="/assets/js/151.74711268.js"><link rel="prefetch" href="/assets/js/152.04b548a4.js"><link rel="prefetch" href="/assets/js/153.f76cfea2.js"><link rel="prefetch" href="/assets/js/154.63dde107.js"><link rel="prefetch" href="/assets/js/155.0c715174.js"><link rel="prefetch" href="/assets/js/156.685fab04.js"><link rel="prefetch" href="/assets/js/157.6739174d.js"><link rel="prefetch" href="/assets/js/158.882bbbfc.js"><link rel="prefetch" href="/assets/js/159.aede9782.js"><link rel="prefetch" href="/assets/js/16.9eea9a64.js"><link rel="prefetch" href="/assets/js/160.d9be3959.js"><link rel="prefetch" href="/assets/js/161.76cc08ef.js"><link rel="prefetch" href="/assets/js/162.1bdec2e1.js"><link rel="prefetch" href="/assets/js/163.ac0295b3.js"><link rel="prefetch" href="/assets/js/164.cf094dd8.js"><link rel="prefetch" href="/assets/js/165.fa43d86b.js"><link rel="prefetch" href="/assets/js/166.b42e919a.js"><link rel="prefetch" href="/assets/js/167.cd4e2412.js"><link rel="prefetch" href="/assets/js/168.b923679f.js"><link rel="prefetch" href="/assets/js/169.0381e4c3.js"><link rel="prefetch" href="/assets/js/17.8d0803f5.js"><link rel="prefetch" href="/assets/js/170.07048ad0.js"><link rel="prefetch" href="/assets/js/171.efbf2d1b.js"><link rel="prefetch" href="/assets/js/172.c6f3f3a1.js"><link rel="prefetch" href="/assets/js/173.b0448642.js"><link rel="prefetch" href="/assets/js/174.9c3b47d1.js"><link rel="prefetch" href="/assets/js/175.6399aebe.js"><link rel="prefetch" href="/assets/js/176.72f40c53.js"><link rel="prefetch" href="/assets/js/177.e4a8654e.js"><link rel="prefetch" href="/assets/js/178.d88d2f1f.js"><link rel="prefetch" href="/assets/js/179.5f89ba63.js"><link rel="prefetch" href="/assets/js/18.3444113b.js"><link rel="prefetch" href="/assets/js/180.9add0321.js"><link rel="prefetch" href="/assets/js/181.a089c28c.js"><link rel="prefetch" href="/assets/js/182.5c030e78.js"><link rel="prefetch" href="/assets/js/183.a96244f5.js"><link rel="prefetch" href="/assets/js/184.8a73b7fa.js"><link rel="prefetch" href="/assets/js/185.39aa4852.js"><link rel="prefetch" href="/assets/js/186.63c92b48.js"><link rel="prefetch" href="/assets/js/187.0afea76b.js"><link rel="prefetch" href="/assets/js/188.4b72b322.js"><link rel="prefetch" href="/assets/js/189.dacc64a4.js"><link rel="prefetch" href="/assets/js/19.45b60500.js"><link rel="prefetch" href="/assets/js/190.6e72d819.js"><link rel="prefetch" href="/assets/js/191.f3361d30.js"><link rel="prefetch" href="/assets/js/192.d02dc2b3.js"><link rel="prefetch" href="/assets/js/193.9185ff86.js"><link rel="prefetch" href="/assets/js/194.109e4d2b.js"><link rel="prefetch" href="/assets/js/195.9a12a7ef.js"><link rel="prefetch" href="/assets/js/196.30492964.js"><link rel="prefetch" href="/assets/js/197.b8f1016e.js"><link rel="prefetch" href="/assets/js/198.cf2ff396.js"><link rel="prefetch" href="/assets/js/199.617d97ea.js"><link rel="prefetch" href="/assets/js/20.ee4a86f1.js"><link rel="prefetch" href="/assets/js/200.414ac8b8.js"><link rel="prefetch" href="/assets/js/201.6eb83ac5.js"><link rel="prefetch" href="/assets/js/202.f94a8455.js"><link rel="prefetch" href="/assets/js/203.fe4c3d1f.js"><link rel="prefetch" href="/assets/js/204.003cdcb5.js"><link rel="prefetch" href="/assets/js/205.dfb2370b.js"><link rel="prefetch" href="/assets/js/206.a3cdde0f.js"><link rel="prefetch" href="/assets/js/207.7eeb49e5.js"><link rel="prefetch" href="/assets/js/208.f77631f1.js"><link rel="prefetch" href="/assets/js/209.03b79d5b.js"><link rel="prefetch" href="/assets/js/21.81e9a796.js"><link rel="prefetch" href="/assets/js/210.4d77fab4.js"><link rel="prefetch" href="/assets/js/211.504c34d5.js"><link rel="prefetch" href="/assets/js/212.71bb8bf5.js"><link rel="prefetch" href="/assets/js/213.a3b6c27d.js"><link rel="prefetch" href="/assets/js/214.0da60311.js"><link rel="prefetch" href="/assets/js/215.cdeb87d0.js"><link rel="prefetch" href="/assets/js/216.75ce111f.js"><link rel="prefetch" href="/assets/js/217.2a924ebe.js"><link rel="prefetch" href="/assets/js/218.b3782b37.js"><link rel="prefetch" href="/assets/js/219.a7b3d0e2.js"><link rel="prefetch" href="/assets/js/22.037348a7.js"><link rel="prefetch" href="/assets/js/220.67f4dc4d.js"><link rel="prefetch" href="/assets/js/221.122e58c3.js"><link rel="prefetch" href="/assets/js/222.4a6ce5ee.js"><link rel="prefetch" href="/assets/js/223.38c97c72.js"><link rel="prefetch" href="/assets/js/224.08f05ad3.js"><link rel="prefetch" href="/assets/js/225.a1f1248d.js"><link rel="prefetch" href="/assets/js/226.49679af1.js"><link rel="prefetch" href="/assets/js/227.272b5118.js"><link rel="prefetch" href="/assets/js/228.97fe27a2.js"><link rel="prefetch" href="/assets/js/229.08893382.js"><link rel="prefetch" href="/assets/js/23.e7c462f9.js"><link rel="prefetch" href="/assets/js/230.fca4ec8d.js"><link rel="prefetch" href="/assets/js/231.dcf2e717.js"><link rel="prefetch" href="/assets/js/232.ad58634e.js"><link rel="prefetch" href="/assets/js/233.62b51320.js"><link rel="prefetch" href="/assets/js/234.366a5c15.js"><link rel="prefetch" href="/assets/js/235.37ee5e06.js"><link rel="prefetch" href="/assets/js/236.c8db6b56.js"><link rel="prefetch" href="/assets/js/237.2a5623bb.js"><link rel="prefetch" href="/assets/js/238.a1e8e150.js"><link rel="prefetch" href="/assets/js/239.9173cd25.js"><link rel="prefetch" href="/assets/js/24.b2111a14.js"><link rel="prefetch" href="/assets/js/240.74555993.js"><link rel="prefetch" href="/assets/js/241.78b20824.js"><link rel="prefetch" href="/assets/js/242.6acd697d.js"><link rel="prefetch" href="/assets/js/243.e43066f7.js"><link rel="prefetch" href="/assets/js/244.73e01f3b.js"><link rel="prefetch" href="/assets/js/245.3f27ce09.js"><link rel="prefetch" href="/assets/js/246.c0bf05db.js"><link rel="prefetch" href="/assets/js/247.0d837589.js"><link rel="prefetch" href="/assets/js/248.d09c386a.js"><link rel="prefetch" href="/assets/js/249.10459d63.js"><link rel="prefetch" href="/assets/js/25.0610f8ef.js"><link rel="prefetch" href="/assets/js/250.f48824df.js"><link rel="prefetch" href="/assets/js/251.121f3d80.js"><link rel="prefetch" href="/assets/js/252.5f893054.js"><link rel="prefetch" href="/assets/js/253.1417eb3b.js"><link rel="prefetch" href="/assets/js/254.5eac655f.js"><link rel="prefetch" href="/assets/js/255.c730cba3.js"><link rel="prefetch" href="/assets/js/256.1219af97.js"><link rel="prefetch" href="/assets/js/257.04701e9e.js"><link rel="prefetch" href="/assets/js/258.3a3b2150.js"><link rel="prefetch" href="/assets/js/259.e70aceaf.js"><link rel="prefetch" href="/assets/js/26.9114f6fc.js"><link rel="prefetch" href="/assets/js/260.7b8b2967.js"><link rel="prefetch" href="/assets/js/261.c0961706.js"><link rel="prefetch" href="/assets/js/262.d6f757d3.js"><link rel="prefetch" href="/assets/js/263.5659fcc5.js"><link rel="prefetch" href="/assets/js/264.8b56c627.js"><link rel="prefetch" href="/assets/js/265.16d5ce3a.js"><link rel="prefetch" href="/assets/js/266.17f217c2.js"><link rel="prefetch" href="/assets/js/267.e70076df.js"><link rel="prefetch" href="/assets/js/268.b06b7a1e.js"><link rel="prefetch" href="/assets/js/269.b5819c04.js"><link rel="prefetch" href="/assets/js/27.2f304f70.js"><link rel="prefetch" href="/assets/js/270.0beee4b9.js"><link rel="prefetch" href="/assets/js/271.90d0c5e4.js"><link rel="prefetch" href="/assets/js/272.1d617a52.js"><link rel="prefetch" href="/assets/js/273.5d7054ff.js"><link rel="prefetch" href="/assets/js/274.eedc246e.js"><link rel="prefetch" href="/assets/js/275.e89375ea.js"><link rel="prefetch" href="/assets/js/276.1ee4957e.js"><link rel="prefetch" href="/assets/js/277.3fb8abc6.js"><link rel="prefetch" href="/assets/js/278.bc288b6e.js"><link rel="prefetch" href="/assets/js/279.c3111a87.js"><link rel="prefetch" href="/assets/js/28.6a081e3d.js"><link rel="prefetch" href="/assets/js/280.d7edbe4d.js"><link rel="prefetch" href="/assets/js/281.98d9104a.js"><link rel="prefetch" href="/assets/js/282.d09079ea.js"><link rel="prefetch" href="/assets/js/283.996adb15.js"><link rel="prefetch" href="/assets/js/284.ff69d3db.js"><link rel="prefetch" href="/assets/js/285.75d86772.js"><link rel="prefetch" href="/assets/js/286.48f2c786.js"><link rel="prefetch" href="/assets/js/287.964dc8a8.js"><link rel="prefetch" href="/assets/js/288.f50b81c4.js"><link rel="prefetch" href="/assets/js/289.b15ef4ba.js"><link rel="prefetch" href="/assets/js/29.e6c29d28.js"><link rel="prefetch" href="/assets/js/290.065686f6.js"><link rel="prefetch" href="/assets/js/291.8e91cb89.js"><link rel="prefetch" href="/assets/js/292.23991b2a.js"><link rel="prefetch" href="/assets/js/293.d89282cb.js"><link rel="prefetch" href="/assets/js/294.8459cf6b.js"><link rel="prefetch" href="/assets/js/295.5159bb70.js"><link rel="prefetch" href="/assets/js/296.bad535dd.js"><link rel="prefetch" href="/assets/js/297.a89c8004.js"><link rel="prefetch" href="/assets/js/298.bfc2ed34.js"><link rel="prefetch" href="/assets/js/299.ed75d8ac.js"><link rel="prefetch" href="/assets/js/30.7ef93552.js"><link rel="prefetch" href="/assets/js/300.04fd45af.js"><link rel="prefetch" href="/assets/js/301.913d3df9.js"><link rel="prefetch" href="/assets/js/302.10b258dd.js"><link rel="prefetch" href="/assets/js/303.fbdf4e67.js"><link rel="prefetch" href="/assets/js/304.e0ff7d5b.js"><link rel="prefetch" href="/assets/js/305.300c5349.js"><link rel="prefetch" href="/assets/js/306.9f73bc93.js"><link rel="prefetch" href="/assets/js/307.b187f491.js"><link rel="prefetch" href="/assets/js/308.d03c07b3.js"><link rel="prefetch" href="/assets/js/309.937b56a3.js"><link rel="prefetch" href="/assets/js/31.7afea5f6.js"><link rel="prefetch" href="/assets/js/310.635a8c4d.js"><link rel="prefetch" href="/assets/js/311.573fcf4a.js"><link rel="prefetch" href="/assets/js/312.bc67fce0.js"><link rel="prefetch" href="/assets/js/313.b5013426.js"><link rel="prefetch" href="/assets/js/314.ae21fa05.js"><link rel="prefetch" href="/assets/js/315.37182c2b.js"><link rel="prefetch" href="/assets/js/316.06cf15a9.js"><link rel="prefetch" href="/assets/js/317.df759a5b.js"><link rel="prefetch" href="/assets/js/318.1a66ad2b.js"><link rel="prefetch" href="/assets/js/319.17d9681e.js"><link rel="prefetch" href="/assets/js/32.861f9380.js"><link rel="prefetch" href="/assets/js/320.10769343.js"><link rel="prefetch" href="/assets/js/321.cc4a3790.js"><link rel="prefetch" href="/assets/js/322.d2b9bced.js"><link rel="prefetch" href="/assets/js/323.dadd7af5.js"><link rel="prefetch" href="/assets/js/324.4281b9b7.js"><link rel="prefetch" href="/assets/js/325.313d6817.js"><link rel="prefetch" href="/assets/js/326.e63bdc82.js"><link rel="prefetch" href="/assets/js/327.f47507e0.js"><link rel="prefetch" href="/assets/js/328.f35cf934.js"><link rel="prefetch" href="/assets/js/329.a1084770.js"><link rel="prefetch" href="/assets/js/33.ab9e8c2b.js"><link rel="prefetch" href="/assets/js/330.ca4cd65f.js"><link rel="prefetch" href="/assets/js/331.e75a5907.js"><link rel="prefetch" href="/assets/js/332.fb511231.js"><link rel="prefetch" href="/assets/js/333.f93dbb9e.js"><link rel="prefetch" href="/assets/js/334.a71bbaa5.js"><link rel="prefetch" href="/assets/js/335.2fa937a5.js"><link rel="prefetch" href="/assets/js/336.a9679a8c.js"><link rel="prefetch" href="/assets/js/337.597945ba.js"><link rel="prefetch" href="/assets/js/338.05b854a8.js"><link rel="prefetch" href="/assets/js/339.fb34c537.js"><link rel="prefetch" href="/assets/js/34.91cf34bb.js"><link rel="prefetch" href="/assets/js/340.bb04bb94.js"><link rel="prefetch" href="/assets/js/341.d8eab431.js"><link rel="prefetch" href="/assets/js/342.adb6fccd.js"><link rel="prefetch" href="/assets/js/343.2e514ff7.js"><link rel="prefetch" href="/assets/js/344.ae288347.js"><link rel="prefetch" href="/assets/js/345.36cef5e0.js"><link rel="prefetch" href="/assets/js/346.18900139.js"><link rel="prefetch" href="/assets/js/347.55de0e5f.js"><link rel="prefetch" href="/assets/js/348.e8df7344.js"><link rel="prefetch" href="/assets/js/349.391634ff.js"><link rel="prefetch" href="/assets/js/35.a54aaacc.js"><link rel="prefetch" href="/assets/js/350.6ed9c27e.js"><link rel="prefetch" href="/assets/js/351.13d8f554.js"><link rel="prefetch" href="/assets/js/352.42a626e4.js"><link rel="prefetch" href="/assets/js/353.28e60cfb.js"><link rel="prefetch" href="/assets/js/354.1d876de3.js"><link rel="prefetch" href="/assets/js/355.be9dd30e.js"><link rel="prefetch" href="/assets/js/356.c76485ba.js"><link rel="prefetch" href="/assets/js/357.3beca4a2.js"><link rel="prefetch" href="/assets/js/358.34ce9b7c.js"><link rel="prefetch" href="/assets/js/359.62662c8a.js"><link rel="prefetch" href="/assets/js/36.1fb34483.js"><link rel="prefetch" href="/assets/js/360.1d4fd1c2.js"><link rel="prefetch" href="/assets/js/361.cedc472b.js"><link rel="prefetch" href="/assets/js/362.1a42a5a9.js"><link rel="prefetch" href="/assets/js/363.3212b786.js"><link rel="prefetch" href="/assets/js/364.795f5fbb.js"><link rel="prefetch" href="/assets/js/365.ba5aeafd.js"><link rel="prefetch" href="/assets/js/366.9e7c06f4.js"><link rel="prefetch" href="/assets/js/367.520bbbb6.js"><link rel="prefetch" href="/assets/js/368.1645c28e.js"><link rel="prefetch" href="/assets/js/369.3809a538.js"><link rel="prefetch" href="/assets/js/37.ee12bd46.js"><link rel="prefetch" href="/assets/js/370.217b10df.js"><link rel="prefetch" href="/assets/js/371.c8a9e0a9.js"><link rel="prefetch" href="/assets/js/372.247d9278.js"><link rel="prefetch" href="/assets/js/373.0eed1f0a.js"><link rel="prefetch" href="/assets/js/374.881713dc.js"><link rel="prefetch" href="/assets/js/375.b09c525d.js"><link rel="prefetch" href="/assets/js/376.43c32017.js"><link rel="prefetch" href="/assets/js/377.47cbbf1d.js"><link rel="prefetch" href="/assets/js/378.dd3eec1a.js"><link rel="prefetch" href="/assets/js/379.191b4f64.js"><link rel="prefetch" href="/assets/js/38.242d9c7f.js"><link rel="prefetch" href="/assets/js/380.8f916b60.js"><link rel="prefetch" href="/assets/js/381.fe1dfc6a.js"><link rel="prefetch" href="/assets/js/382.067d85f2.js"><link rel="prefetch" href="/assets/js/383.eeab62ac.js"><link rel="prefetch" href="/assets/js/384.ffab213d.js"><link rel="prefetch" href="/assets/js/385.94da6ae9.js"><link rel="prefetch" href="/assets/js/386.991dd01d.js"><link rel="prefetch" href="/assets/js/387.ffb790b4.js"><link rel="prefetch" href="/assets/js/388.ed3f39f5.js"><link rel="prefetch" href="/assets/js/389.a6174e1c.js"><link rel="prefetch" href="/assets/js/39.dbcc5d61.js"><link rel="prefetch" href="/assets/js/390.fe916439.js"><link rel="prefetch" href="/assets/js/391.69f751d7.js"><link rel="prefetch" href="/assets/js/392.e6c52ac2.js"><link rel="prefetch" href="/assets/js/393.7da57f52.js"><link rel="prefetch" href="/assets/js/394.1a7a717f.js"><link rel="prefetch" href="/assets/js/395.3399844a.js"><link rel="prefetch" href="/assets/js/396.7f2e8145.js"><link rel="prefetch" href="/assets/js/397.42b4026a.js"><link rel="prefetch" href="/assets/js/398.5c231ed1.js"><link rel="prefetch" href="/assets/js/399.4566824b.js"><link rel="prefetch" href="/assets/js/4.fea0df6a.js"><link rel="prefetch" href="/assets/js/40.493a59f4.js"><link rel="prefetch" href="/assets/js/400.6882e1d0.js"><link rel="prefetch" href="/assets/js/401.527ff51d.js"><link rel="prefetch" href="/assets/js/402.e9c37d2a.js"><link rel="prefetch" href="/assets/js/403.360b2d7d.js"><link rel="prefetch" href="/assets/js/404.4d3adaac.js"><link rel="prefetch" href="/assets/js/405.c6785e58.js"><link rel="prefetch" href="/assets/js/406.ea8781ae.js"><link rel="prefetch" href="/assets/js/407.b0463036.js"><link rel="prefetch" href="/assets/js/408.56b3f633.js"><link rel="prefetch" href="/assets/js/409.83b77a08.js"><link rel="prefetch" href="/assets/js/41.bd45f48a.js"><link rel="prefetch" href="/assets/js/410.808144cb.js"><link rel="prefetch" href="/assets/js/411.efd2ae36.js"><link rel="prefetch" href="/assets/js/412.42b1274b.js"><link rel="prefetch" href="/assets/js/42.3475d232.js"><link rel="prefetch" href="/assets/js/43.2407adcb.js"><link rel="prefetch" href="/assets/js/44.e2a316c5.js"><link rel="prefetch" href="/assets/js/45.1c5f24df.js"><link rel="prefetch" href="/assets/js/46.18a61726.js"><link rel="prefetch" href="/assets/js/47.707f9f7a.js"><link rel="prefetch" href="/assets/js/48.5dd41842.js"><link rel="prefetch" href="/assets/js/49.d3acd899.js"><link rel="prefetch" href="/assets/js/5.461bccd8.js"><link rel="prefetch" href="/assets/js/50.02c1a863.js"><link rel="prefetch" href="/assets/js/51.ccf0ba79.js"><link rel="prefetch" href="/assets/js/52.3aee611f.js"><link rel="prefetch" href="/assets/js/53.bf3daa85.js"><link rel="prefetch" href="/assets/js/54.d61cd0a6.js"><link rel="prefetch" href="/assets/js/55.5986d91d.js"><link rel="prefetch" href="/assets/js/56.da7d4622.js"><link rel="prefetch" href="/assets/js/57.a53216e9.js"><link rel="prefetch" href="/assets/js/58.eb424782.js"><link rel="prefetch" href="/assets/js/59.0db825e2.js"><link rel="prefetch" href="/assets/js/6.76cd68c6.js"><link rel="prefetch" href="/assets/js/60.885ad249.js"><link rel="prefetch" href="/assets/js/61.9a010ecb.js"><link rel="prefetch" href="/assets/js/62.907dc688.js"><link rel="prefetch" href="/assets/js/63.69f56658.js"><link rel="prefetch" href="/assets/js/64.ec17ab0c.js"><link rel="prefetch" href="/assets/js/65.555f05e2.js"><link rel="prefetch" href="/assets/js/66.82f26703.js"><link rel="prefetch" href="/assets/js/67.3d43cd18.js"><link rel="prefetch" href="/assets/js/68.b14b7646.js"><link rel="prefetch" href="/assets/js/69.f4f9155f.js"><link rel="prefetch" href="/assets/js/7.f2fbf882.js"><link rel="prefetch" href="/assets/js/70.146046b6.js"><link rel="prefetch" href="/assets/js/71.5cc26b01.js"><link rel="prefetch" href="/assets/js/72.bc119d92.js"><link rel="prefetch" href="/assets/js/73.9d63e7dc.js"><link rel="prefetch" href="/assets/js/74.f12f047e.js"><link rel="prefetch" href="/assets/js/75.131756e3.js"><link rel="prefetch" href="/assets/js/76.147c95b9.js"><link rel="prefetch" href="/assets/js/77.4f81bf5f.js"><link rel="prefetch" href="/assets/js/78.2620317a.js"><link rel="prefetch" href="/assets/js/79.7d79e1df.js"><link rel="prefetch" href="/assets/js/8.d346a35e.js"><link rel="prefetch" href="/assets/js/80.08435f23.js"><link rel="prefetch" href="/assets/js/81.bbea59aa.js"><link rel="prefetch" href="/assets/js/82.93bbfeeb.js"><link rel="prefetch" href="/assets/js/83.9e0f2d3f.js"><link rel="prefetch" href="/assets/js/84.2a78f0ef.js"><link rel="prefetch" href="/assets/js/85.464597f8.js"><link rel="prefetch" href="/assets/js/86.8cced385.js"><link rel="prefetch" href="/assets/js/87.6eab3983.js"><link rel="prefetch" href="/assets/js/88.919be664.js"><link rel="prefetch" href="/assets/js/89.a9c88099.js"><link rel="prefetch" href="/assets/js/9.2b013f04.js"><link rel="prefetch" href="/assets/js/90.e30432e7.js"><link rel="prefetch" href="/assets/js/91.6b17f9d5.js"><link rel="prefetch" href="/assets/js/92.044d73f7.js"><link rel="prefetch" href="/assets/js/93.446151cb.js"><link rel="prefetch" href="/assets/js/94.777e77bb.js"><link rel="prefetch" href="/assets/js/95.dbda6d80.js"><link rel="prefetch" href="/assets/js/96.e280ef31.js"><link rel="prefetch" href="/assets/js/97.2d68e74b.js"><link rel="prefetch" href="/assets/js/98.93faeca6.js"><link rel="prefetch" href="/assets/js/99.8285fa98.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.029a7c95.js">
    <link rel="stylesheet" href="/assets/css/0.styles.89e32c3d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">以太坊改进提案 EIPs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://ethlibrary.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  About us
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/ethlibrary/EIPs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://ethlibrary.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  About us
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/ethlibrary/EIPs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/all.html" class="sidebar-link">All EIPs</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Status</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/draft.html" class="sidebar-link">Draft</a></li><li><a href="/review.html" class="sidebar-link">Review</a></li><li><a href="/lastCall.html" class="sidebar-link">Last Call</a></li><li><a href="/accepted.html" class="sidebar-link">Accepted</a></li><li><a href="/final_and_living.html" class="sidebar-link">Final and Living</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Type</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/core.html" class="sidebar-link">Core (165)</a></li><li><a href="/networking.html" class="sidebar-link">Networking (11)</a></li><li><a href="/interface.html" class="sidebar-link">Interface (38)</a></li><li><a href="/erc.html" class="sidebar-link">ERC (153)</a></li><li><a href="/meta.html" class="sidebar-link">Meta (18)</a></li><li><a href="/informational.html" class="sidebar-link">Informational (6)</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="simple-summary"><a href="#simple-summary" class="header-anchor">#</a> Simple Summary</h2> <p>A standard interface/guideline that makes a smart contract upgradable.</p> <h2 id="abstract"><a href="#abstract" class="header-anchor">#</a> Abstract</h2> <p>Ethereum smart contracts have suffered a number of security issues in the past few years. The cost of fixing such a bug in smart contract is significant; for example, the consequences of The DAO attack in June 2016 caused tremendous financial loss and the hard fork of Ethereum blockchain.</p> <p>The following standard makes it possible to upgrade a standard API within smart contracts. This standard provides basic functionalities to upgrade the operations of the contract without data migration. To ensure the decentralization/community interests, it also contains a voting mechanism to control the upgrading process.</p> <h2 id="motivation"><a href="#motivation" class="header-anchor">#</a> Motivation</h2> <p>Smart contract is immutable after deployment. If any security risk is identified or program bug is detected, developers always have to destruct the old contract, deploy a new one and potentially migrate the data (hard fork) to the new contract. In some cases, deploying a smart contract with bugs and potential security vulnerabilities can cause a significant amount of financial loss.</p> <p>We propose this upgradable contract to fix the current situation. With the upgradable contract, developers can deploy a new version of smart contract after previous deployment and retain the data at the same time.</p> <p>For example, after an ERC20-compliant token contract is deployed, the users exploit a vulnerability in the source code.  Without the support of upgradable contract, developers have to fix this issue by deploy a new, secured contract otherwise the attackers would take advantage of the security hole, which may cause a tremendous financial loss. A challenge is how to migrate data from the old contract to a new one. With the upgradable contract below, this will become relatively easy as developers only have to upgrade the Handler contract to fix bugs while the Data contract will remain the same.</p> <h2 id="specification"><a href="#specification" class="header-anchor">#</a> Specification</h2> <p>The upgradable contract consists of three parts:</p> <ul><li><strong>Handler contract</strong> (implements <strong>Handler interface</strong>) defines operations and provides services. This contract can be upgraded;</li> <li><strong>Data contract</strong> keeps the resources (data) and is controlled by the Handler contract;</li> <li><strong>Upgrader contract (optional)</strong> deals with the voting mechanism and upgrades the Handler contract. The voters are pre-defined by the contract owner.</li></ul> <blockquote><p>The following codes are exact copies of the <a href="https://gist.github.com/swordghost/77c96a972106af6ec6ccea9c2d66e768" target="_blank" rel="noopener noreferrer">ERC-1504 Upgradable Smart Contract.<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h3 id="handler-contract-and-handler-interface"><a href="#handler-contract-and-handler-interface" class="header-anchor">#</a> Handler contract and Handler interface</h3> <p>Functions of the Handler contract vary with requirements, so developers would better design interfaces for Handler contracts to limit them and make sure external applications are always supported.</p> <p>Below is the specification of Handler interface. In the Handler interface we define the following actions:</p> <ul><li>Initialize the Data contract;</li> <li>Register the Upgrader contract address;</li> <li>Destruct the Handler contract after upgrading is done;</li> <li>Verify the current Handler is the working one → it should always return true.</li></ul> <p>Developers have to define their business-related functions as well.</p> <div class="language-solidity line-numbers-mode"><pre class="language-solidity"><code><span class="token comment">/// Handler interface.</span>
<span class="token comment">/// Handler defines business related functions.</span>
<span class="token comment">/// Use the interface to ensure that your external services are always supported.</span>
<span class="token comment">/// Because of function live(), we design IHandler as an abstract contract rather than a true interface.</span>
<span class="token keyword">contract</span> <span class="token class-name">IHandler</span> <span class="token punctuation">{</span>

    <span class="token comment">/// Initialize the data contarct.</span>
    <span class="token comment">/// @param  _str    value of exmStr of Data contract.</span>
    <span class="token comment">/// @param  _int    value of exmInt of Data contract.</span>
    <span class="token comment">/// @param  _array  value of exmArray of Data contract.</span>
    <span class="token keyword">function</span> initialize <span class="token punctuation">(</span><span class="token builtin">string</span> _str<span class="token punctuation">,</span> <span class="token builtin">uint256</span> _int<span class="token punctuation">,</span> <span class="token builtin">uint16</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> _array<span class="token punctuation">)</span> <span class="token keyword">public</span><span class="token punctuation">;</span>

    <span class="token comment">/// Register Upgrader contract address.</span>
    <span class="token comment">/// @param  _upgraderAddr   address of the Upgrader contract.</span>
    <span class="token keyword">function</span> registerUpgrader <span class="token punctuation">(</span><span class="token builtin">address</span> _upgraderAddr<span class="token punctuation">)</span> <span class="token keyword">external</span><span class="token punctuation">;</span>

    <span class="token comment">/// Upgrader contract calls this to check if it is registered.</span>
    <span class="token comment">/// @return if the Upgrader contract is registered.</span>
    <span class="token keyword">function</span> isUpgraderRegistered <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">external</span> <span class="token keyword">view</span> <span class="token keyword">returns</span><span class="token punctuation">(</span><span class="token builtin">bool</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/// Handler has been upgraded so the original one has to self-destruct.</span>
    <span class="token keyword">function</span> <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">external</span><span class="token punctuation">;</span>

    <span class="token comment">/// Check if the Handler contract is a working Handler contract.</span>
    <span class="token comment">/// It is used to prove the contract is a Handler contract.</span>
    <span class="token comment">/// @return always true.</span>
    <span class="token keyword">function</span> <span class="token function">live</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">external</span> <span class="token keyword">pure</span> <span class="token keyword">returns</span><span class="token punctuation">(</span><span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/** Functions - define functions here */</span>

    <span class="token comment">/** Events - add events here */</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>The process of deploying a Handler contract:</p> <ol><li>Deploy Data contract;</li> <li>Deploy a Handler contract at a given address specified in the Data contract;</li> <li>Register the Handler contract address by calling setHandler() in the Data contract, or use an Upgrader contract to switch the Handler contract, which requires that Data contract is initialized;</li> <li>Initialize Data contract if haven’t done it already.</li></ol> <h3 id="data-contract"><a href="#data-contract" class="header-anchor">#</a> Data Contract</h3> <p>Below is the specification of Data contract. There are three parts in the Data contract:</p> <ul><li><strong>Administrator Data</strong>: owner’s address, Handler contract’s address and a boolean indicating whether the contract is initialized or not;</li> <li><strong>Upgrader Data</strong>: Upgrader contract’s address, upgrade proposal’s submission timestamp and proposal’s time period;</li> <li><strong>Resource Data</strong>: all other resources that the contract needs to keep and manage.</li></ul> <div class="language-solidity line-numbers-mode"><pre class="language-solidity"><code><span class="token comment">/// Data Contract</span>
<span class="token keyword">contract</span> <span class="token class-name">DataContract</span> <span class="token punctuation">{</span>

    <span class="token comment">/** Management data */</span>
    <span class="token comment">/// Owner and Handler contract</span>
    <span class="token builtin">address</span> <span class="token keyword">private</span> owner<span class="token punctuation">;</span>
    <span class="token builtin">address</span> <span class="token keyword">private</span> handlerAddr<span class="token punctuation">;</span>

    <span class="token comment">/// Ready?</span>
    <span class="token builtin">bool</span> <span class="token keyword">private</span> valid<span class="token punctuation">;</span>

    <span class="token comment">/** Upgrader data */</span>
    <span class="token builtin">address</span> <span class="token keyword">private</span> upgraderAddr<span class="token punctuation">;</span>
    <span class="token builtin">uint256</span> <span class="token keyword">private</span> proposalBlockNumber<span class="token punctuation">;</span>
    <span class="token builtin">uint256</span> <span class="token keyword">private</span> proposalPeriod<span class="token punctuation">;</span>
    <span class="token comment">/// Upgrading status of the Handler contract</span>
    <span class="token keyword">enum</span> <span class="token class-name">UpgradingStatus</span> <span class="token punctuation">{</span>
        <span class="token comment">/// Can be upgraded</span>
        Done<span class="token punctuation">,</span>
        <span class="token comment">/// In upgrading</span>
        InProgress<span class="token punctuation">,</span>
        <span class="token comment">/// Another proposal is in progress</span>
        Blocked<span class="token punctuation">,</span>
        <span class="token comment">/// Expired</span>
        Expired<span class="token punctuation">,</span>
        <span class="token comment">/// Original Handler contract error</span>
        Error
    <span class="token punctuation">}</span>

    <span class="token comment">/** Data resources - define variables here */</span>

    <span class="token comment">/** Modifiers */</span>

    <span class="token comment">/// Check if msg.sender is the Handler contract. It is used for setters.</span>
    <span class="token comment">/// If fail, throw PermissionException.</span>
    <span class="token keyword">modifier</span> onlyHandler<span class="token punctuation">;</span>

    <span class="token comment">/// Check if msg.sender is not permitted to call getters. It is used for getters (if necessary).</span>
    <span class="token comment">/// If fail, throw GetterPermissionException.</span>
    <span class="token keyword">modifier</span> allowedAddress<span class="token punctuation">;</span>

    <span class="token comment">/// Check if the contract is working.</span>
    <span class="token comment">/// It is used for all functions providing services after initialization.</span>
    <span class="token comment">/// If fail, throw UninitializationException.</span>
    <span class="token keyword">modifier</span> ready<span class="token punctuation">;</span>

    <span class="token comment">/** Management functions */</span>

    <span class="token comment">/// Initializer. Just the Handler contract can call it. </span>
    <span class="token comment">/// @param  _str    default value of this.exmStr.</span>
    <span class="token comment">/// @param  _int    default value of this.exmInt.</span>
    <span class="token comment">/// @param  _array  default value of this.exmArray.</span>
    <span class="token comment">/// exception   PermissionException msg.sender is not the Handler contract.</span>
    <span class="token comment">/// exception   ReInitializationException   contract has been initialized.</span>
    <span class="token comment">/// @return if the initialization succeeds.</span>
    <span class="token keyword">function</span> initialize <span class="token punctuation">(</span><span class="token builtin">string</span> _str<span class="token punctuation">,</span> <span class="token builtin">uint256</span> _int<span class="token punctuation">,</span> <span class="token builtin">uint16</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> _array<span class="token punctuation">)</span> <span class="token keyword">external</span> onlyHandler <span class="token keyword">returns</span><span class="token punctuation">(</span><span class="token builtin">bool</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/// Set Handler contract for the contract. Owner must set one to initialize the Data contract.</span>
    <span class="token comment">/// Handler can be set by owner or Upgrader contract.</span>
    <span class="token comment">/// @param  _handlerAddr    address of a deployed Handler contract.</span>
    <span class="token comment">/// @param  _originalHandlerAddr    address of the original Handler contract, only used when an Upgrader contract want to set the Handler contract.</span>
    <span class="token comment">/// exception   PermissionException msg.sender is not the owner nor a registered Upgrader contract.</span>
    <span class="token comment">/// exception   UpgraderException   Upgrader contract does not provide a right address of the original Handler contract.</span>
    <span class="token comment">/// @return if Handler contract is successfully set.</span>
    <span class="token keyword">function</span> setHandler <span class="token punctuation">(</span><span class="token builtin">address</span> _handlerAddr<span class="token punctuation">,</span> <span class="token builtin">address</span> _originalHandlerAddr<span class="token punctuation">)</span> <span class="token keyword">external</span> <span class="token keyword">returns</span><span class="token punctuation">(</span><span class="token builtin">bool</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/** Upgrader contract functions */</span>

    <span class="token comment">/// Register an Upgrader contract in the contract.</span>
    <span class="token comment">/// If a proposal has not been accepted until proposalBlockNumber + proposalPeriod, it can be replaced by a new one.</span>
    <span class="token comment">/// @param  _upgraderAddr  address of a deployed Upgrader contract.</span>
    <span class="token comment">/// exception   PermissionException msg.sender is not the owner.</span>
    <span class="token comment">/// exception   UpgraderConflictException   Another Upgrader contract is working.</span>
    <span class="token comment">/// @return if Upgrader contract is successfully registered.</span>
    <span class="token keyword">function</span> startUpgrading <span class="token punctuation">(</span><span class="token builtin">address</span> _upgraderAddr<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token keyword">returns</span><span class="token punctuation">(</span><span class="token builtin">bool</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/// Getter of proposalPeriod.</span>
    <span class="token comment">/// exception   UninitializationException   uninitialized contract.</span>
    <span class="token comment">/// exception   GetterPermissionException   msg.sender is not permitted to call the getter.</span>
    <span class="token comment">/// @return this.proposalPeriod.</span>
    <span class="token keyword">function</span> getProposalPeriod <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token keyword">view</span> isReady allowedAddress <span class="token keyword">returns</span><span class="token punctuation">(</span><span class="token builtin">uint256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/// Setter of proposalPeriod.</span>
    <span class="token comment">/// @param  _proposalPeriod new value of this.proposalPeriod.</span>
    <span class="token comment">/// exception   UninitializationException   uninitialized contract.</span>
    <span class="token comment">/// exception   PermissionException msg.sender is not the owner.</span>
    <span class="token comment">/// @return if this.proposalPeriod is successfully set.</span>
    <span class="token keyword">function</span> setProposalPeriod <span class="token punctuation">(</span><span class="token builtin">uint256</span> _proposalPeriod<span class="token punctuation">)</span> <span class="token keyword">public</span> isReady <span class="token keyword">returns</span><span class="token punctuation">(</span><span class="token builtin">bool</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/// Return upgrading status for Upgrader contracts.</span>
    <span class="token comment">/// @param  _originalHandlerAddr    address of the original Handler contract.</span>
    <span class="token comment">/// exception   UninitializationException   uninitialized contract.</span>
    <span class="token comment">/// @return Handler contract's upgrading status.</span>
    <span class="token keyword">function</span> canBeUpgraded <span class="token punctuation">(</span><span class="token builtin">address</span> _originalHandlerAddr<span class="token punctuation">)</span> <span class="token keyword">external</span> <span class="token keyword">view</span> isReady <span class="token keyword">returns</span><span class="token punctuation">(</span>UpgradingStatus<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/// Check if the contract has been initialized.</span>
    <span class="token comment">/// @return if the contract has been initialized.</span>
    <span class="token keyword">function</span> live <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">external</span> <span class="token keyword">view</span> <span class="token keyword">returns</span><span class="token punctuation">(</span><span class="token builtin">bool</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/** Getters and setters of data resources: define functions here */</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br></div></div><h3 id="upgrader-contract-optional"><a href="#upgrader-contract-optional" class="header-anchor">#</a> Upgrader Contract (Optional)</h3> <p>Handler contract can be upgraded by calling setHandler() of Data contract. If the owner wants to collect ideas from users, an Upgrader contract will help him/her manage voting and upgrading.</p> <p>Below is the specification of Upgrader contract:</p> <ul><li>The Upgrader contract has the ability to take votes from the registered voters.
<ul><li>The contract owner is able to add voters any time before the proposal expires;</li> <li>Voter can check the current status of the proposal (succeed or expired).</li></ul></li> <li>Developers are able to delete this Upgrader contract by calling done() any time after deployment.</li></ul> <p>The Upgrader contract works as follows:</p> <ol><li>Verify the Data contract, its corresponding Handler contract and the new Handler contract have all been deployed;</li> <li>Deploy an Upgrader contract using Data contract address, previous Handler contract address and new Handler contract address;</li> <li>Register upgrader address in the new Handler contract first, then the original handler and finally the Data contract;</li> <li>Call startProposal() to start the voting process;</li> <li>Call getResolution() before the expiration;</li> <li>Upgrading succeed or proposal is expired.</li></ol> <p>Note:</p> <ul><li>Function done() can be called at any time to let upgrader destruct itself.</li> <li>Function status() can be called at any time to show caller status of the upgrader.</li></ul> <div class="language-solidity line-numbers-mode"><pre class="language-solidity"><code><span class="token comment">/// Handler upgrader</span>
<span class="token keyword">contract</span> <span class="token class-name">Upgrader</span> <span class="token punctuation">{</span>
    <span class="token comment">// Data contract</span>
    DataContract <span class="token keyword">public</span> data<span class="token punctuation">;</span>
    <span class="token comment">// Original Handler contract</span>
    IHandler <span class="token keyword">public</span> originalHandler<span class="token punctuation">;</span>
    <span class="token comment">// New Handler contract</span>
    <span class="token builtin">address</span> <span class="token keyword">public</span> newHandlerAddr<span class="token punctuation">;</span>

    <span class="token comment">/** Marker */</span>
    <span class="token keyword">enum</span> <span class="token class-name">UpgraderStatus</span> <span class="token punctuation">{</span>
        Preparing<span class="token punctuation">,</span>
        Voting<span class="token punctuation">,</span>
        Success<span class="token punctuation">,</span>
        Expired<span class="token punctuation">,</span>
        End
    <span class="token punctuation">}</span>
    UpgraderStatus <span class="token keyword">public</span> status<span class="token punctuation">;</span>

    <span class="token comment">/// Check if the proposal is expired.</span>
    <span class="token comment">/// If so, contract would be marked as expired.</span>
    <span class="token comment">/// exception   PreparingUpgraderException  proposal has not been started.</span>
    <span class="token comment">/// exception   ReupgradingException    upgrading has been done.</span>
    <span class="token comment">/// exception   ExpirationException proposal is expired.</span>
    <span class="token keyword">modifier</span> notExpired <span class="token punctuation">{</span>
        <span class="token keyword">require</span><span class="token punctuation">(</span>status <span class="token operator">!=</span> UpgraderStatus<span class="token punctuation">.</span>Preparing<span class="token punctuation">,</span> <span class="token string">&quot;Invalid proposal!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">require</span><span class="token punctuation">(</span>status <span class="token operator">!=</span> UpgraderStatus<span class="token punctuation">.</span>Success<span class="token punctuation">,</span> <span class="token string">&quot;Upgrading has been done!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">require</span><span class="token punctuation">(</span>status <span class="token operator">!=</span> UpgraderStatus<span class="token punctuation">.</span>Expired<span class="token punctuation">,</span> <span class="token string">&quot;Proposal is expired!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">canBeUpgraded</span><span class="token punctuation">(</span><span class="token builtin">address</span><span class="token punctuation">(</span>originalHandler<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> DataContract<span class="token punctuation">.</span>UpgradingStatus<span class="token punctuation">.</span>InProgress<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            status <span class="token operator">=</span> UpgraderStatus<span class="token punctuation">.</span>Expired<span class="token punctuation">;</span>
            <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">&quot;Proposal is expired!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">_</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/// Start voting.</span>
    <span class="token comment">/// Upgrader must do upgrading check, namely checking if Data contract and 2 Handler contracts are ok.</span>
    <span class="token comment">/// exception   RestartingException proposal has been already started.</span>
    <span class="token comment">/// exception   PermissionException msg.sender is not the owner.</span>
    <span class="token comment">/// exception   UpgraderConflictException   another upgrader is working.</span>
    <span class="token comment">/// exception   NoPreparationException  original or new Handler contract is not prepared.</span>
    <span class="token keyword">function</span> startProposal <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">external</span><span class="token punctuation">;</span>

    <span class="token comment">/// Anyone can try to get resolution.</span>
    <span class="token comment">/// If voters get consensus, upgrade the Handler contract.</span>
    <span class="token comment">/// If expired, self-destruct.</span>
    <span class="token comment">/// Otherwise, do nothing.</span>
    <span class="token comment">/// exception   PreparingUpgraderException  proposal has not been started.</span>
    <span class="token comment">/// exception   ExpirationException proposal is expired.</span>
    <span class="token comment">/// @return     status of proposal.</span>
    <span class="token keyword">function</span> <span class="token function">getResolution</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">external</span> <span class="token keyword">returns</span><span class="token punctuation">(</span>UpgraderStatus<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/// Destruct itself.</span>
    <span class="token comment">/// exception   PermissionException msg.sender is not the owner.</span>
    <span class="token keyword">function</span> <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">external</span><span class="token punctuation">;</span>

    <span class="token comment">/** Other voting mechanism related variables and functions */</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div><h3 id="caveats"><a href="#caveats" class="header-anchor">#</a> Caveats</h3> <p>Since the Upgrader contract in <a href="/eip-1504.html" aria-current="page" class="router-link-exact-active router-link-active">ERC-1504</a> has a simple voting mechanism, it is prone to all the limitations that the voting contract is facing:</p> <ul><li>The administrator can only be the owner of data and Handler contracts. Furthermore, only the administrator has the power to add voters and start a proposal.</li> <li>It requires voters to be constantly active, informative and attentive to make a upgrader succeed.</li> <li>The voting will only be valid in a given time period. If in a given time period the contract cannot collect enough “yes” to proceed, the proposal will be marked expired.</li></ul> <h2 id="rationale"><a href="#rationale" class="header-anchor">#</a> Rationale</h2> <h3 id="data-contract-and-handler-contract"><a href="#data-contract-and-handler-contract" class="header-anchor">#</a> Data Contract and Handler Contract</h3> <p>A smart contract is actually a kind of software, which provides some kind of services. From the perspective of software engineering, a service consists of <strong>resources</strong> that abstract the data and <strong>operations</strong> that abstract the process logic on the data. The requirement of upgrading is mostly on the logic part. Therefore, in order to make a smart contract upgradable, we divide it into two parts:</p> <ol><li>Data contract keeps the resources;</li> <li>Handler contract contains operations.</li></ol> <p>The Handler contract can be upgraded in the future while the Data contract is permanent. Handler contract can manipulate the variables in Data contract through the getter and setter functions provided by Data contract.</p> <h3 id="upgrader-contract-and-voting-mechanism"><a href="#upgrader-contract-and-voting-mechanism" class="header-anchor">#</a> Upgrader Contract and Voting Mechanism</h3> <p>In order to prevent centralization and protect the interests of the community and stakeholders, we also design a voting mechanism in the Upgrader contract. Upgrader contract contains addresses of Data contract and two Handler contracts, and collects votes from pre-defined voters to upgrade the Handler contract when the pre-set condition is fulfilled.</p> <p>For simplicity, the upgradable contract comes with a very minimal version of the voting mechanism. If the contract owner wants to implement a more complex voting mechanism, he/she can modify the existing voting mechanism to incorporate upgradability. The expiration mechanism (see modifier notExpried in Upgrader contract and related functions in Data contract) and upgrading check (see function startProposal() in Upgrader contract) to the contract are mandatory.</p> <h3 id="gas-and-complexity-regarding-the-enumeration-extension"><a href="#gas-and-complexity-regarding-the-enumeration-extension" class="header-anchor">#</a> Gas and Complexity (regarding the enumeration extension)</h3> <p>Using an upgrader will cost some gas. If the Handler contract is upgraded by the owner, it just costs gas that a contract call will cost, which is usually significantly lower than creating and deploying a new contract.</p> <p>Although upgrading contract may take some efforts and gas, it is a much less painful than deprecating the insecure contract/creating a new contract or hard fork (e.g. DAO attack). Contract creation requires a significant amount of effort and gas. One of the advantages of upgradable contracts is that the contract owners don’t have to create new contracts; instead, they only need to upgrade parts of contract that cause issues, which is less expensive compared to data loss and blockchain inconsistency. In other words, upgradable contracts make Data contract more scalable and flexible.</p> <h3 id="community-consensus"><a href="#community-consensus" class="header-anchor">#</a> Community Consensus</h3> <p>Thank you to those who helped on review and revise the proposal:</p> <ul><li><a href="https://github.com/lsankar4033" target="_blank" rel="noopener noreferrer">@lsankar4033<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> from MIT</li> <li>more</li></ul> <p>The proposal is initiated and developed by the team Renaissance and the Research Group of Blockchain System @ Center for Operating System at Peking University.</p> <p>We have been very inclusive in this process and invite anyone with questions or contributions into our discussion. However, this standard is written only to support the identified use cases which are listed herein.</p> <h2 id="implementations"><a href="#implementations" class="header-anchor">#</a> Implementations</h2> <ol><li><a href="https://www.renaissance.app" target="_blank" rel="noopener noreferrer">Renaissance<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> - a protocol that connect creators and fans financially</li> <li><a href="/eip-1504.html" aria-current="page" class="router-link-exact-active router-link-active">ERC-1504</a> - a reference implementation</li></ol> <h2 id="copyright"><a href="#copyright" class="header-anchor">#</a> Copyright</h2> <p>Copyright and related rights waived via <a href="https://creativecommons.org/publicdomain/zero/1.0/" target="_blank" rel="noopener noreferrer">CC0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ethlibrary/EIPs/edit/master/EIPS/eip-1504.md" target="_blank" rel="noopener noreferrer">帮助完善文档</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/26/2021, 5:29:34 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a13d8931.js" defer></script><script src="/assets/js/3.afc73834.js" defer></script><script src="/assets/js/108.e6af934c.js" defer></script>
  </body>
</html>
