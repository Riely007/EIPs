<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>EthereumStratum/2.0.0 | 以太坊改进提案 EIPs</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="以太坊改进提案（EIPs）描述了以太坊平台的标准，包括核心协议规范，客户端API和合约标准。">
    
    <link rel="preload" href="/assets/css/0.styles.5d34d66f.css" as="style"><link rel="preload" href="/assets/js/app.3c081c0d.js" as="script"><link rel="preload" href="/assets/js/3.afc73834.js" as="script"><link rel="preload" href="/assets/js/112.0e5dc443.js" as="script"><link rel="prefetch" href="/assets/js/10.1f5e4f3e.js"><link rel="prefetch" href="/assets/js/100.5e83168e.js"><link rel="prefetch" href="/assets/js/101.abc1c66c.js"><link rel="prefetch" href="/assets/js/102.f1608d9e.js"><link rel="prefetch" href="/assets/js/103.50677a84.js"><link rel="prefetch" href="/assets/js/104.e9244ddc.js"><link rel="prefetch" href="/assets/js/105.74bb2b2c.js"><link rel="prefetch" href="/assets/js/106.78821836.js"><link rel="prefetch" href="/assets/js/107.f2cad26b.js"><link rel="prefetch" href="/assets/js/108.806c491a.js"><link rel="prefetch" href="/assets/js/109.2536f3b5.js"><link rel="prefetch" href="/assets/js/11.19d07763.js"><link rel="prefetch" href="/assets/js/110.aa8e5dff.js"><link rel="prefetch" href="/assets/js/111.486fd49e.js"><link rel="prefetch" href="/assets/js/113.14d95a60.js"><link rel="prefetch" href="/assets/js/114.1282f1e1.js"><link rel="prefetch" href="/assets/js/115.8f4357cd.js"><link rel="prefetch" href="/assets/js/116.faa46692.js"><link rel="prefetch" href="/assets/js/117.ce807443.js"><link rel="prefetch" href="/assets/js/118.c075df33.js"><link rel="prefetch" href="/assets/js/119.c8959574.js"><link rel="prefetch" href="/assets/js/12.cc14cc21.js"><link rel="prefetch" href="/assets/js/120.a997950d.js"><link rel="prefetch" href="/assets/js/121.d55fab26.js"><link rel="prefetch" href="/assets/js/122.0d55f0f1.js"><link rel="prefetch" href="/assets/js/123.f0ef1c2b.js"><link rel="prefetch" href="/assets/js/124.84d00fe3.js"><link rel="prefetch" href="/assets/js/125.64e003e7.js"><link rel="prefetch" href="/assets/js/126.a31044d7.js"><link rel="prefetch" href="/assets/js/127.1ff3a4af.js"><link rel="prefetch" href="/assets/js/128.38dfcf65.js"><link rel="prefetch" href="/assets/js/129.39594e41.js"><link rel="prefetch" href="/assets/js/13.79199e7b.js"><link rel="prefetch" href="/assets/js/130.e85ffe06.js"><link rel="prefetch" href="/assets/js/131.fd90a8ff.js"><link rel="prefetch" href="/assets/js/132.62043b85.js"><link rel="prefetch" href="/assets/js/133.292c85d5.js"><link rel="prefetch" href="/assets/js/134.720824f2.js"><link rel="prefetch" href="/assets/js/135.330b0de9.js"><link rel="prefetch" href="/assets/js/136.d5434ef4.js"><link rel="prefetch" href="/assets/js/137.aefa600d.js"><link rel="prefetch" href="/assets/js/138.00d829f8.js"><link rel="prefetch" href="/assets/js/139.fa3af3a0.js"><link rel="prefetch" href="/assets/js/14.3ec7ba2c.js"><link rel="prefetch" href="/assets/js/140.65655e4b.js"><link rel="prefetch" href="/assets/js/141.51c0ec0a.js"><link rel="prefetch" href="/assets/js/142.aa405a6d.js"><link rel="prefetch" href="/assets/js/143.7ef37d04.js"><link rel="prefetch" href="/assets/js/144.813a767b.js"><link rel="prefetch" href="/assets/js/145.ac7bbacf.js"><link rel="prefetch" href="/assets/js/146.f604aa88.js"><link rel="prefetch" href="/assets/js/147.5b1e7ab8.js"><link rel="prefetch" href="/assets/js/148.f1c25d01.js"><link rel="prefetch" href="/assets/js/149.e1de4f68.js"><link rel="prefetch" href="/assets/js/15.151539ae.js"><link rel="prefetch" href="/assets/js/150.d8785b19.js"><link rel="prefetch" href="/assets/js/151.97e4d45f.js"><link rel="prefetch" href="/assets/js/152.60b9a345.js"><link rel="prefetch" href="/assets/js/153.c215540b.js"><link rel="prefetch" href="/assets/js/154.d80adb79.js"><link rel="prefetch" href="/assets/js/155.067c9183.js"><link rel="prefetch" href="/assets/js/156.564c5338.js"><link rel="prefetch" href="/assets/js/157.f6e4fb9f.js"><link rel="prefetch" href="/assets/js/158.2780e531.js"><link rel="prefetch" href="/assets/js/159.95a9bbc1.js"><link rel="prefetch" href="/assets/js/16.f1797f39.js"><link rel="prefetch" href="/assets/js/160.f4445c3b.js"><link rel="prefetch" href="/assets/js/161.7ec4dccc.js"><link rel="prefetch" href="/assets/js/162.7ba8ee46.js"><link rel="prefetch" href="/assets/js/163.f0aa8208.js"><link rel="prefetch" href="/assets/js/164.4fe8c403.js"><link rel="prefetch" href="/assets/js/165.2d8ce405.js"><link rel="prefetch" href="/assets/js/166.6aa05391.js"><link rel="prefetch" href="/assets/js/167.82768149.js"><link rel="prefetch" href="/assets/js/168.b81a0c2a.js"><link rel="prefetch" href="/assets/js/169.435758b2.js"><link rel="prefetch" href="/assets/js/17.1c3e6588.js"><link rel="prefetch" href="/assets/js/170.4a19f99a.js"><link rel="prefetch" href="/assets/js/171.8b67db69.js"><link rel="prefetch" href="/assets/js/172.e4af9969.js"><link rel="prefetch" href="/assets/js/173.ea79fae8.js"><link rel="prefetch" href="/assets/js/174.bdfb4cb2.js"><link rel="prefetch" href="/assets/js/175.c31a370d.js"><link rel="prefetch" href="/assets/js/176.41fc6fc9.js"><link rel="prefetch" href="/assets/js/177.d49686da.js"><link rel="prefetch" href="/assets/js/178.9fc70e1d.js"><link rel="prefetch" href="/assets/js/179.9773da56.js"><link rel="prefetch" href="/assets/js/18.4e631205.js"><link rel="prefetch" href="/assets/js/180.edebbc8c.js"><link rel="prefetch" href="/assets/js/181.9c7e1e79.js"><link rel="prefetch" href="/assets/js/182.34c52e30.js"><link rel="prefetch" href="/assets/js/183.9702d486.js"><link rel="prefetch" href="/assets/js/184.34ceb786.js"><link rel="prefetch" href="/assets/js/185.e536c5d5.js"><link rel="prefetch" href="/assets/js/186.11665bdc.js"><link rel="prefetch" href="/assets/js/187.5ad2506b.js"><link rel="prefetch" href="/assets/js/188.94d50a82.js"><link rel="prefetch" href="/assets/js/189.e94b7567.js"><link rel="prefetch" href="/assets/js/19.07dc175d.js"><link rel="prefetch" href="/assets/js/190.a44802e9.js"><link rel="prefetch" href="/assets/js/191.2710b7f4.js"><link rel="prefetch" href="/assets/js/192.8fa54ace.js"><link rel="prefetch" href="/assets/js/193.45b30c52.js"><link rel="prefetch" href="/assets/js/194.34eb3369.js"><link rel="prefetch" href="/assets/js/195.e800d01e.js"><link rel="prefetch" href="/assets/js/196.993e37d7.js"><link rel="prefetch" href="/assets/js/197.cfd0371e.js"><link rel="prefetch" href="/assets/js/198.7e41a7ba.js"><link rel="prefetch" href="/assets/js/199.98b8b4e2.js"><link rel="prefetch" href="/assets/js/20.a23c95ca.js"><link rel="prefetch" href="/assets/js/200.dd8af084.js"><link rel="prefetch" href="/assets/js/201.b0651559.js"><link rel="prefetch" href="/assets/js/202.9fda4a48.js"><link rel="prefetch" href="/assets/js/203.ed8c4ff4.js"><link rel="prefetch" href="/assets/js/204.35587f6c.js"><link rel="prefetch" href="/assets/js/205.321dcf85.js"><link rel="prefetch" href="/assets/js/206.9b73d45c.js"><link rel="prefetch" href="/assets/js/207.1db9d0bc.js"><link rel="prefetch" href="/assets/js/208.2323fc5c.js"><link rel="prefetch" href="/assets/js/209.073cc71d.js"><link rel="prefetch" href="/assets/js/21.a9782f3b.js"><link rel="prefetch" href="/assets/js/210.72f984ce.js"><link rel="prefetch" href="/assets/js/211.d9917eee.js"><link rel="prefetch" href="/assets/js/212.9ea4d869.js"><link rel="prefetch" href="/assets/js/213.c02335e9.js"><link rel="prefetch" href="/assets/js/214.4a142067.js"><link rel="prefetch" href="/assets/js/215.8ed26078.js"><link rel="prefetch" href="/assets/js/216.0a0fd08f.js"><link rel="prefetch" href="/assets/js/217.a33898a0.js"><link rel="prefetch" href="/assets/js/218.5957a55c.js"><link rel="prefetch" href="/assets/js/219.2dce84f7.js"><link rel="prefetch" href="/assets/js/22.3792846c.js"><link rel="prefetch" href="/assets/js/220.830eaf36.js"><link rel="prefetch" href="/assets/js/221.aae7daca.js"><link rel="prefetch" href="/assets/js/222.36ee8bea.js"><link rel="prefetch" href="/assets/js/223.e4ee05e9.js"><link rel="prefetch" href="/assets/js/224.e7f443fc.js"><link rel="prefetch" href="/assets/js/225.dfa85f47.js"><link rel="prefetch" href="/assets/js/226.71e9b973.js"><link rel="prefetch" href="/assets/js/227.8484d6cc.js"><link rel="prefetch" href="/assets/js/228.f6928d72.js"><link rel="prefetch" href="/assets/js/229.fea960db.js"><link rel="prefetch" href="/assets/js/23.019e73dd.js"><link rel="prefetch" href="/assets/js/230.d86e0be9.js"><link rel="prefetch" href="/assets/js/231.3bbf02cc.js"><link rel="prefetch" href="/assets/js/232.8df33f46.js"><link rel="prefetch" href="/assets/js/233.cb8d0b73.js"><link rel="prefetch" href="/assets/js/234.e46ce374.js"><link rel="prefetch" href="/assets/js/235.dbac9148.js"><link rel="prefetch" href="/assets/js/236.a24aa05a.js"><link rel="prefetch" href="/assets/js/237.9713dbec.js"><link rel="prefetch" href="/assets/js/238.ae583618.js"><link rel="prefetch" href="/assets/js/239.3ed46955.js"><link rel="prefetch" href="/assets/js/24.d7969000.js"><link rel="prefetch" href="/assets/js/240.865b07ed.js"><link rel="prefetch" href="/assets/js/241.774c50b3.js"><link rel="prefetch" href="/assets/js/242.3dea429a.js"><link rel="prefetch" href="/assets/js/243.d066ef46.js"><link rel="prefetch" href="/assets/js/244.4314f19c.js"><link rel="prefetch" href="/assets/js/245.7411c815.js"><link rel="prefetch" href="/assets/js/246.04f4cf64.js"><link rel="prefetch" href="/assets/js/247.a8d37f4b.js"><link rel="prefetch" href="/assets/js/248.02e38126.js"><link rel="prefetch" href="/assets/js/249.17761090.js"><link rel="prefetch" href="/assets/js/25.bbf9411e.js"><link rel="prefetch" href="/assets/js/250.e0474f9d.js"><link rel="prefetch" href="/assets/js/251.4ee85ae5.js"><link rel="prefetch" href="/assets/js/252.6946d29c.js"><link rel="prefetch" href="/assets/js/253.b13399dd.js"><link rel="prefetch" href="/assets/js/254.f5a78fe5.js"><link rel="prefetch" href="/assets/js/255.67794845.js"><link rel="prefetch" href="/assets/js/256.34867632.js"><link rel="prefetch" href="/assets/js/257.58ef8ea4.js"><link rel="prefetch" href="/assets/js/258.840f1f69.js"><link rel="prefetch" href="/assets/js/259.c4ca3aae.js"><link rel="prefetch" href="/assets/js/26.eb158c2d.js"><link rel="prefetch" href="/assets/js/260.a8766ee4.js"><link rel="prefetch" href="/assets/js/261.c450d645.js"><link rel="prefetch" href="/assets/js/262.5dfb132e.js"><link rel="prefetch" href="/assets/js/263.d105b504.js"><link rel="prefetch" href="/assets/js/264.9c51b91a.js"><link rel="prefetch" href="/assets/js/265.cd869d87.js"><link rel="prefetch" href="/assets/js/266.2c81f2aa.js"><link rel="prefetch" href="/assets/js/267.0eb433a5.js"><link rel="prefetch" href="/assets/js/268.61403538.js"><link rel="prefetch" href="/assets/js/269.d8a5aa4a.js"><link rel="prefetch" href="/assets/js/27.a2d7eacd.js"><link rel="prefetch" href="/assets/js/270.9aa28099.js"><link rel="prefetch" href="/assets/js/271.c97defb3.js"><link rel="prefetch" href="/assets/js/272.28278b0b.js"><link rel="prefetch" href="/assets/js/273.614942c0.js"><link rel="prefetch" href="/assets/js/274.afead1c8.js"><link rel="prefetch" href="/assets/js/275.82fc06e8.js"><link rel="prefetch" href="/assets/js/276.2ce1b15e.js"><link rel="prefetch" href="/assets/js/277.59413c64.js"><link rel="prefetch" href="/assets/js/278.40f50c75.js"><link rel="prefetch" href="/assets/js/279.4ec1739a.js"><link rel="prefetch" href="/assets/js/28.6a081e3d.js"><link rel="prefetch" href="/assets/js/280.61eb02df.js"><link rel="prefetch" href="/assets/js/281.15087a2b.js"><link rel="prefetch" href="/assets/js/282.2573cc17.js"><link rel="prefetch" href="/assets/js/283.054c9336.js"><link rel="prefetch" href="/assets/js/284.6a794878.js"><link rel="prefetch" href="/assets/js/285.12d934a1.js"><link rel="prefetch" href="/assets/js/286.29f567eb.js"><link rel="prefetch" href="/assets/js/287.d4f0bca8.js"><link rel="prefetch" href="/assets/js/288.7c1dd248.js"><link rel="prefetch" href="/assets/js/289.9f985dbb.js"><link rel="prefetch" href="/assets/js/29.88c3d7a0.js"><link rel="prefetch" href="/assets/js/290.3e3e8928.js"><link rel="prefetch" href="/assets/js/291.24ed9d7f.js"><link rel="prefetch" href="/assets/js/292.94fd80de.js"><link rel="prefetch" href="/assets/js/293.255bc297.js"><link rel="prefetch" href="/assets/js/294.84135584.js"><link rel="prefetch" href="/assets/js/295.89da57bd.js"><link rel="prefetch" href="/assets/js/296.90becf38.js"><link rel="prefetch" href="/assets/js/297.b4b88dbf.js"><link rel="prefetch" href="/assets/js/298.793c0f1f.js"><link rel="prefetch" href="/assets/js/299.2d9f2244.js"><link rel="prefetch" href="/assets/js/30.6e454535.js"><link rel="prefetch" href="/assets/js/300.b538064a.js"><link rel="prefetch" href="/assets/js/301.32a4bff4.js"><link rel="prefetch" href="/assets/js/302.8f5aa694.js"><link rel="prefetch" href="/assets/js/303.47e446cd.js"><link rel="prefetch" href="/assets/js/304.e4fe1250.js"><link rel="prefetch" href="/assets/js/305.72f47081.js"><link rel="prefetch" href="/assets/js/306.b4f65a5b.js"><link rel="prefetch" href="/assets/js/307.3187f964.js"><link rel="prefetch" href="/assets/js/308.1c9924f7.js"><link rel="prefetch" href="/assets/js/309.7ed10c52.js"><link rel="prefetch" href="/assets/js/31.89805053.js"><link rel="prefetch" href="/assets/js/310.2e18354b.js"><link rel="prefetch" href="/assets/js/311.c125ff29.js"><link rel="prefetch" href="/assets/js/312.1a2d1d4f.js"><link rel="prefetch" href="/assets/js/313.8ad92b70.js"><link rel="prefetch" href="/assets/js/314.091fa0d3.js"><link rel="prefetch" href="/assets/js/315.29ba5d51.js"><link rel="prefetch" href="/assets/js/316.31ade9b8.js"><link rel="prefetch" href="/assets/js/317.7060fc04.js"><link rel="prefetch" href="/assets/js/318.6cf8cf4b.js"><link rel="prefetch" href="/assets/js/319.78eb7db8.js"><link rel="prefetch" href="/assets/js/32.c2a8ee5f.js"><link rel="prefetch" href="/assets/js/320.9b6f465f.js"><link rel="prefetch" href="/assets/js/321.379d2948.js"><link rel="prefetch" href="/assets/js/322.73fdbdd3.js"><link rel="prefetch" href="/assets/js/323.6caa2080.js"><link rel="prefetch" href="/assets/js/324.ab4dfd33.js"><link rel="prefetch" href="/assets/js/325.278e25db.js"><link rel="prefetch" href="/assets/js/326.462cf2df.js"><link rel="prefetch" href="/assets/js/327.f28c1c8f.js"><link rel="prefetch" href="/assets/js/328.8f58d3e2.js"><link rel="prefetch" href="/assets/js/329.6aa6d948.js"><link rel="prefetch" href="/assets/js/33.23184842.js"><link rel="prefetch" href="/assets/js/330.93eb9f9a.js"><link rel="prefetch" href="/assets/js/331.80b87cc1.js"><link rel="prefetch" href="/assets/js/332.68f247fb.js"><link rel="prefetch" href="/assets/js/333.dd69e3b6.js"><link rel="prefetch" href="/assets/js/334.59b3382a.js"><link rel="prefetch" href="/assets/js/335.039070e2.js"><link rel="prefetch" href="/assets/js/336.beaed5bb.js"><link rel="prefetch" href="/assets/js/337.b65c2e7f.js"><link rel="prefetch" href="/assets/js/338.290ea1fd.js"><link rel="prefetch" href="/assets/js/339.cfbeb3b3.js"><link rel="prefetch" href="/assets/js/34.d4ac227e.js"><link rel="prefetch" href="/assets/js/340.b2ca3fd2.js"><link rel="prefetch" href="/assets/js/341.e661e4d8.js"><link rel="prefetch" href="/assets/js/342.d521d8cb.js"><link rel="prefetch" href="/assets/js/343.699c8cd9.js"><link rel="prefetch" href="/assets/js/344.94a01b6d.js"><link rel="prefetch" href="/assets/js/345.360a3a9d.js"><link rel="prefetch" href="/assets/js/346.421e0004.js"><link rel="prefetch" href="/assets/js/347.067ddec2.js"><link rel="prefetch" href="/assets/js/348.8ff7500d.js"><link rel="prefetch" href="/assets/js/349.1cb157da.js"><link rel="prefetch" href="/assets/js/35.79be4c2d.js"><link rel="prefetch" href="/assets/js/350.f3122d6b.js"><link rel="prefetch" href="/assets/js/351.73ab553d.js"><link rel="prefetch" href="/assets/js/352.c1d9b8a9.js"><link rel="prefetch" href="/assets/js/353.b7b7ef35.js"><link rel="prefetch" href="/assets/js/354.26eb4816.js"><link rel="prefetch" href="/assets/js/355.77e39d15.js"><link rel="prefetch" href="/assets/js/356.b3b11ec8.js"><link rel="prefetch" href="/assets/js/357.e826e380.js"><link rel="prefetch" href="/assets/js/358.08caf944.js"><link rel="prefetch" href="/assets/js/359.8eaa97e8.js"><link rel="prefetch" href="/assets/js/36.b0bd125d.js"><link rel="prefetch" href="/assets/js/360.ff38e37d.js"><link rel="prefetch" href="/assets/js/361.2666265d.js"><link rel="prefetch" href="/assets/js/362.07e86e74.js"><link rel="prefetch" href="/assets/js/363.081cf1f1.js"><link rel="prefetch" href="/assets/js/364.033be969.js"><link rel="prefetch" href="/assets/js/365.f3ec12a0.js"><link rel="prefetch" href="/assets/js/366.5795988a.js"><link rel="prefetch" href="/assets/js/367.c7a03b31.js"><link rel="prefetch" href="/assets/js/368.fa987e7a.js"><link rel="prefetch" href="/assets/js/369.3d7d842e.js"><link rel="prefetch" href="/assets/js/37.cb6b2268.js"><link rel="prefetch" href="/assets/js/370.70957e5d.js"><link rel="prefetch" href="/assets/js/371.6758256c.js"><link rel="prefetch" href="/assets/js/372.e5a12ca8.js"><link rel="prefetch" href="/assets/js/373.24a33d42.js"><link rel="prefetch" href="/assets/js/374.71360427.js"><link rel="prefetch" href="/assets/js/375.7d66db26.js"><link rel="prefetch" href="/assets/js/376.ca08b015.js"><link rel="prefetch" href="/assets/js/377.9aae8605.js"><link rel="prefetch" href="/assets/js/378.82b57f2e.js"><link rel="prefetch" href="/assets/js/379.70e2c604.js"><link rel="prefetch" href="/assets/js/38.02d1febb.js"><link rel="prefetch" href="/assets/js/380.6ccc50ac.js"><link rel="prefetch" href="/assets/js/381.c66cc311.js"><link rel="prefetch" href="/assets/js/382.18d480ab.js"><link rel="prefetch" href="/assets/js/383.621c20db.js"><link rel="prefetch" href="/assets/js/384.d9ed68d0.js"><link rel="prefetch" href="/assets/js/385.552a868c.js"><link rel="prefetch" href="/assets/js/386.48562ecd.js"><link rel="prefetch" href="/assets/js/387.25d5c791.js"><link rel="prefetch" href="/assets/js/388.8dd5308f.js"><link rel="prefetch" href="/assets/js/389.b793f086.js"><link rel="prefetch" href="/assets/js/39.52b78afa.js"><link rel="prefetch" href="/assets/js/390.c1b37ee1.js"><link rel="prefetch" href="/assets/js/391.cc6f6f1b.js"><link rel="prefetch" href="/assets/js/392.f635630d.js"><link rel="prefetch" href="/assets/js/393.4ff90fa7.js"><link rel="prefetch" href="/assets/js/394.397244ff.js"><link rel="prefetch" href="/assets/js/395.18236afd.js"><link rel="prefetch" href="/assets/js/396.33051f11.js"><link rel="prefetch" href="/assets/js/397.6829ff8e.js"><link rel="prefetch" href="/assets/js/398.3f6541b5.js"><link rel="prefetch" href="/assets/js/399.3a6bb206.js"><link rel="prefetch" href="/assets/js/4.3bb46a9f.js"><link rel="prefetch" href="/assets/js/40.c160b9fd.js"><link rel="prefetch" href="/assets/js/400.926d58c3.js"><link rel="prefetch" href="/assets/js/401.fa3a64c7.js"><link rel="prefetch" href="/assets/js/402.586739cf.js"><link rel="prefetch" href="/assets/js/403.e8bea648.js"><link rel="prefetch" href="/assets/js/404.40feb4b5.js"><link rel="prefetch" href="/assets/js/405.ea78f429.js"><link rel="prefetch" href="/assets/js/406.06a34634.js"><link rel="prefetch" href="/assets/js/407.b265c7b5.js"><link rel="prefetch" href="/assets/js/408.3b9353c4.js"><link rel="prefetch" href="/assets/js/409.c5cc81c6.js"><link rel="prefetch" href="/assets/js/41.0aba3e27.js"><link rel="prefetch" href="/assets/js/410.7914c481.js"><link rel="prefetch" href="/assets/js/411.80e7a82f.js"><link rel="prefetch" href="/assets/js/412.ec4398a7.js"><link rel="prefetch" href="/assets/js/413.9bf037d5.js"><link rel="prefetch" href="/assets/js/414.f22b0ded.js"><link rel="prefetch" href="/assets/js/415.a18709ff.js"><link rel="prefetch" href="/assets/js/416.83310c95.js"><link rel="prefetch" href="/assets/js/417.4b19e45b.js"><link rel="prefetch" href="/assets/js/42.a2225282.js"><link rel="prefetch" href="/assets/js/43.60b8cc73.js"><link rel="prefetch" href="/assets/js/44.d1bd963b.js"><link rel="prefetch" href="/assets/js/45.a2d474d6.js"><link rel="prefetch" href="/assets/js/46.eac472d0.js"><link rel="prefetch" href="/assets/js/47.542459f0.js"><link rel="prefetch" href="/assets/js/48.341b8db8.js"><link rel="prefetch" href="/assets/js/49.a786e041.js"><link rel="prefetch" href="/assets/js/5.28151e60.js"><link rel="prefetch" href="/assets/js/50.3e9d91ce.js"><link rel="prefetch" href="/assets/js/51.0729208c.js"><link rel="prefetch" href="/assets/js/52.76bd2586.js"><link rel="prefetch" href="/assets/js/53.5ff982be.js"><link rel="prefetch" href="/assets/js/54.23f15748.js"><link rel="prefetch" href="/assets/js/55.27a2694b.js"><link rel="prefetch" href="/assets/js/56.8f284c7f.js"><link rel="prefetch" href="/assets/js/57.90d019e1.js"><link rel="prefetch" href="/assets/js/58.7b6dc848.js"><link rel="prefetch" href="/assets/js/59.bcd80f71.js"><link rel="prefetch" href="/assets/js/6.499be6d9.js"><link rel="prefetch" href="/assets/js/60.64e983eb.js"><link rel="prefetch" href="/assets/js/61.d22192ff.js"><link rel="prefetch" href="/assets/js/62.c84c7aaa.js"><link rel="prefetch" href="/assets/js/63.dd026eb1.js"><link rel="prefetch" href="/assets/js/64.2f75d60b.js"><link rel="prefetch" href="/assets/js/65.dc493049.js"><link rel="prefetch" href="/assets/js/66.edd545c7.js"><link rel="prefetch" href="/assets/js/67.798cfbfc.js"><link rel="prefetch" href="/assets/js/68.b0ebc9d8.js"><link rel="prefetch" href="/assets/js/69.c929ddc2.js"><link rel="prefetch" href="/assets/js/7.2497c05f.js"><link rel="prefetch" href="/assets/js/70.3c2e3a65.js"><link rel="prefetch" href="/assets/js/71.db3a0474.js"><link rel="prefetch" href="/assets/js/72.24df9a07.js"><link rel="prefetch" href="/assets/js/73.cd7f0a9d.js"><link rel="prefetch" href="/assets/js/74.c940ffba.js"><link rel="prefetch" href="/assets/js/75.567ac3b4.js"><link rel="prefetch" href="/assets/js/76.72062db1.js"><link rel="prefetch" href="/assets/js/77.3bcb196b.js"><link rel="prefetch" href="/assets/js/78.e82d2ca7.js"><link rel="prefetch" href="/assets/js/79.495fd885.js"><link rel="prefetch" href="/assets/js/8.71ec8233.js"><link rel="prefetch" href="/assets/js/80.7eb160e3.js"><link rel="prefetch" href="/assets/js/81.d83716f9.js"><link rel="prefetch" href="/assets/js/82.a16620eb.js"><link rel="prefetch" href="/assets/js/83.109e69d7.js"><link rel="prefetch" href="/assets/js/84.19098fb4.js"><link rel="prefetch" href="/assets/js/85.3f36c2e3.js"><link rel="prefetch" href="/assets/js/86.f8bed698.js"><link rel="prefetch" href="/assets/js/87.00204387.js"><link rel="prefetch" href="/assets/js/88.23ecf470.js"><link rel="prefetch" href="/assets/js/89.dbe77c40.js"><link rel="prefetch" href="/assets/js/9.241577bb.js"><link rel="prefetch" href="/assets/js/90.a106e2e7.js"><link rel="prefetch" href="/assets/js/91.dcded4ed.js"><link rel="prefetch" href="/assets/js/92.14236817.js"><link rel="prefetch" href="/assets/js/93.c4509213.js"><link rel="prefetch" href="/assets/js/94.8e569620.js"><link rel="prefetch" href="/assets/js/95.0cc80ef4.js"><link rel="prefetch" href="/assets/js/96.8f74c17c.js"><link rel="prefetch" href="/assets/js/97.77e41f84.js"><link rel="prefetch" href="/assets/js/98.bf44b86d.js"><link rel="prefetch" href="/assets/js/99.f75896be.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.029a7c95.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5d34d66f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">以太坊改进提案 EIPs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://ethlibrary.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  About us
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/ethlibrary/EIPs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://ethlibrary.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  About us
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/ethlibrary/EIPs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/summary/all.html" class="sidebar-link">All EIPs List</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>EIPs by Status</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/living.html" class="sidebar-link">Living (1)</a></li><li><a href="/summary/final.html" class="sidebar-link">Final (88)</a></li><li><a href="/summary/draft.html" class="sidebar-link">Draft (157)</a></li><li><a href="/summary/stagnant.html" class="sidebar-link">Stagnant (101)</a></li><li><a href="/summary/withdrawn.html" class="sidebar-link">Withdrawn (22)</a></li><li><a href="/summary/last-call.html" class="sidebar-link">Last Call (8)</a></li><li><a href="/summary/review.html" class="sidebar-link">Review (14)</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>EIPs by Types</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/meta.html" class="sidebar-link">Meta (18)</a></li><li><a href="/summary/standards-track.html" class="sidebar-link">Standards Track (367)</a></li><li><a href="/summary/informational.html" class="sidebar-link">Informational (6)</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>EIPs by Category</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/summary/core.html" class="sidebar-link">Core (165)</a></li><li><a href="/summary/erc.html" class="sidebar-link">ERC (153)</a></li><li><a href="/summary/interface.html" class="sidebar-link">Interface (38)</a></li><li><a href="/summary/networking.html" class="sidebar-link">Networking (11)</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="abstract"><a href="#abstract" class="header-anchor">#</a> Abstract</h2> <p>This draft contains the guidelines to define a new standard for the Stratum protocol used by Ethereum miners to communicate with mining pool servers.</p> <h3 id="conventions"><a href="#conventions" class="header-anchor">#</a> Conventions</h3> <p>The key words <code>MUST</code>, <code>MUST NOT</code>, <code>REQUIRED</code>, <code>SHALL</code>, <code>SHALL NOT</code>, <code>SHOULD</code>, <code>SHOULD NOT</code>, <code>RECOMMENDED</code>, <code>MAY</code>, and <code>OPTIONAL</code> in this document are to be interpreted as described in <a href="https://tools.ietf.org/html/rfc2119" target="_blank" rel="noopener noreferrer">RFC 2119<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.
The definition <code>mining pool server</code>, and it's plural form, is to be interpreted as <code>work provider</code> and later in this document can be shortened as <code>pool</code> or <code>server</code>.
The definition <code>miner(s)</code>, and it's plural form, is to be interpreted as <code>work receiver/processor</code> and later in this document can be shortened as <code>miner</code> or <code>client</code>.</p> <h3 id="rationale"><a href="#rationale" class="header-anchor">#</a> Rationale</h3> <p>Ethereum does not have an official Stratum implementation yet. It officially supports only getWork which requires miners to constantly pool the work provider. Only recently go-ethereum have implemented a <a href="https://github.com/ethereum/go-ethereum/pull/17347" target="_blank" rel="noopener noreferrer">push mechanism<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to notify clients for mining work, but whereas the vast majority of miners do not run a node, it's main purpose is to facilitate mining pools rather than miners.
The Stratum protocol on the other hand relies on a standard stateful TCP connection which allows two-way exchange of line-based messages. Each line contains the string representation of a JSON object following the rules of either <a href="https://www.jsonrpc.org/specification_v1" target="_blank" rel="noopener noreferrer">JSON-RPC 1.0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or <a href="https://www.jsonrpc.org/specification" target="_blank" rel="noopener noreferrer">JSON-RPC 2.0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.
Unfortunately, in absence of a well defined standard, various flavours of Stratum have bloomed for Ethereum mining as a derivative work for different mining pools implementations. The only attempt to define a standard was made by NiceHash with their <a href="https://github.com/nicehash/Specifications/blob/master/EthereumStratum_NiceHash_v1.0.0.txt" target="_blank" rel="noopener noreferrer">EthereumStratum/1.0.0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> implementation which is the main source this work inspires from.
Mining activity, thus the interaction among pools and miners, is at it's basics very simple, and can be summarized with &quot;<em>please find a number (nonce) which coupled to this data as input for a given hashing algorithm produces, as output, a result which is below a certain target</em>&quot;. Other messages which may or have to be exchanged among parties during a session are needed to support this basic concept.
Due to the simplicity of the subject, the proponent, means to stick with JSON formatted objects rather than investigating more verbose solutions, like for example  <a href="https://developers.google.com/protocol-buffers/docs/overview" target="_blank" rel="noopener noreferrer">Google's Protocol Buffers<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> which carry the load of strict object definition.</p> <h3 id="stratum-design-flaws"><a href="#stratum-design-flaws" class="header-anchor">#</a> Stratum design flaws</h3> <p>The main Stratum design flaw is the absence of a well defined standard. This implies that miners (and mining software developers) have to struggle with different flavours which make their life hard when switching from one pool to another or even when trying to &quot;guess&quot; which is the flavour implemented by a single pool. Moreover all implementations still suffer from an excessive verbosity for a chain with a very small block time like Ethereum. A few numbers may help understand. A normal <code>mining.notify</code> message weigh roughly 240 bytes: assuming the dispatch of 1 work per block to an audience of 50k connected TCP sockets means the transmission of roughly 1.88TB of data a month. And this can be an issue for large pools. But if we see the same figures the other way round, from a miner's perspective, we totally understand how mining decentralization is heavily affected by the quality of internet connections.</p> <h3 id="sources-of-inspiration"><a href="#sources-of-inspiration" class="header-anchor">#</a> Sources of inspiration</h3> <ul><li><a href="https://github.com/nicehash/Specifications/blob/master/EthereumStratum_NiceHash_v1.0.0.txt" target="_blank" rel="noopener noreferrer">NiceHash EthereumStratum/1.0.0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/zcash/zips/blob/23d74b0373c824dd51c7854c0e3ea22489ba1b76/drafts/str4d-stratum/draft1.rst#json-rpc-1-0" target="_blank" rel="noopener noreferrer">Zcash variant of the Stratum protocol<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="specification"><a href="#specification" class="header-anchor">#</a> Specification</h2> <p>The Stratum protocol is an instance of <a href="https://www.jsonrpc.org/specification" target="_blank" rel="noopener noreferrer">JSON-RPC-2.0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. The miner is a JSON-RPC client, and the server is a JSON-RPC server. All communications exist within the scope of a <code>session</code>. A session starts at the moment a client opens a TCP connection to the server till the moment either party do voluntary close the very same connection or it gets broken. Servers <strong>MAY</strong> support session resuming if this is initially negotiated (on first session handshaking) between the client and the server. During a session all messages exchanged among server and client are line-based which means all messages are JSON strings terminated by ASCII LF character (which may also be denoted as <code>\n</code> in this document). The LF character <strong>MUST NOT</strong> appear elsewhere in a message. Client and server implementations <strong>MUST</strong> assume that once they read a LF character, the current message has been completely received and can be processed.
Line messages are of three types :</p> <ul><li><code>Requests</code> : messages for which the issuer expects a response. The receiver <strong>MUST</strong> reply back to any request individually</li> <li><code>Responses</code> : solicited messages by a previous request. The responder <strong>MUST</strong> label the response with the same identifier of the originating request.</li> <li><code>Notifications</code> : unsolicited messages for which the issuer is not interested nor is expecting a response. Nevertheless a response (eg. an aknowledgement) <strong>MAY</strong> be sent by the receiver.</li></ul> <p>During a <code>session</code> both parties <strong>CAN</strong> exchange messages of the above depicted three types.</p> <h3 id="json-rpc-2-0-compliances"><a href="#json-rpc-2-0-compliances" class="header-anchor">#</a> JSON-RPC-2.0 Compliances</h3> <p>As per <a href="https://www.jsonrpc.org/specification" target="_blank" rel="noopener noreferrer">JSON-RPC-2.0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> specification requests and responses differ from notifications by the identifier (<code>id</code>) member in the JSON object:</p> <ul><li>Requests <strong>MUST</strong> have an <code>id</code> member</li> <li>Responses <strong>MUST</strong> have an <code>id</code> member valued exactly as the <code>id</code> member of the request this response is for</li> <li>Notifications <strong>MUST NOT</strong> have an <code>id</code> member</li></ul> <h3 id="json-rpc-2-0-defiances"><a href="#json-rpc-2-0-defiances" class="header-anchor">#</a> JSON-RPC-2.0 Defiances</h3> <p>In order to get the most concise messages among parties of a session/conversation this implementation enforces the following defiances :</p> <ul><li>JSON member <code>jsonrpc</code> (always valued to &quot;2.0&quot;) <strong>MUST ALWAYS BE OMITTED</strong></li> <li>JSON member <code>id</code> <strong>MUST NOT</strong> be <code>null</code>. When member is present, mandatorily in requests and responses, it <strong>MUST</strong> be valued to an integer Number ranging from 0 to 65535. Please note that a message with <code>&quot;id&quot;: 0</code> <strong>MUST NOT</strong> be interpreted as a notification: it's a request with identifier 0</li> <li>JSON member <code>id</code> <strong>MUST</strong> be only of type primitive number. The removal of other identifier types (namely strings) is due to the need to reduce the number of bytes transferred.</li></ul> <h2 id="conventions-2"><a href="#conventions-2" class="header-anchor">#</a> Conventions</h2> <ul><li>The representation of a JSON object is, at it's base, a string</li> <li>The conversation among the client and the server is made of strings. Each string ending with a LF (ASCII char 10) denotes a <code>line</code>. Each line <strong>MUST</strong> contain only one JSON root object. Eventually the root object <strong>MAY</strong> contain additional JSON objects in it's members.</li> <li>Aside the <code>LF</code> delimiter each <code>line</code> <strong>MUST</strong> be made of printable ASCII chars in the range 32..126</li> <li>It's implicit and mandatory that each line message corresponds to a well formatted JSON object: see <a href="https://www.json.org/" target="_blank" rel="noopener noreferrer">JSON documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>JSON objects are made of <code>members</code> which can be of type : primitive of string/number, JSON object, JSON arrays</li> <li>JSON <code>member</code>'s names are strings which <strong>MUST</strong> be composed of printable chars only in the ASCII range 48..57 (numbers) and 97..122 (lower case letters).</li> <li>JSON <code>member</code>'s names <strong>MUST NOT</strong> begin with a number.</li> <li>JSON values <code>arrays</code> : although the JSON notation allows the insertion of different data types within the same array, this behavior is generally not accepted in coding languages. Due to this, by the means of EthereumStratum/2.0.0, all implementers <strong>MUST</strong> assume that an array is made of elements of the very same data type.</li> <li>JSON values <code>booleans</code> : the JSON notation allows to express boolean values as <code>true</code> or <code>false</code>. In EthereumStratum/2.0.0, for better compatibility within arrays, boolean values will be expressed in the hex form of &quot;0&quot; (false) or &quot;1&quot; (true)</li> <li>JSON values <code>strings</code> : any string value <strong>MUST</strong> be composed of printable ASCII chars only in the ASCII range 32..126. Each string is delimited by a <code>&quot;</code> (ASCII 34) at the beginning and at the end. Should the string value contain a <code>&quot;</code> this must be escaped as <code>\&quot;</code></li> <li>Hex values : a Hexadecimal representation of a number is actually a string data type. As a convention, and to reduce the number of transmitted bytes, the prefix &quot;0x&quot; <strong>MUST</strong> always be omitted. In addition any hex number <strong>MUST</strong> be transferred only for their significant part i.e. the non significant zeroes <strong>MUST</strong> be omitted (example : the decimal <code>456</code> must be represented as <code>&quot;1c8&quot;</code> and not as <code>&quot;01c8&quot;</code> although the conversion produces the same decimal value). This directive <strong>DOES NOT APPLY</strong> to hashes and extranonces</li> <li>Hex values casing : all letters in Hexadecimal values <strong>MUST</strong> be lower case. (example : the decimal <code>456</code> must be represented as <code>&quot;1c8&quot;</code> and not as <code>&quot;1C8&quot;</code> although the conversion produces the same decimal value). This directive <strong>DOES NOT APPLY</strong> to hashes.</li> <li>Numbers : any non-fractional number <strong>MUST</strong> be transferred by it's hexadecimal representation</li></ul> <h3 id="requests"><a href="#requests" class="header-anchor">#</a> Requests</h3> <p>The JSON representation of <code>request</code> object is made of these parts:</p> <ul><li>mandatory <code>id</code> member of type Integer : the identifier established by the issuer</li> <li>mandatory <code>method</code> member of type String : the name of the method to be invoked on the receiver side</li> <li>optional <code>params</code> member : in case the method invocation on the receiver side requires the application of additional parameters to be executed. The type <strong>CAN</strong> be Object (with named members of different types) or Array of single type. In case of an array the parameters will be applied by their ordinal position. If the method requested for invocation on the receiver side does not require the application of additional parameters this member <strong>MUST NOT</strong> be present. The notation <code>&quot;params&quot; : null</code> <strong>IS NOT PERMITTED</strong></li></ul> <h3 id="responses"><a href="#responses" class="header-anchor">#</a> Responses</h3> <p>The JSON representation of <code>response</code> object is made of these parts:</p> <ul><li>mandatory <code>id</code> member of type Integer : the identifier of the request this response corresponds to</li> <li>optional <code>error</code> member : whether an error occurred during the parsing of the method or during it's execution this member <strong>MUST</strong> be present and valued. If no errors occurred this member <strong>MUST NOT</strong> be present. For a detailed structure of the <code>error</code> member see below.</li> <li>optional <code>result</code> member : This has to be set, if the corresponding request requires a result from the user. If no errors occurred by invoking the corresponding function, this member <strong>MUST</strong> be present even if one or more information are null. The type can be of Object or single type Array or Primitive string/number. If no data is meant back for the issuer (the method is void on the receiver) or an error occurred this member <strong>MUST NOT</strong> be present.</li></ul> <p>You'll notice here some differences with standard JSON-RPC-2.0. Namely the result member is not always required. Basically a response like this :</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>means &quot;request received and processed correctly with no data to send back&quot;.</p> <p>To better clarify the concept and clear the field of free interpretations let's take another example of <strong>wrong response</strong></p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>This response syntax leaves room to many interpretations : is it an error ? is <code>false</code> the legit response value to the issued request ?</p> <p>For this reason responses, we reiterate, <strong>MUST BE</strong> of two types:</p> <ul><li>success responses : no error occurred during the processing, the request was legit, syntactically correct, and the receiver had no issues processing it. This kind of responses <strong>MUST NOT</strong> have the <code>error</code> member and <strong>MAY</strong> have the <code>result</code> member if a value is expected back to the issuer.</li> <li>failure responses : something wrong with the request, it's syntax, it's validity scope, or server processing problems. This kind of responses <strong>MUST HAVE</strong> the <code>error</code> member and <strong>MAY</strong> have the <code>result</code> member.</li></ul> <p>The latter deserves a better explanation: failure responses can be distinguished by a severity degree.
Example 1 : a client submits a solution and server rejects it cause it's not below target. Server <strong>MUST</strong> respond like this</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">31</span><span class="token punctuation">,</span>
  <span class="token property">&quot;error&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">406</span><span class="token punctuation">,</span>
      <span class="token property">&quot;message&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Bad nonce&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Example 2 : a client submits a solution and server <strong>accepts</strong> it <strong>but</strong> it accounts the share as stale. Server <strong>MUST</strong> respond like this</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">31</span><span class="token punctuation">,</span>
  <span class="token property">&quot;error&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">202</span><span class="token punctuation">,</span>
      <span class="token property">&quot;message&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Stale&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Example 3 : a client submits an authorization request specifying an invalid workername. Server authorizes the account but rejects worker name. Server <strong>MUST</strong> respond like this</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">&quot;error&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">215</span><span class="token punctuation">,</span>
      <span class="token property">&quot;message&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Invalid Worker Name&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Example 1 depicts the condition of a severe failure while Example 2 and 3 depict a situation where the request has been accepted and processed properly but the result <strong>MAY NOT</strong> be what expected by the client.
It's up to the client to evaluate the severity of the error and decide whether to proceed or not.</p> <p>Using proper error codes pools may properly inform miners of the condition of their requests. Error codes <strong>MUST</strong> honor this scheme:</p> <ul><li>Error codes 2xx : request accepted and processed but some additional info in the <code>error</code> member may give hint</li> <li>Error codes 3xx : server could not process the request due to a lack of authorization by the client</li> <li>Error codes 4xx : server could not process the request due to syntactic problems (method not found, missing params, wrong data types ecc.) or passed <code>param</code> values are not valid.</li> <li>Error codes 5xx : server could not process the request due to internal errors</li></ul> <h3 id="notifications"><a href="#notifications" class="header-anchor">#</a> Notifications</h3> <p>A notification message has the very same representation of a <code>request</code> with the only difference the <code>id</code> member <strong>MUST NOT</strong> be present. This means the issuer is not interested nor expects any response to this message. It's up to the receiver to take actions accordingly. For instance the receiver <strong>MAY</strong> decide to execute the method, or, in case of errors or methods not allowed, drop the connection thus closing the session.</p> <h4 id="error-member"><a href="#error-member" class="header-anchor">#</a> Error member</h4> <p>As seen above a <code>response</code> <strong>MAY</strong> contain an <code>error</code> member. When present this member <strong>MUST</strong> be an Object with:</p> <ul><li>mandatory member <code>code</code> : a Number which identifies the error occurred</li> <li>mandatory member <code>message</code> : a short human readable sentence describing the error occurred</li> <li>optional member <code>data</code> : a Structured or Primitive value that contains additional information about the error. The value of this member is defined by the Server (e.g. detailed error information, nested errors etc.).</li></ul> <h2 id="protocol-flow"><a href="#protocol-flow" class="header-anchor">#</a> Protocol Flow</h2> <ul><li>Client starts session by opening a TCP socket to the server</li> <li>Client advertises and request protocol compatibility</li> <li>Server confirms compatibility and declares ready</li> <li>Client starts/resumes a session</li> <li>Client sends request for authorization for each of it's workers</li> <li>Server replies back with responses for each authorization</li> <li>Server sends <code>mining.set</code> for constant values to be adopted for following mining jobs</li> <li>Server sends <code>mining.notify</code> with minimal job info</li> <li>Client mines on job</li> <li>Client sends <code>mining.submit</code> if any solution found for the job</li> <li>Server replies whether solution is accepted</li> <li>Server optionally sends <code>mining.set</code> for constant values to be adopted for following mining jobs (if something changed)</li> <li>Server sends <code>mining.notify</code> with minimal job info</li> <li>... (continue)</li> <li>Eventually either party closes session and TCP connection</li></ul> <h3 id="session-handling-hello"><a href="#session-handling-hello" class="header-anchor">#</a> Session Handling - Hello</h3> <p><s>One of the worst annoyances until now is that server, at the very moment of socket connection, does not provide any useful information about the stratum flavour implemented. This means the client has to start a conversation by iteratively trying to connect via different protocol flavours. This proposal amends the situation making mandatory for the server to advertise itself to the client.
When a new client connects to the server, the server <strong>MUST</strong> send a <code>mining.hello</code> notification :</s></p> <p>It's been noted that charging the server of the duty to advertise itself as first message of the conversation could potentially be harmful in respect of traffic amplification attacks using spoofed IP addresses or in traditional DDos attacks where an attacker need to spend very little resources to force the server to send a large packet back.
For this reason the duty of first advertisement is kept on client which will issue a <code>mining.hello</code> request like this:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;method&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mining.hello&quot;</span><span class="token punctuation">,</span> 
  <span class="token property">&quot;params&quot;</span><span class="token operator">:</span> 
  <span class="token punctuation">{</span> 
    <span class="token property">&quot;agent&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ethminer-0.17&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;host&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;somemininigpool.com&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;port&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;4d2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;proto&quot;</span><span class="token operator">:</span> <span class="token string">&quot;EthereumStratum/2.0.0&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>The <code>params</code> member object has these mandatory members:</p> <ul><li><code>agent</code> (string) the mining software version</li> <li><code>host</code> (string) the host name of the server this client is willing to connect to</li> <li><code>port</code> (hex) the port number of the server this client is willing to connect to</li> <li><code>proto</code> (string) which reports the stratum flavour requested and expected to be implemented by the server;</li></ul> <p>The rationale behind sending host and port is it enables virtual hosting, where virtual pools or private URLs might be used for DDoS protection, but that are aggregated on Stratum server backends. As with HTTP, the server CANNOT trust the host string. The port is included separately to parallel the client.reconnect method (see below).</p> <p>If the server is prepared to start/resume a session with such requirements it <strong>MUST</strong> reply back with a response like this:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> 
  <span class="token punctuation">{</span> 
    <span class="token property">&quot;proto&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;EthereumStratum/2.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;encoding&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;gzip&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;resume&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timeout&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;b4&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;maxerrors&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;5&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;node&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Geth/v1.8.18-unstable-f08f596a/linux-amd64/go1.10.4&quot;</span>
  <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Where the <code>result</code> is an object made of 5 mandatory members</p> <ul><li><code>proto</code> (string) which <strong>MUST</strong> match the exact version requested by the client</li> <li><code>encoding</code> (string) which value states whether or not all <strong>next messages</strong> should be gzip compressed or not. Possible values are &quot;gzip&quot; or &quot;plain&quot;</li> <li><code>resume</code> (hex) which value states whether or not the host can resume a previously created session;</li> <li><code>timeout</code> (hex) which reports the number of seconds after which the server is allowed to drop connection if no messages from the client</li> <li><code>maxerrors</code> (hex) the maximum number of errors the server will bear before abruptly close connection</li> <li><code>node</code> (string) the node software version underlying the pool</li></ul> <p>When the server replies back with <code>&quot;encoding&quot; : &quot;gzip&quot;</code> to the client, both parties <strong>MUST</strong> gzip compress all next messages. In case the client is not capable of compression it <strong>MUST</strong> close the connection immediately.
Should the server, after this reply, receive other messages as plain text, it <strong>MUST</strong> close the connection.</p> <p>Eventually the client will continue with <code>mining.subscribe</code> (further on descripted)</p> <p>Otherwise, in case of errors or rejection to start the conversation, the server <strong>MAY</strong> reply back with an error giving the other party useful information or, at server's maintainers discretion, abruptly close the connection.</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;error&quot;</span><span class="token operator">:</span> 
  <span class="token punctuation">{</span> 
      <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
      <span class="token property">&quot;message&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Bad protocol request&quot;</span>
  <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>or</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;error&quot;</span><span class="token operator">:</span> 
  <span class="token punctuation">{</span> 
      <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">403</span><span class="token punctuation">,</span>
      <span class="token property">&quot;message&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Forbidden - Banned IP address&quot;</span>
  <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><em>The above two JSON error values are only samples</em>
Eventually the server will close the connection.</p> <p>Why a pool should advertise the node's version ? It's a matter of transparency : miners should know whether or not pool have upgraded to latest patches/releases for node's software.</p> <h3 id="session-handling-bye"><a href="#session-handling-bye" class="header-anchor">#</a> Session Handling - Bye</h3> <p>Disconnection are not gracefully handled in Stratum. Client disconnections from pool may be due to several errors and this leads to waste of TCP sockets on server's side which wait for keepalive timeouts to trigger. A useful notification is <code>mining.bye</code> which, once processed, allows both parties of the session to stop receiving and gracefully close TCP connections</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;method&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mining.bye&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>The party receiving this message aknowledges the other party wants to stop the conversation and closes the socket. The issuer will close too. The explicit issuance of this notification implies the session gets abandoned so no session resuming will be possible even on server which support session-resuming. Client reconnecting to the same server which implements session resuming <strong>SHOULD</strong> expect a new session id and <strong>MUST</strong> re-authorize all their workers.</p> <h3 id="session-handling-session-subscription"><a href="#session-handling-session-subscription" class="header-anchor">#</a> Session Handling - Session Subscription</h3> <p>After receiving the response to <code>mining.hello</code> from server, the client, in case the server does support session resuming <strong>MAY</strong> request to resume a previously interrupted session with <code>mining.subscribe</code> request:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">&quot;method&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mining.subscribe&quot;</span><span class="token punctuation">,</span> 
  <span class="token property">&quot;params&quot;</span><span class="token operator">:</span> <span class="token string">&quot;s-12345&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>where <code>params</code> is the id of the session the client wants to resume.</p> <p>Otherwise, if client wants to start a new session <strong>OR</strong> server does not support session resuming, the request of subscription <strong>MUST</strong> omit the <code>params</code> member:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">&quot;method&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mining.subscribe&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="session-handling-response-to-subscription"><a href="#session-handling-response-to-subscription" class="header-anchor">#</a> Session Handling - Response to Subscription</h3> <p>A server receiving a client session subscription <strong>MUST</strong> reply back with</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;s-12345&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>A server receiving a subscription request with <code>params</code> being a string holding the session id. This cases may apply</p> <ul><li>If session resuming is not supported <code>result</code> will hold a new session Id which <strong>MUST</strong> be a different value from the <code>session</code> member issued by client in previous <code>mining.subscribe</code> method</li> <li>If session resuming is supported it will retrieve working values from cache and <code>result</code> will have the same id requested by the client. This means a session is &quot;resumed&quot;: as a consequence the server <strong>CAN</strong> start pushing jobs omitting to precede them with <code>mining.set</code> (see below) and the client <strong>MUST</strong> continue to use values lastly received within the same session scope. In addition the client <strong>CAN</strong> omit to re-authorize all it's workers.</li> <li>If session resuming is supported but the requested session has expired or it's cache values have been purged <code>result</code> will hold a new session Id which <strong>MUST</strong> be a different value from the <code>session</code> member issued by client in previous <code>mining.subscribe</code> method. As a consequence the server <strong>MUST</strong> wait for client to request authorization for it's workers and <strong>MUST</strong> send <code>mining.set</code> values before pushing jobs. The client <strong>MUST</strong> prepare for a new session discarding all previously cached values (if any).</li></ul> <p>A server implementing session-resuming <strong>MUST</strong> cache :</p> <ul><li>The session Ids</li> <li>Any active job per session</li> <li>The extraNonce</li> <li>Any authorized worker</li></ul> <p>Servers <strong>MAY</strong> drop entries from the cache on their own schedule. It's up to server to enforce session validation for same agent and/or ip.</p> <p>A client which successfully subscribes and resumes session (the <code>session</code> value in server response is identical to <code>session</code> value requested by client on <code>mining.subscribe</code>) <strong>CAN</strong> omit to issue the authorization request for it's workers.</p> <h3 id="session-handling-noop"><a href="#session-handling-noop" class="header-anchor">#</a> Session Handling - Noop</h3> <p>There are cases when a miner struggles to find a solution in a reasonable time so it may trigger the timeout imposed by the server in case of no communications (the server, in fact, may think the client got disconnected). To mitigate the problem a new method <code>mining.noop</code>(with no additional parameters) may be requested by the client.</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
  <span class="token property">&quot;method&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mining.noop&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="session-handling-reconnect"><a href="#session-handling-reconnect" class="header-anchor">#</a> Session Handling - Reconnect</h3> <p>Under certain circumstances the server may need to free some resources and or to relocate miners to another machine. Until now the only option for servers was to abruptly close the connection. On the miner's side this action is interpreted as a server malfunction and they, more often than not, switch to a failover pool.
The implementation of the notification <code>mining.reconnect</code> helps client to better merge with logic of handling of large mining pools.</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;method&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mining.reconnect&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;params&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;host&quot;</span><span class="token operator">:</span> <span class="token string">&quot;someotherhost.com&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;port&quot;</span><span class="token operator">:</span> <span class="token string">&quot;d80&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;resume&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>This notification is meant only from servers to clients. Should a server receive such a notification it will simply ignore it. After the notification has been properly sent, the server is ALLOWED to close the connection, while the client will take the proper actions to reconnect to the suggested end-point.
The <code>host</code> member in <code>params</code> object <strong>SHOULD</strong> report an host DNS name and not an IP address: TLS encrypted connections require to validate the CN name in the certificate which, 99% of the cases, is an host name.
The third member <code>resume</code> of the <code>params</code> object sets whether or not the receiving server is prepared for session resuming.
After this notification has been issued by the server, the client should expect no further messages and <strong>MUST</strong> disconnect.</p> <h3 id="workers-authorization"><a href="#workers-authorization" class="header-anchor">#</a> Workers Authorization</h3> <p>The miner <strong>MUST</strong> authorize at least one worker in order to begin receiving jobs and submit solutions or hashrates. The miner <strong>MAY</strong> authorize multiple workers in the same session. The server <strong>MUST</strong> allow authorization for multiple workers within a session and <strong>MUST</strong> validate at least one authorization from the client before starting to send jobs. A <code>worker</code> is a tuple of the address where rewards must be credited coupled with identifier of the machine actually doing the work. For Ethereum the most common form is <code>&lt;account&gt;.&lt;MachineName&gt;</code>. The same account can be bound to multiple machines. For pool's allowing anonymous mining the account is the address where rewards must be credited, while, for pools requiring registration, the account is the login name. Each time a solution is submitted by the client it must be labelled with the Worker identifier. It's up to server to keep the correct accounting for different addresses.</p> <p>The syntax for the authorization request is the following:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token property">&quot;method&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mining.authorize&quot;</span><span class="token punctuation">,</span> 
  <span class="token property">&quot;params&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;&lt;account&gt;[.&lt;MachineName&gt;]&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;password&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><code>params</code> member must be an Array of 2 string elements. For anonymous mining the &quot;password&quot; can be any string value or empty but not null. Pools allowing anonymous mining will simply ignore the value.
The server <strong>MUST</strong> reply back either with an error or, in case of success, with</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;w-123&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Where the <code>result</code> member is a string which holds an unique - within the scope of the <code>session</code> - token which identifies the authorized worker. For every further request issued by the client, and related to a Worker action, the client <strong>MUST</strong> use the token given by the server in response to an <code>mining.authorize</code> request. This reduces the number of bytes transferred for solution and /or hashrate submission.</p> <p>If client is resuming a previous session it <strong>CAN</strong> omit the authorization request for it's workers and, in this case, <strong>MUST</strong> use the tokens assigned in the originating session. It's up to the server to keep the correct map between tokens and workers.
The server receiving an authorization request where the credentials match previously authorized ones within the same session <strong>MUST</strong> reply back with the previously generated unique token.</p> <h3 id="prepare-for-mining"><a href="#prepare-for-mining" class="header-anchor">#</a> Prepare for mining</h3> <p>A lot of data is sent over the wire multiple times with useless redundancy. For instance the seed hash is meant to change only every 30000 blocks (roughly 5 days) while fixed-diff pools rarely change the work target. Moreover pools must optimize the search segments among miners trying to assign to every session a different &quot;startNonce&quot; (AKA extraNonce).
For this purpose the <code>notification</code> method <code>mining.set</code> allows to set (on miner's side) only those params which change less frequently. The server will keep track of seed, target and extraNonce at session level and will push a notification <code>mining.set</code> whenever any (or all) of those values change to the connected miner.</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;method&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mining.set&quot;</span><span class="token punctuation">,</span> 
  <span class="token property">&quot;params&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;epoch&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;dc&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;target&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;0112e0be826d694b2e62d01511f12a6061fbaec8bc02357593e70e52ba&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;algo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;ethash&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;extranonce&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;af4c&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>At the beginning of each <code>session</code> the server <strong>MUST</strong> send this notification before any <code>mining.notify</code>. All values passed by this notification will be valid for all <strong>NEXT</strong> jobs until a new <code>mining.set</code> notification overwrites them. Description of members is as follows:</p> <ul><li>optional <code>epoch</code> (hex) : unlike all actual Stratum implementations the server should inform the client of the epoch number instead of passing the seed hash. This is enforced by two reasons : the main one is that client has only one way to compute the epoch number and this is by a linear search from epoch 0 iteratively trying increasing epochs till the hash matches the seed hash. Second reason is that epoch number is more concise than seed hash. In the end the seed hash is only transmitted to inform the client about the epoch and is not involved in the mining algorithm.</li> <li>optional <code>target</code> (hex) : this is the boundary hash already adjusted for pool difficulty. Unlike in EthereumStratum/1.0.0, which provides a <code>mining.set_difficulty</code> notification of an <em>index of difficulty</em>, the proponent opt to pass directly the boundary hash. If omitted the client <strong>MUST</strong> assume a boundary of <code>&quot;0x00000000ffff0000000000000000000000000000000000000000000000000000&quot;</code></li> <li>optional <code>algo</code> (string) : the algorithm the miner is expected to mine on. If omitted the client <strong>MUST</strong> assume <code>&quot;algo&quot;: &quot;ethash&quot;</code></li> <li>optional <code>extranonce</code> (hex) : a starting search segment nonce assigned by server to clients so they possibly do not overlap their search segments. If server wants to &quot;cancel&quot; a previously set extranonce it must pass this member valued as an empty string.</li></ul> <p>Whenever the server detects that one, or two, or three or four values change within the session, the server will issue a notification with one, or two or three or four members in the <code>param</code> object. For this reason on each <strong>new</strong> session the server <strong>MUST</strong> pass all four members. As a consequence the miner is instructed to adapt those values on <strong>next</strong> job which gets notified.
The new <code>algo</code> member is defined to be prepared for possible presence of algorithm variants to ethash, namely ethash1a or ProgPow.
Pools providing multicoin switching will take care to send a new <code>mining.set</code> to miners before pushing any job after a switch.
The client which can't support the data provided in the <code>mining.set</code> notification <strong>MAY</strong> close connection or stay idle till new values satisfy it's configuration (see <code>mining.noop</code>).
All client's implementations <strong>MUST</strong> be prepared to accept new extranonces during the session: unlike in EthereumStratum/1.0.0 the optional client advertisement <code>mining.extranonce.subscribe</code> is now implicit and mandatory.</p> <p>The miner receiving the <code>extranonce</code> <strong>MUST</strong> initialize the search segment for next job resizing the extranonce to a hex of 16 bytes thus appending as many zeroes as needed.
Extranonce &quot;af4c&quot; means &quot;<em>search segment of next jobs starts from 0xaf4c000000000000</em>&quot;
If <code>extranonce</code> is valued to an empty string, or it's never been set within the session scope, the client is free pick any starting point of it's own search segment on subsequent <code>mining.notify</code> jobs.</p> <h3 id="a-detail-of-extranonce"><a href="#a-detail-of-extranonce" class="header-anchor">#</a> A detail of &quot;extranonce&quot;</h3> <p>Miners connected to a pool might likely process the very same nonces thus wasting a lot of duplicate jobs. A <code>nonce</code> is any valid number which, applied to algorithm and job specifications, produces a result which is below a certain target. For every job pushed by server to client(s) there are 2^64 possible nonces to test.</p> <p>To be noted that :</p> <ul><li>Any nonce in the 2^64 has the very same possibility to be the right one.</li> <li>A certain hashing job can be solved by more than one nonce</li></ul> <p>Every &quot;test&quot; over a number is called a hash. Assuming a miner should receive a job for each block and considering the actual average block time of 15 seconds that would mean a miner should try</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>  ( 2^64 / 15 ) / 1T ~ 1,229,782.94 TeraHashes per second
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>This computation capacity is well beyond any miner on the market (including ASICs). For this reason single miners can process only small chunks (segments) of this humongous range. The way miners pick the segments to search on is beyond the scope of this work. Fact is as miners are not coordinated there is no knowledge - for a single miner - of segments picked by other miners.
Extranonce concept is here to mitigate this possibility of duplicate jobs charging the server (the work provider) to give miners, at the maximum possible extent, different segments to search on.</p> <p>Giving the above assumptions we can depict a nonce as any number in the hex range :</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>  Min 0x0000000000000000
  Max 0xffffffffffffffff
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><em>the prefix 0x is voluntarily inserted here only to give a better visual representation</em>.</p> <p>The <code>extranonce</code> is, at it's basics, the message of the server saying the client &quot;<em>I give you the first number to start search from</em>&quot;. More in detail the <code>extranoce</code> is the leftmost part of that number.
Assume a pool notifies the client the usage of extranonce <code>ab5d</code> this means the client will see it's search segment narrowed as</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>  Min 0xab5d000000000000
  Max 0xab5dffffffffffff
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Pushing an extranonce of 4 bytes (like in the example) will give pool the possibility to separate segment 65535 different miners ( or if you prefer 0xffff miners ) while leaving the miner still a segment of 2^48 possible nonces to search on.
Recalculating, as above, the computation capacity needed to search this segment we get</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>  ( 2^48 / 15 ) / 1T ~ 18.76 TeraHashes per second
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Which is still a wide segment where miners can randomly (or using other ergodic techniques) pick their internal search segments.</p> <p>Extranonce <strong>MUST</strong> be passed with all relevant bytes (no omission of left zeroes) for a specific reason. Assume an extranonce of &quot;01ac&quot; : it  has the same decimal value of &quot;1ac&quot; but the number of bytes changes thus changing available search segment</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>  When &quot;01ac&quot;               When &quot;1ac&quot;
  Segment is                Segment is
  Min  0x01ac000000000000   Min  0x1ac0000000000000
  Max  0x01acffffffffffff   Max  0x1acfffffffffffff
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>As you can see resulting segments are quite different</p> <p>This all said pools (server), when making use of extranonce, <strong>MUST</strong> observe a maximum length of 6 bytes (hex).</p> <h3 id="jobs-notification"><a href="#jobs-notification" class="header-anchor">#</a> Jobs notification</h3> <p>When available server will dispatch jobs to connected miners issuing a <code>mining.notify</code> notification.</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;method&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mining.notify&quot;</span><span class="token punctuation">,</span> 
  <span class="token property">&quot;params&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;bf0488aa&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;6526d5&quot;</span>
      <span class="token string">&quot;645cf20198c2f3861e947d4f67e3ab63b7b2e24dcc9095bd9123e7b33371f6cc&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;0&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><code>params</code> member is made of 4 mandatory elements:</p> <ul><li>1st element is jobId as specified by pool. To reduce the amount of data sent over the wire pools <strong>SHOULD</strong> keep their job IDs as concise as possible. Pushing a Job id which is identical to headerhash is a bad practice and is highly discouraged.</li> <li>2nd element is the hex number of the block id</li> <li>3rd element is the headerhash.</li> <li>4th element is an hex boolean indicating whether or not eventually found shares from previous jobs will be accounted for sure as stale.</li></ul> <h3 id="solution-submission"><a href="#solution-submission" class="header-anchor">#</a> Solution submission</h3> <p>When a miner finds a solution for a job he is mining on it sends a <code>mining.submit</code> request to server.</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">31</span><span class="token punctuation">,</span>
  <span class="token property">&quot;method&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mining.submit&quot;</span><span class="token punctuation">,</span> 
  <span class="token property">&quot;params&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;bf0488aa&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;68765fccd712&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;w-123&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>First element of <code>params</code> array is the jobId this solution refers to (as sent in the <code>mining.notify</code> message from the server). Second element is the <code>miner nonce</code> as hex. Third element is the token given to the worker previous <code>mining.authorize</code> request. Any <code>mining.submit</code> request bound to a worker which was not successfully authorized - i.e. the token does not exist in the session - <strong>MUST</strong> be rejected.</p> <p>You'll notice in the sample above the <code>miner nonce</code> is only 12 bytes wide (should be 16). Why ?
That's because in the previous <code>mining.set</code> the server has set an <code>extranonce</code> of <code>af4c</code>. This means the full nonce is <code>af4c68765fccd712</code>
In presence of extranonce the miner <strong>MUST</strong> submit only the chars to append to the extranonce to build the final hex value. If no extranonce is set for the session or for the work the miner <strong>MUST</strong> send all 16 bytes.</p> <p>It's server duty to keep track of the tuples <code>job ids &lt;-&gt; extranonces</code> per session.</p> <p>When the server receives this request it either responds success using the short form</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">31</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>or, in case of any error or condition with a detailed error object</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">31</span><span class="token punctuation">,</span>
  <span class="token property">&quot;error&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">,</span>
      <span class="token property">&quot;message&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Job not found&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Client <strong>should</strong> treat errors as &quot;soft&quot; errors (stales) or &quot;hard&quot; (bad nonce computation, job not found etc.). Errors in 5xx range are server errors and suggest the miner to abandon the connection and switch to a failover.</p> <h3 id="hashrate"><a href="#hashrate" class="header-anchor">#</a> Hashrate</h3> <p>Most pools offer statistic information, in form of graphs or by API calls, about the calculated hashrate expressed by the miner while miners like to compare this data with the hashrate they read on their devices. Communication about parties of these information have never been coded in Stratum and most pools adopt the method from getWork named <code>eth_submitHashrate</code>.
In this document we propose an official implementation of the <code>mining.hashrate</code> request.
This method behaves differently when issued from client or from server.</p> <h4 id="client-communicates-it-s-hashrate-to-server"><a href="#client-communicates-it-s-hashrate-to-server" class="header-anchor">#</a> Client communicates it's hashrate to server.</h4> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span> <span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
  <span class="token property">&quot;method&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mining.hashrate&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;params&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;500000&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;w-123&quot;</span>
      <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>where <code>params</code> is an array made of two elements: the first is a hexadecimal string representation (32 bytes) of the hashrate the miner reads on it's devices and the latter is the authorization token issued to worker this hashrate is refers to (see above for <code>mining.authorization</code>).
Server <strong>MUST</strong> respond back with either an aknowledgment message</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">16</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Optionally the server can reply back reporting it's findings about calculated hashrate <strong>for the same worker</strong>.</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
  <span class="token property">&quot;result&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;4f0000&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;w-123&quot;</span>
      <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>In case of errors - for example when the client submits too frequently - with</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
  <span class="token property">&quot;error&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">220</span><span class="token punctuation">,</span>
    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Enhance your calm. Too many requests&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="server-communicates-hashrate-to-client"><a href="#server-communicates-hashrate-to-client" class="header-anchor">#</a> Server communicates hashrate to client</h4> <p>Optionally the server can <strong>notify</strong> client about it's overall performance (according to schedule set on server) with a <code>mining.hashrate</code> notification composed like this</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;method&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mining.hashrate&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;params&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;interval&quot;</span><span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
      <span class="token property">&quot;hr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;500000&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;accepted&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">3692</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;rejected&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Where <code>params</code> is an object which holds these members for values of the <strong>whole session</strong>:</p> <ul><li><code>interval</code> (number) the width, in minutes, of the observation window. &quot;<em>in the last x minutes we calculated ...</em>&quot;</li> <li><code>hr</code> (hex) representation of the hashrate the pool has calculated for the miner</li> <li><code>accepted</code> is an array of two number elements : the first is the overall count of accepted shares and the second is the number of stale shares. The array must be interpreted as &quot;total accepted of which x are stale&quot;</li> <li><code>rejected</code> (number) the overall number of rejected shares</li></ul> <p>The client will eventually take internal actions to reset/restart it's workers.</p> <h2 id="copyright"><a href="#copyright" class="header-anchor">#</a> Copyright</h2> <p>Copyright and related rights waived via <a href="https://creativecommons.org/publicdomain/zero/1.0/" target="_blank" rel="noopener noreferrer">CC0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ethlibrary/EIPs/edit/master/EIPS/eip-1571.md" target="_blank" rel="noopener noreferrer">帮助完善文档</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/26/2021, 5:30:25 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.3c081c0d.js" defer></script><script src="/assets/js/3.afc73834.js" defer></script><script src="/assets/js/112.0e5dc443.js" defer></script>
  </body>
</html>
